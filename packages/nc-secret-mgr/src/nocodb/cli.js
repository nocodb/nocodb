/*! This is a generated file. Do not edit */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.libs=t():e.libs=t()}("undefined"!=typeof self?self:this,(()=>(()=>{var __webpack_modules__={1072:function(e,t,a){e.exports=(a(5317),a(6982),function(e){function t(n){if(a[n])return a[n].exports;var s=a[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){e.exports=a(34)},function(e,t,a){var n=a(29)("wks"),s=a(33),i=a(2).Symbol,r="function"==typeof i;(e.exports=function(e){return n[e]||(n[e]=r&&i[e]||(r?i:s)("Symbol."+e))}).store=n},function(e,t){var a=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=a)},function(e,t,a){var n=a(9);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,a){e.exports=!a(24)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,a){var n=a(12),s=a(17);e.exports=a(4)?function(e,t,a){return n.f(e,t,s(1,a))}:function(e,t,a){return e[t]=a,e}},function(e,t){var a=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=a)},function(e,t,a){var n=a(14);e.exports=function(e,t,a){if(n(e),void 0===t)return e;switch(a){case 1:return function(a){return e.call(t,a)};case 2:return function(a,n){return e.call(t,a,n)};case 3:return function(a,n,s){return e.call(t,a,n,s)}}return function(){return e.apply(t,arguments)}}},function(e,t){var a={}.hasOwnProperty;e.exports=function(e,t){return a.call(e,t)}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports={}},function(e,t){var a={}.toString;e.exports=function(e){return a.call(e).slice(8,-1)}},function(e,t,a){var n=a(3),s=a(26),i=a(32),r=Object.defineProperty;t.f=a(4)?Object.defineProperty:function(e,t,a){if(n(e),t=i(t,!0),n(a),s)try{return r(e,t,a)}catch(e){}if("get"in a||"set"in a)throw TypeError("Accessors not supported!");return"value"in a&&(e[t]=a.value),e}},function(e,t,a){var n=a(42),s=a(15);e.exports=function(e){return n(s(e))}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,a){var n=a(9),s=a(2).document,i=n(s)&&n(s.createElement);e.exports=function(e){return i?s.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,a){var n=a(12).f,s=a(8),i=a(1)("toStringTag");e.exports=function(e,t,a){e&&!s(e=a?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},function(e,t,a){var n=a(29)("keys"),s=a(33);e.exports=function(e){return n[e]||(n[e]=s(e))}},function(e,t){var a=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:a)(e)}},function(e,t,a){var n=a(11),s=a(1)("toStringTag"),i="Arguments"==n(function(){return arguments}()),r=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,a,c;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(a=r(t=Object(e),s))?a:i?n(t):"Object"==(c=n(t))&&"function"==typeof t.callee?"Arguments":c}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,a){var n=a(2),s=a(6),i=a(7),r=a(5),c="prototype",o=function(e,t,a){var l,u,d,m=e&o.F,p=e&o.G,h=e&o.S,g=e&o.P,f=e&o.B,b=e&o.W,E=p?s:s[t]||(s[t]={}),y=E[c],_=p?n:h?n[t]:(n[t]||{})[c];for(l in p&&(a=t),a)(u=!m&&_&&void 0!==_[l])&&l in E||(d=u?_[l]:a[l],E[l]=p&&"function"!=typeof _[l]?a[l]:f&&u?i(d,n):b&&_[l]==d?function(e){var t=function(t,a,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,a)}return new e(t,a,n)}return e.apply(this,arguments)};return t[c]=e[c],t}(d):g&&"function"==typeof d?i(Function.call,d):d,g&&((E.virtual||(E.virtual={}))[l]=d,e&o.R&&y&&!y[l]&&r(y,l,d)))};o.F=1,o.G=2,o.S=4,o.P=8,o.B=16,o.W=32,o.U=64,o.R=128,e.exports=o},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,a){e.exports=a(2).document&&document.documentElement},function(e,t,a){e.exports=!a(4)&&!a(24)((function(){return 7!=Object.defineProperty(a(16)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,a){"use strict";var n=a(28),s=a(23),i=a(57),r=a(5),c=a(8),o=a(10),l=a(45),u=a(18),d=a(52),m=a(1)("iterator"),p=!([].keys&&"next"in[].keys()),h="@@iterator",g="keys",f="values",b=function(){return this};e.exports=function(e,t,a,E,y,_,T){l(a,t,E);var C,O,N,A=function(e){if(!p&&e in v)return v[e];switch(e){case g:case f:return function(){return new a(this,e)}}return function(){return new a(this,e)}},R=t+" Iterator",w=y==f,S=!1,v=e.prototype,I=v[m]||v[h]||y&&v[y],L=I||A(y),D=y?w?A("entries"):L:void 0,$="Array"==t&&v.entries||I;if($&&(N=d($.call(new e)))!==Object.prototype&&(u(N,R,!0),n||c(N,m)||r(N,m,b)),w&&I&&I.name!==f&&(S=!0,L=function(){return I.call(this)}),n&&!T||!p&&!S&&v[m]||r(v,m,L),o[t]=L,o[R]=b,y)if(C={values:w?L:A(f),keys:_?L:A(g),entries:D},T)for(O in C)O in v||i(v,O,C[O]);else s(s.P+s.F*(p||S),t,C);return C}},function(e,t){e.exports=!0},function(e,t,a){var n=a(2),s="__core-js_shared__",i=n[s]||(n[s]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,a){var n,s,i,r=a(7),c=a(41),o=a(25),l=a(16),u=a(2),d=u.process,m=u.setImmediate,p=u.clearImmediate,h=u.MessageChannel,g=0,f={},b="onreadystatechange",E=function(){var e=+this;if(f.hasOwnProperty(e)){var t=f[e];delete f[e],t()}},y=function(e){E.call(e.data)};m&&p||(m=function(e){for(var t=[],a=1;arguments.length>a;)t.push(arguments[a++]);return f[++g]=function(){c("function"==typeof e?e:Function(e),t)},n(g),g},p=function(e){delete f[e]},"process"==a(11)(d)?n=function(e){d.nextTick(r(E,e,1))}:h?(i=(s=new h).port2,s.port1.onmessage=y,n=r(i.postMessage,i,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(n=function(e){u.postMessage(e+"","*")},u.addEventListener("message",y,!1)):n=b in l("script")?function(e){o.appendChild(l("script"))[b]=function(){o.removeChild(this),E.call(e)}}:function(e){setTimeout(r(E,e,1),0)}),e.exports={set:m,clear:p}},function(e,t,a){var n=a(20),s=Math.min;e.exports=function(e){return e>0?s(n(e),9007199254740991):0}},function(e,t,a){var n=a(9);e.exports=function(e,t){if(!n(e))return e;var a,s;if(t&&"function"==typeof(a=e.toString)&&!n(s=a.call(e)))return s;if("function"==typeof(a=e.valueOf)&&!n(s=a.call(e)))return s;if(!t&&"function"==typeof(a=e.toString)&&!n(s=a.call(e)))return s;throw TypeError("Can't convert object to primitive value")}},function(e,t){var a=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++a+n).toString(36))}},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(){return"win32"!==process.platform?"":"ia32"===process.arch&&process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?"mixed":"native"}function i(e){return(0,d.createHash)("sha256").update(e).digest("hex")}function r(e){switch(m){case"darwin":return e.split("IOPlatformUUID")[1].split("\n")[0].replace(/\=|\s+|\"/gi,"").toLowerCase();case"win32":return e.toString().split("REG_SZ")[1].replace(/\r+|\n+|\s+/gi,"").toLowerCase();case"linux":case"freebsd":return e.toString().replace(/\r+|\n+|\s+/gi,"").toLowerCase();default:throw new Error("Unsupported platform: "+process.platform)}}function c(e){var t=r((0,u.execSync)(p[m]).toString());return e?t:i(t)}function o(e){return new l.default((function(t,a){return(0,u.exec)(p[m],{},(function(n,s,c){if(n)return a(new Error("Error while obtaining machine id: "+n.stack));var o=r(s.toString());return t(e?o:i(o))}))}))}Object.defineProperty(t,"__esModule",{value:!0});var l=n(a(35));t.machineIdSync=c,t.machineId=o;var u=a(70),d=a(71),m=process.platform,p={darwin:"ioreg -rd1 -c IOPlatformExpertDevice",win32:{native:"%windir%\\System32",mixed:"%windir%\\sysnative\\cmd.exe /c %windir%\\System32"}[s()]+"\\REG.exe QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",linux:"( cat /var/lib/dbus/machine-id /etc/machine-id 2> /dev/null || hostname ) | head -n 1 || :",freebsd:"kenv -q smbios.system.uuid || sysctl -n kern.hostuuid"}},function(e,t,a){e.exports={default:a(36),__esModule:!0}},function(e,t,a){a(66),a(68),a(69),a(67),e.exports=a(6).Promise},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t,a,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(a+": incorrect invocation!");return e}},function(e,t,a){var n=a(13),s=a(31),i=a(62);e.exports=function(e){return function(t,a,r){var c,o=n(t),l=s(o.length),u=i(r,l);if(e&&a!=a){for(;l>u;)if((c=o[u++])!=c)return!0}else for(;l>u;u++)if((e||u in o)&&o[u]===a)return e||u||0;return!e&&-1}}},function(e,t,a){var n=a(7),s=a(44),i=a(43),r=a(3),c=a(31),o=a(64),l={},u={};t=e.exports=function(e,t,a,d,m){var p,h,g,f,b=m?function(){return e}:o(e),E=n(a,d,t?2:1),y=0;if("function"!=typeof b)throw TypeError(e+" is not iterable!");if(i(b)){for(p=c(e.length);p>y;y++)if((f=t?E(r(h=e[y])[0],h[1]):E(e[y]))===l||f===u)return f}else for(g=b.call(e);!(h=g.next()).done;)if((f=s(g,E,h.value,t))===l||f===u)return f},t.BREAK=l,t.RETURN=u},function(e,t){e.exports=function(e,t,a){var n=void 0===a;switch(t.length){case 0:return n?e():e.call(a);case 1:return n?e(t[0]):e.call(a,t[0]);case 2:return n?e(t[0],t[1]):e.call(a,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(a,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(a,t[0],t[1],t[2],t[3])}return e.apply(a,t)}},function(e,t,a){var n=a(11);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,a){var n=a(10),s=a(1)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||i[s]===e)}},function(e,t,a){var n=a(3);e.exports=function(e,t,a,s){try{return s?t(n(a)[0],a[1]):t(a)}catch(t){var i=e.return;throw void 0!==i&&n(i.call(e)),t}}},function(e,t,a){"use strict";var n=a(49),s=a(17),i=a(18),r={};a(5)(r,a(1)("iterator"),(function(){return this})),e.exports=function(e,t,a){e.prototype=n(r,{next:s(1,a)}),i(e,t+" Iterator")}},function(e,t,a){var n=a(1)("iterator"),s=!1;try{var i=[7][n]();i.return=function(){s=!0},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!s)return!1;var a=!1;try{var i=[7],r=i[n]();r.next=function(){return{done:a=!0}},i[n]=function(){return r},e(i)}catch(e){}return a}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,a){var n=a(2),s=a(30).set,i=n.MutationObserver||n.WebKitMutationObserver,r=n.process,c=n.Promise,o="process"==a(11)(r);e.exports=function(){var e,t,a,l=function(){var n,s;for(o&&(n=r.domain)&&n.exit();e;){s=e.fn,e=e.next;try{s()}catch(n){throw e?a():t=void 0,n}}t=void 0,n&&n.enter()};if(o)a=function(){r.nextTick(l)};else if(i){var u=!0,d=document.createTextNode("");new i(l).observe(d,{characterData:!0}),a=function(){d.data=u=!u}}else if(c&&c.resolve){var m=c.resolve();a=function(){m.then(l)}}else a=function(){s.call(n,l)};return function(n){var s={fn:n,next:void 0};t&&(t.next=s),e||(e=s,a()),t=s}}},function(e,t,a){var n=a(3),s=a(50),i=a(22),r=a(19)("IE_PROTO"),c=function(){},o="prototype",l=function(){var e,t=a(16)("iframe"),n=i.length,s=">";for(t.style.display="none",a(25).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object</script"+s),e.close(),l=e.F;n--;)delete l[o][i[n]];return l()};e.exports=Object.create||function(e,t){var a;return null!==e?(c[o]=n(e),a=new c,c[o]=null,a[r]=e):a=l(),void 0===t?a:s(a,t)}},function(e,t,a){var n=a(12),s=a(3),i=a(54);e.exports=a(4)?Object.defineProperties:function(e,t){s(e);for(var a,r=i(t),c=r.length,o=0;c>o;)n.f(e,a=r[o++],t[a]);return e}},function(e,t,a){var n=a(55),s=a(17),i=a(13),r=a(32),c=a(8),o=a(26),l=Object.getOwnPropertyDescriptor;t.f=a(4)?l:function(e,t){if(e=i(e),t=r(t,!0),o)try{return l(e,t)}catch(e){}if(c(e,t))return s(!n.f.call(e,t),e[t])}},function(e,t,a){var n=a(8),s=a(63),i=a(19)("IE_PROTO"),r=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=s(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?r:null}},function(e,t,a){var n=a(8),s=a(13),i=a(39)(!1),r=a(19)("IE_PROTO");e.exports=function(e,t){var a,c=s(e),o=0,l=[];for(a in c)a!=r&&n(c,a)&&l.push(a);for(;t.length>o;)n(c,a=t[o++])&&(~i(l,a)||l.push(a));return l}},function(e,t,a){var n=a(53),s=a(22);e.exports=Object.keys||function(e){return n(e,s)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,a){var n=a(5);e.exports=function(e,t,a){for(var s in t)a&&e[s]?e[s]=t[s]:n(e,s,t[s]);return e}},function(e,t,a){e.exports=a(5)},function(e,t,a){var n=a(9),s=a(3),i=function(e,t){if(s(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=a(7)(Function.call,a(51).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,a){return i(e,a),t?e.__proto__=a:n(e,a),e}}({},!1):void 0),check:i}},function(e,t,a){"use strict";var n=a(2),s=a(6),i=a(12),r=a(4),c=a(1)("species");e.exports=function(e){var t="function"==typeof s[e]?s[e]:n[e];r&&t&&!t[c]&&i.f(t,c,{configurable:!0,get:function(){return this}})}},function(e,t,a){var n=a(3),s=a(14),i=a(1)("species");e.exports=function(e,t){var a,r=n(e).constructor;return void 0===r||null==(a=n(r)[i])?t:s(a)}},function(e,t,a){var n=a(20),s=a(15);e.exports=function(e){return function(t,a){var i,r,c=String(s(t)),o=n(a),l=c.length;return o<0||o>=l?e?"":void 0:(i=c.charCodeAt(o))<55296||i>56319||o+1===l||(r=c.charCodeAt(o+1))<56320||r>57343?e?c.charAt(o):i:e?c.slice(o,o+2):r-56320+(i-55296<<10)+65536}}},function(e,t,a){var n=a(20),s=Math.max,i=Math.min;e.exports=function(e,t){return(e=n(e))<0?s(e+t,0):i(e,t)}},function(e,t,a){var n=a(15);e.exports=function(e){return Object(n(e))}},function(e,t,a){var n=a(21),s=a(1)("iterator"),i=a(10);e.exports=a(6).getIteratorMethod=function(e){if(null!=e)return e[s]||e["@@iterator"]||i[n(e)]}},function(e,t,a){"use strict";var n=a(37),s=a(47),i=a(10),r=a(13);e.exports=a(27)(Array,"Array",(function(e,t){this._t=r(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,a=this._i++;return!e||a>=e.length?(this._t=void 0,s(1)):s(0,"keys"==t?a:"values"==t?e[a]:[a,e[a]])}),"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},function(e,t){},function(e,t,a){"use strict";var n,s,i,r=a(28),c=a(2),o=a(7),l=a(21),u=a(23),d=a(9),m=(a(3),a(14)),p=a(38),h=a(40),g=(a(58).set,a(60)),f=a(30).set,b=a(48)(),E="Promise",y=c.TypeError,_=c.process,T=c[E],C="process"==l(_=c.process),O=function(){},N=!!function(){try{var e=T.resolve(1),t=(e.constructor={})[a(1)("species")]=function(e){e(O,O)};return(C||"function"==typeof PromiseRejectionEvent)&&e.then(O)instanceof t}catch(e){}}(),A=function(e,t){return e===t||e===T&&t===i},R=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},w=function(e){return A(T,e)?new S(e):new s(e)},S=s=function(e){var t,a;this.promise=new e((function(e,n){if(void 0!==t||void 0!==a)throw y("Bad Promise constructor");t=e,a=n})),this.resolve=m(t),this.reject=m(a)},v=function(e){try{e()}catch(e){return{error:e}}},I=function(e,t){if(!e._n){e._n=!0;var a=e._c;b((function(){for(var n=e._v,s=1==e._s,i=0,r=function(t){var a,i,r=s?t.ok:t.fail,c=t.resolve,o=t.reject,l=t.domain;try{r?(s||(2==e._h&&$(e),e._h=1),!0===r?a=n:(l&&l.enter(),a=r(n),l&&l.exit()),a===t.promise?o(y("Promise-chain cycle")):(i=R(a))?i.call(a,c,o):c(a)):o(n)}catch(e){o(e)}};a.length>i;)r(a[i++]);e._c=[],e._n=!1,t&&!e._h&&L(e)}))}},L=function(e){f.call(c,(function(){var t,a,n,s=e._v;if(D(e)&&(t=v((function(){C?_.emit("unhandledRejection",s,e):(a=c.onunhandledrejection)?a({promise:e,reason:s}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",s)})),e._h=C||D(e)?2:1),e._a=void 0,t)throw t.error}))},D=function(e){if(1==e._h)return!1;for(var t,a=e._a||e._c,n=0;a.length>n;)if((t=a[n++]).fail||!D(t.promise))return!1;return!0},$=function(e){f.call(c,(function(){var t;C?_.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},q=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),I(t,!0))},x=function(e){var t,a=this;if(!a._d){a._d=!0,a=a._w||a;try{if(a===e)throw y("Promise can't be resolved itself");(t=R(e))?b((function(){var n={_w:a,_d:!1};try{t.call(e,o(x,n,1),o(q,n,1))}catch(e){q.call(n,e)}})):(a._v=e,a._s=1,I(a,!1))}catch(e){q.call({_w:a,_d:!1},e)}}};N||(T=function(e){p(this,T,E,"_h"),m(e),n.call(this);try{e(o(x,this,1),o(q,this,1))}catch(e){q.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=a(56)(T.prototype,{then:function(e,t){var a=w(g(this,T));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=C?_.domain:void 0,this._c.push(a),this._a&&this._a.push(a),this._s&&I(this,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),S=function(){var e=new n;this.promise=e,this.resolve=o(x,e,1),this.reject=o(q,e,1)}),u(u.G+u.W+u.F*!N,{Promise:T}),a(18)(T,E),a(59)(E),i=a(6)[E],u(u.S+u.F*!N,E,{reject:function(e){var t=w(this);return(0,t.reject)(e),t.promise}}),u(u.S+u.F*(r||!N),E,{resolve:function(e){if(e instanceof T&&A(e.constructor,this))return e;var t=w(this);return(0,t.resolve)(e),t.promise}}),u(u.S+u.F*!(N&&a(46)((function(e){T.all(e).catch(O)}))),E,{all:function(e){var t=this,a=w(t),n=a.resolve,s=a.reject,i=v((function(){var a=[],i=0,r=1;h(e,!1,(function(e){var c=i++,o=!1;a.push(void 0),r++,t.resolve(e).then((function(e){o||(o=!0,a[c]=e,--r||n(a))}),s)})),--r||n(a)}));return i&&s(i.error),a.promise},race:function(e){var t=this,a=w(t),n=a.reject,s=v((function(){h(e,!1,(function(e){t.resolve(e).then(a.resolve,n)}))}));return s&&n(s.error),a.promise}})},function(e,t,a){"use strict";var n=a(61)(!0);a(27)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,a=this._i;return a>=t.length?{value:void 0,done:!0}:(e=n(t,a),this._i+=e.length,{value:e,done:!1})}))},function(e,t,a){a(65);for(var n=a(2),s=a(5),i=a(10),r=a(1)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],o=0;o<5;o++){var l=c[o],u=n[l],d=u&&u.prototype;d&&!d[r]&&s(d,r,l),i[l]=i.Array}},function(e,t){e.exports=a(5317)},function(e,t){e.exports=a(6982)}]))},2909:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var s=Object.getOwnPropertyDescriptor(t,a);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,s)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),s=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.DriverClient=t.prepareEnv=t.metaUrlToDbConfig=t.getToolDir=t.MetaTable=t.SqlClientFactory=void 0;var i=a(7400);Object.defineProperty(t,"SqlClientFactory",{enumerable:!0,get:function(){return i.SqlClientFactory}});var r=a(9261);Object.defineProperty(t,"MetaTable",{enumerable:!0,get:function(){return r.MetaTable}}),s(a(9191),t);var c=a(4775);Object.defineProperty(t,"getToolDir",{enumerable:!0,get:function(){return c.getToolDir}}),Object.defineProperty(t,"metaUrlToDbConfig",{enumerable:!0,get:function(){return c.metaUrlToDbConfig}}),Object.defineProperty(t,"prepareEnv",{enumerable:!0,get:function(){return c.prepareEnv}});var o=a(7903);Object.defineProperty(t,"DriverClient",{enumerable:!0,get:function(){return o.DriverClient}})},4020:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var s=Object.getOwnPropertyDescriptor(t,a);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,s)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&__createBinding(t,e,a);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const fs_1=__importDefault(__webpack_require__(9896)),util_1=__webpack_require__(9023),path_1=__importDefault(__webpack_require__(6928)),knex_1=__webpack_require__(1832),findIndex_1=__importDefault(__webpack_require__(5119)),find_1=__importDefault(__webpack_require__(133)),jsonfile_1=__importDefault(__webpack_require__(4688)),mkdirp_1=__importDefault(__webpack_require__(2745)),Result_1=__importDefault(__webpack_require__(5578)),emit_1=__importDefault(__webpack_require__(2196)),Debug_1=__importDefault(__webpack_require__(5924)),dataHelp=__importStar(__webpack_require__(4513)),SqlClient_1=__importDefault(__webpack_require__(1440)),utils_1=__webpack_require__(445),evt=new emit_1.default,log=new Debug_1.default("KnexClient"),strTypes=["varchar","char","image","character","character varying","nchar","nvarchar","clob","nvarchar2","varchar2","raw","long raw","bfile","nclob"],intTypes=["integer","int","smallint","mediumint","bigint","tinyint","int2","int4","int8","long","serial","bigserial","smallserial","number"],floatTypes=["float","double","decimal","numeric","real","double precision","real","money","smallmoney","dec"],dateTypes=["date","datetime","timestamp","time","timestamp without time zone","timestamp with time zone","time without time zone","time with time zone","datetime2","smalldatetime","datetimeoffset","interval year","interval day"],_enumTypes=["enum","set"],yearTypes=["year"],bitTypes=["bit"],textTypes=["tinytext","mediumtext","longtext","ntext","text"],boolTypes=["bool","boolean"],blobTypes=["blob","mediumblob","longblob","binary","varbinary"],geometryTypes=["geometry"],pointTypes=["point"],linestringTypes=["linestring"],polygonTypes=["polygon"],multipointTypes=["multipoint"],multilinestringTypes=["multilinestring"],multipolygonTypes=["multipolygon"],jsonTypes=["json"];function createPks(table,columns,pks){let pkCreate="table.primary([";for(let e=0;e<pks.length;++e)pkCreate+=e?`"${columns[pks[e]].cn}"`:`"${columns[pks[e]].cn}",`;pkCreate+="])",eval(`var inMemoryFunc = function(table) {\n    ${pkCreate}\n  }`),console.log(pkCreate),inMemoryFunc(table)}function columnCreate(e,t,a){let n,s=!1;if("varchar"===a.dt||"char"===a.dt||"text"===a.dt?a.cdf=a.cdf?JSON.stringify(a.cdf):null:a.cdf=""===a.cdf?null:a.cdf,a.ai&&("bigInteger"===a.dtx?(n=t.bigIncrements(a.cn),s=!0):(n=t.increments(a.cn),s=!0)),"specificType"!==a.dtx||s)"integer"!==a.dtx||s?"bigInteger"!==a.dtx||s?"text"!==a.dtx||s?"string"!==a.dtx||s?"float"!==a.dtx||s?"decimal"!==a.dtx||s?"boolean"!==a.dtx||s?"date"!==a.dtx||s?"dateTime"!==a.dtx||s?"time"!==a.dtx||s?"timestamp"!==a.dtx||s?"enu"!==a.dtx||s?"json"!==a.dtx||s?"uuid"!==a.dtx||s||(n=t.uuid(a.cn)):n=t.json(a.cn):n=t.enu(a.cn,JSON.stringify(a.enuValue||[])):n=t.timestamp(a.cn):n=t.time(a.cn):n=t.dateTime(a.cn):n=t.date(a.cn):n=t.boolean(a.cn):n=t.decimal(a.cn):n=t.float(a.cn):n=t.string(a.cn):n=t.text(a.cn):n=t.bigInteger(a.cn):n=t.integer(a.cn);else{const e=a.dtxp&&" "!==a.dtxp?a.dtxp:null,s=a.dtxs&&" "!==a.dtxs?a.dtxs:null;n=e&&s?t.specificType(a.cn,`${a.dt}(${e},${s})`):e?t.specificType(a.cn,`${a.dt}(${e})`):t.specificType(a.cn,a.dt)}a.pk&&n.primary(),a.rqd?n.notNullable():n.nullable(),a.ck&&n.unique(),a.un&&n.unsigned(),a.cdf&&n.defaultTo(e.raw(a.cdf))}function removeColumn(table,_n,_o){const colCreate="table.dropColumn(n.cn)";eval(`var inMemoryFunc = function(table) {\n    ${colCreate}\n  }`),inMemoryFunc(table)}function renameColumn(e,t,a,n,s){let i="",r="";if("mysql"===t.client){const e=s.ct,t=s.rqd?"NOT NULL":"",a=s.ai?"AUTO_INCREMENT":"",c=s.cdf?`DEFAULT '${s.cdf}'`:"";i=`ALTER TABLE \`${s.tn}\` CHANGE COLUMN\n                  \`${n.cn}\` \`${s.cn}\` ${e} ${t} ${a} ${c}`,r=`ALTER TABLE \`${s.tn}\` CHANGE COLUMN\n                  \`${s.cn}\` \`${n.cn}\` ${e} ${t} ${a} ${c}`;return{upStatement:[{sql:i}],downStatement:[{sql:r}]}}}function pkUpdate(table,n,o){let colUpdate="table";log.debug(n,o),colUpdate="";let pkCount=0;for(let e=0;e<o.length;++e)o[e].pk&&(colUpdate+=pkCount?`,"${o[e].cn}"`:`table.dropPrimary(["${o[e].cn}"`,pkCount+=1,log.debug(colUpdate));pkCount&&(colUpdate+="]);\n"),colUpdate+="",pkCount=0;for(let e=0;e<n.length;++e)n[e].pk&&(colUpdate+=pkCount?`,"${n[e].cn}"`:`table.primary(["${n[e].cn}"`,pkCount+=1,log.debug(colUpdate));pkCount&&(colUpdate+="]);\n"),log.debug(colUpdate),eval(`var inMemoryFunc = function(table) {\n    ${colUpdate}\n  }`),inMemoryFunc(table)}function columnUpdate(e,t,a,n){let s,i=!1,r=!1,c=!1,o=!1;if("varchar"===a.dt||"char"===a.dt||"text"===a.dt?a.cdf=a.cdf?JSON.stringify(a.cdf):null:a.cdf=""===a.cdf?null:a.cdf,"ai"in a&&n&&a.ai!==n.ai&&a.ai?(s=t.increments(a.cn),i=!0):!("pk"in a)||n&&a.pk===n.pk||!a.pk?"pk"in a&&n&&a.pk!==n.pk&&!a.pk&&(s=t.dropPrimary(a.cn)):s=t.primary(a.cn),"dtx"in a&&"specificType"===a.dtx&&!i){const e=a.dtxp&&" "!==a.dtxp?a.dtxp:null,n=a.dtxs&&" "!==a.dtxs?a.dtxs:null;s=e&&n?t.specificType(a.cn,`${a.dt}(${e},${n})`):e?t.specificType(a.cn,`${a.dt}(${e})`):t.specificType(a.cn,a.dt)}else"dtx"in a&&"integer"===a.dtx&&!i?s=n?t.integer(a.cn,a.dtxp):t.integer(a.cn):"dtx"in a&&"bigInteger"===a.dtx&&!i?s=t.bigInteger(a.cn):"dtx"in a&&"text"===a.dtx&&!i?s=t.text(a.cn):"dtx"in a&&"string"===a.dtx&&!i?s=n?t.string(a.cn,a.dtxp):t.string(a.cn):"dtx"in a&&"float"===a.dtx&&!i?s=n?t.float(a.cn,a.dtxp,a.dtxs):t.float(a.cn):"dtx"in a&&"decimal"===a.dtx&&!i?s=n?t.decimal(a.cn,a.dtxp,a.dtxs):t.decimal(a.cn):"dtx"in a&&"boolean"===a.dtx&&!i?s=t.boolean(a.cn):"dtx"in a&&"binary"===a.dtx&&!i?s=t.binary(a.cn):"dtx"in a&&"date"===a.dtx&&!i?s=t.date(a.cn):"dtx"in a&&"dateTime"===a.dtx&&!i?s=t.dateTime(a.cn):"dtx"in a&&"time"===a.dtx&&!i?s=t.time(a.cn):"dtx"in a&&"timestamp"===a.dtx&&!i?s=t.timestamp(a.cn):"dtx"in a&&"enu"===a.dtx&&!i?s=t.enu(a.cn,JSON.stringify(a.enuValue||[])):"dtx"in a&&"json"===a.dtx&&!i?s=t.json(a.cn):"dtx"in a&&"uuid"===a.dtx&&!i&&(s=t.uuid(a.cn));n?(a.rqd===n.rqd||a.rqd||(s.nullable(),a.cdf&&(s.defaultTo(e.raw(a.cdf)),r=!0),a.un&&(s.unsigned(),c=!0)),a.rqd!==n.rqd&&a.rqd&&!o&&(s.notNullable(),o=!0,a.cdf&&!r&&(s.defaultTo(e.raw(a.cdf)),r=!0),a.un&&!c&&(s.unsigned(),c=!0)),a.un===n.un||c||(a.un&&s.unsigned(),a.cdf&&!r&&(s.defaultTo(e.raw(a.cdf)),r=!0),a.rqd&&!o&&(s.notNullable(),o=!0)),a.cdf===n.cdf||r||(s.defaultTo(a.cdf?e.raw(a.cdf):null),a.rqd&&!o&&(s.notNullable(),o=!0),a.un&&!c&&(s.unsigned(),c=!0)),n&&a.ck===n.ck||!a.ck||s.unique(),n&&a.ck===n.ck||a.ck||s.dropUnique(a.cn)):(a.rqd?s.notNullable():a.rqd||a.cdf||s.nullable(),a.un&&s.unsigned(),a.cdf&&s.defaultTo(e.raw(a.cdf))),n&&n.cno!==a.cn&&s.renameColumn(a.cno,a.cn),1&a.altered||2&a.altered&&s.alter()}class KnexClient extends SqlClient_1.default{constructor(e){if(super(e),this.validateInput(),e.connection&&e.connection.port&&(e.connection.port=+e.connection.port),this._connectionConfig=e,e.knex)this.sqlClient=e.knex;else{const t="sqlite3"===e.client?e.connection:e;this.sqlClient=(0,knex_1.knex)(t)}this.knex=this.sqlClient,this.metaDb={},this.metaDb.tables={},this.evt=new emit_1.default}async _validateInput(){try{const e=JSON.parse(await(0,util_1.promisify)(fs_1.default.readFile)(path_1.default.join(process.cwd(),"package.json"),"utf8"));return"nocodb"===e.name||"nocodb"in e.dependencies}catch(e){}return!0}async validateInput(){try{"___ext"in KnexClient||(KnexClient.___ext=await this._validateInput()),KnexClient.___ext||utils_1.T.emit("evt",{evt_type:"base:external",payload:null,check:!0})}catch(e){}}emitTele(e){this.evt.evt.emit("tele",Object.assign({table_count:0,relation_count:0,view_count:0,api_count:0,mysql:0,pg:0,mssql:0,oracledb:0,sqlite3:0,rest:0,graphql:0},e))}async schemaCreateWithCredentials(e){}async sequenceList(e={}){}async sequenceCreate(e={}){}async sequenceUpdate(e={}){}async sequenceDelete(e={}){}_isColumnPrimary(e){return"PRI"===e.ck||"PRIMARY KEY"===e.ck||"P"===e.ck}_isColumnForeignKey(e,t){return-1!==(0,findIndex_1.default)(e.foreignKeys,{cn:t})}_isColumnPrimaryForInserting(e,t){return("PRI"===t.ck||"PRIMARY KEY"===t.ck||"P"===t.ck)&&!(e.primaryKeys.length>1&&(0,findIndex_1.default)(e.primaryKeys,{cn:t.cn})>0)}_getMaxPksPossible(e){const t={int:4294967295,tinyint:255,smallint:65535,mediumint:16777215,bigint:61};return e.un?t[e.dt]:{int:2147483647,tinyint:127,smallint:32767,mediumint:8388607,bigint:60}[e.dt]}_getMaxNumPossible(e){const t={int:4294967295,tinyint:255,smallint:65535,mediumint:16777215,bigint:61};return e.un?t[e.dt]:{int:2147483647,tinyint:127,smallint:32767,mediumint:8388607,bigint:60}[e.dt]}_getMaxRowsPossible(e,t){let a=1e4;const n=e.primaryKeys[0];if(e.primaryKeys.length){const t=this.getKnexDataTypeMock(n.ct),s=(0,find_1.default)(e.columns,{cn:n.cn});"integer"===t?a=Math.pow(2,s.np):"string"===t&&s.clen&&s.clen<3&&(a=500)}let s=1e4,i=0,r=(0,findIndex_1.default)(e.columns,{ck:"UNI"},i);for(;-1!==r;){const t=e.columns[r],a=this.getKnexDataTypeMock(t.ct);"integer"===a?s=Math.pow(2,t.np):"string"===a&&t.clen&&t.clen<2&&(s=25),i=r,r=(0,findIndex_1.default)(e.columns,{ck:"UNI"},i+1)}let c=1e4;for(i=0,r=(0,findIndex_1.default)(e.columns,{ck:"MUL"},i);-1!==r;){const t=e.columns[r],a=this.getKnexDataTypeMock(t.ct);"integer"===a&&(c=Math.pow(2,t.np)),i=r,r=(0,findIndex_1.default)(e.columns,{ck:"MUL"},i+1)}return Math.min(a,s,c,t)}getColumnType(e){}getKnexDataTypeMock(e){try{const t=e;let a={};return a=dataHelp.getType(t,strTypes)?"string":dataHelp.getType(t,intTypes)?"integer":dataHelp.getType(t,floatTypes)?"float":dataHelp.getType(t,dateTypes)?"date":dataHelp.getType(t,_enumTypes)?"enum":dataHelp.getType(t,yearTypes)?"year":dataHelp.getType(t,blobTypes)?"blob":dataHelp.getType(t,boolTypes)?"boolean":dataHelp.getType(t,geometryTypes)?"geometry":dataHelp.getType(t,pointTypes)?"point":dataHelp.getType(t,linestringTypes)?"linestring":dataHelp.getType(t,polygonTypes)?"polygon":dataHelp.getType(t,multipointTypes)?"multipoint":dataHelp.getType(t,multilinestringTypes)?"multilinestring":dataHelp.getType(t,multipolygonTypes)?"multipolygon":dataHelp.getType(t,bitTypes)?"bit":dataHelp.getType(t,textTypes)?"text":dataHelp.getType(t,jsonTypes)?"json":"other",a}catch(e){return console.log(e),"string"}}getMinMax(e){}async mockDb(e){}async dbCacheInitAsyncKnex(e=null){try{const e=this;let t=null,a=[];if("mysql"===this.connectionConfig.client){t=dataHelp.getMysqlSchemaQuery();const e=await this.knex.raw(t,[this.connectionConfig.connection.database]);e.length?(a=e[0],await this.knex.raw("FLUSH TABLES",[])):console.log({},e[0])}if(a.length){for(let e=0;e<a.length;++e){const t=Object.keys(a[e]);for(let n=0;n<t.length;++n){const s=a[e][t[n]];a[e][t[n].toLowerCase()]=s}}e.iterateToCacheTables(a),e.iterateToCacheTablePks(a),e.iterateToCacheTableColumns(a),e.iterateToCacheTableFks(a),e.constructUiMeta(),console.log("erm atrix = = = = ="),e.iterateToCacheErMatrix(a),console.log("erm atrix = = = = =");for(let e=0;e<a.length;++e)"PRI"===a[e].ck&&console.log("PK >> ",a[e].tn,a[e].cn,a[e].ext)}}catch(e){console.log(e)}}getUiColumnObject(e){const t={};return t.cn=e.cn,t.dt=e.dt,t.data_type_knex=this.getKnexDataTypeMock(e.dt),t.ct=e.ct,t.nrqd="NO"!==e.nrqd,t.ck="MUL"===e.ck,t.pk="PRI"===e.ck,t.un=-1!==e.ct.indexOf("unsigned"),t.ai=-1!==e.ext.indexOf("auto_increment"),"mysql"===this.connectionConfig.client&&(t.cdf=e.cdf,t.clen=e.clen,t.np=e.np,t.ns=e.ns,t.dp=e.dp),t}constructUiMeta(){for(const e in this.metaDb.tables){const t=this.metaDb.tables[e];for(let e=0;e<t.columns.length;++e){const a=t.columns[e];t.uiModel.columns[e]=this.getUiColumnObject(a)}}}iterateToCacheTables(e){for(let t=0;t<e.length;++t){const a=e[t];{const e=a.tn;if(!(e in this.metaDb.tables)){this.metaDb.tables[e]={},this.metaDb.tables[e].primaryKeys=[],this.metaDb.tables[e].foreignKeys=[],this.metaDb.tables[e].columns=[],this.metaDb.tables[e].indicies=[],this.metaDb.tables[e].is_view=a.is_view;const t={columns:[],primaryKeys:[],foreignKeys:[],indicies:[]};this.metaDb.tables[e].uiModel=t}}}}iterateToCacheTableColumns(e){for(let t=0;t<e.length;++t){const a=e[t],n=a.tn,s={};a.cn.split(" ").length>1||(s.cn=a.cn,s.op=a.op,s.ck=a.ck,s.dt=a.dt,s.ct=a.ct,s.rtn=a.rtn,s.rcn=a.rcn,s.nrqd=a.nrqd,"mysql"===this.connectionConfig.client&&(s.ext=a.ext,s.cc=a.cc,s.cdf=a.cdf,s.clen=a.clen,s.np=a.np,s.ns=a.ns,s.dp=a.dp),dataHelp.findOrInsertObjectArrayByKey(s,"cn",this.metaDb.tables[n].columns))}}iterateToCacheTableFks(e){for(let t=0;t<e.length;++t){const a=e[t],n=a.tn;if(a.rtn){const e={};e.cn=a.cn,e.tn=a.tn,e.rtn=a.rtn,e.rcn=a.rcn,e.dt=a.dt,e.ct=a.ct,dataHelp.findOrInsertObjectArrayByKey(e,"cn",this.metaDb.tables[n].foreignKeys)}}}iterateToCacheErMatrix(e){this.metaDb.erMatrix=[];const t=Object.keys(this.metaDb.tables),a={},n={};console.log("< < < ",t);for(let e=0;e<t.length;++e)a[t[e]]=e,n[e]=t[e];this.metaDb.erTablesAsArr=t,this.metaDb.erTableIndexObj=a,this.metaDb.erIndexTableObj=n;for(let e=0;e<t.length;++e){this.metaDb.erMatrix[e]=[];for(let a=0;a<t.length;++a)this.metaDb.erMatrix[e].push(0)}console.log(this.metaDb.erTableIndexObj,this.metaDb.erIndexTableObj);for(let t=0;t<e.length;++t)if(null!==e[t].rtn){const n=a[e[t].rtn],s=a[e[t].tn];this.metaDb.erMatrix[n][s]=1}}iterateToCacheTablePks(e){for(let t=0;t<e.length;++t){const a=e[t],n=a.tn;if(this._isColumnPrimary(a)){const e={};e.cn=a.cn,e.op=a.op,e.ck=a.ck,e.dt=a.dt,e.ct=a.ct,dataHelp.findOrInsertObjectArrayByKey(e,"cn",this.metaDb.tables[n].primaryKeys)}}}emit(e){log.api(e),evt.evt.emit("UI",{status:0,data:`SQL : ${e}`})}emitW(e){log.warn(e),evt.evt.emit("UI",{status:1,data:`SQL : ${e}`})}emitE(e){log.error(e),evt.evt.emit("UI",{status:-1,data:`SQL : ${e}`})}migrationInit(e){}async selectAll(e){return await this.sqlClient.raw(this.sqlClient(e).select().toQuery())}async list(e){const{size:t=10,page:a=1,orderBy:n}=e,s=new Result_1.default;try{const i=await this.sqlClient.raw(this.sqlClient(e.tn).count().toQuery());s.data.count=Object.values(i[0])[0];const r=this.sqlClient(e.tn).select().limit(t).offset((a-1)*t);n&&n.length?s.data.list=await this.sqlClient.raw(r.orderBy(n).toQuery()):s.data.list=await this.sqlClient.raw(r.toQuery())}catch(e){console.log(e),s.data.list=[]}return s}executeSqlFiles(){}async createDatabaseIfNotExists(e){}async createTableIfNotExists(e){}async raw(e,...t){const a=(new Date).getTime();let n=null,s=null,i=null;try{return n=await this.sqlClient.raw(e,...t),s=(new Date).getTime(),i=s-a,log.api(`Query: (${e}) [Took: ${i} ms]`),this.emit(`${e} [Took: ${i} ms]`),n}catch(e){throw s=(new Date).getTime(),i=s-a,this.emitE(`${e} [Took: ${i} ms]`),console.log(e),e}}async insert(e){const{tn:t,data:a}=e,n=await this.sqlClient.raw(this.sqlClient(t).insert(a).toQuery());return log.debug(n),n}async update(e){const{tn:t,data:a,whereConditions:n}=e;return await this.sqlClient.raw(this.sqlClient(t).where(n).update(a).toQuery())}async delete(e){const{tn:t,whereConditions:a}=e,n=await this.sqlClient.raw(this.sqlClient(t).where(a).del().toQuery());return log.debug(n),n}async remove(e,t){await this.sqlClient.raw(this.sqlClient(e).del().where(t).toQuery())}hasTable(e){}hasDatabase(e){}getKnexDataTypes(){const e=new Result_1.default;return e.data.list=["int","tinyint","smallint","mediumint","bigint","float","decimal","double","real","bit","boolean","serial","date","datetime","timestamp","time","year","char","varchar","nchar","text","tinytext","mediumtext","longtext","binary","varbinary","blob","tinyblob","mediumblob","longblob","enum","set","time","geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","json"],e}getKnexDataTypesAdvanced(e={}){const t=new Result_1.default;return t.data.list=[{type:"int",dtxp:"10",dtxs:"",aggrDataType:"numeric",cdf:"1"},{type:"tinyint",dtxp:"1",dtxs:"",aggrDataType:"numeric",cdf:"1"},{type:"smallint",dtxp:"5",dtxs:"",aggrDataType:"numeric",cdf:"1"},{type:"mediumint",dtxp:"8",dtxs:"",aggrDataType:"numeric",cdf:"1"},{type:"bigint",dtxp:"20",dtxs:"",aggrDataType:"numeric",cdf:"1"},{type:"bit",dtxp:"",dtxs:"",aggrDataType:"numeric",cdf:"1"},{type:"boolean",dtxp:"",dtxs:"",aggrDataType:"boolean",cdf:""},{type:"float",dtxp:"10",dtxs:"2",aggrDataType:"float",cdf:""},{type:"decimal",dtxp:"10",dtxs:"2",aggrDataType:"float",cdf:""},{type:"double",dtxp:"10",dtxs:"2",aggrDataType:"float",cdf:""},{type:"serial",dtxp:"",dtxs:"",aggrDataType:"numeric",cdf:""},{type:"date",dtxp:"",dtxs:"",aggrDataType:"datetime",cdf:""},{type:"datetime",dtxp:"",dtxs:"",aggrDataType:"datetime",cdf:""},{type:"timestamp",dtxp:"",dtxs:"",aggrDataType:"datetime",cdf:""},{type:"time",dtxp:"",dtxs:"",aggrDataType:"time",cdf:""},{type:"year",dtxp:"",dtxs:"",aggrDataType:"year",cdf:""},{type:"char",dtxp:"10",dtxs:"",aggrDataType:"char",cdf:""},{type:"varchar",dtxp:"10",dtxs:"",aggrDataType:"char",cdf:""},{type:"nchar",dtxp:"10",dtxs:"",aggrDataType:"char",cdf:""},{type:"text",dtxp:"",dtxs:"",aggrDataType:"text",cdf:""},{type:"tinytext",dtxp:"",dtxs:"",aggrDataType:"text",cdf:""},{type:"mediumtext",dtxp:"",dtxs:"",aggrDataType:"text",cdf:""},{type:"longtext",dtxp:"",dtxs:"",aggrDataType:"text",cdf:""},{type:"binary",dtxp:"255",dtxs:"",aggrDataType:"binary",cdf:""},{type:"varbinary",dtxp:"255",dtxs:"",aggrDataType:"binary",cdf:""},{type:"blob",dtxp:"",dtxs:"",aggrDataType:"blob",cdf:""},{type:"tinyblob",dtxp:"",dtxs:"",aggrDataType:"blob",cdf:""},{type:"mediumblob",dtxp:"",dtxs:"",aggrDataType:"blob",cdf:""},{type:"longblob",dtxp:"",dtxs:"",aggrDataType:"blob",cdf:""},{type:"enum",dtxp:"'a','b'",dtxs:"",aggrDataType:"enum",cdf:""},{type:"set",dtxp:"'a','b'",dtxs:"",aggrDataType:"set",cdf:""},{type:"geometry",dtxp:"",dtxs:"",aggrDataType:"geometry",cdf:""},{type:"point",dtxp:"",dtxs:"",aggrDataType:"geometry",cdf:""},{type:"linestring",dtxp:"",dtxs:"",aggrDataType:"geometry",cdf:""},{type:"polygon",dtxp:"",dtxs:"",aggrDataType:"geometry",cdf:""},{type:"multipoint",dtxp:"",dtxs:"",aggrDataType:"geometry",cdf:""},{type:"multilinestring",dtxp:"",dtxs:"",aggrDataType:"geometry",cdf:""},{type:"multipolygon",dtxp:"",dtxs:"",aggrDataType:"geometry",cdf:""},{type:"json",dtxp:"",dtxs:"",aggrDataType:"json",cdf:""}],e&&"aggrDataType"in e&&(t.data.list=t.data.list.filter((t=>t.aggrDataType===e.aggrDataType))),t}async tableCreate(e){const t=this.tableCreate.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{e.table=e.tn,e.sqlClient=this.sqlClient;const t=this.sqlClient.schema.createTable(e.table,(function(t){const a=[],n=JSON.parse(JSON.stringify(e.columns));for(let e=0;e<n.length;++e)n[e].pk&&(a.push(e),n[e].pk=!1,n[e].ai=!1);if(a.length>1){for(let a=0;a<n.length;++a)columnCreate(e.sqlClient,t,n[a]);createPks(t,e.columns,a)}else for(let a=0;a<e.columns.length;++a)columnCreate(e.sqlClient,t,e.columns[a])}));await this.sqlClient.raw(t.toQuery());const n=this.sqlClient.schema.createTable(e.table,(function(t){const a=[],n=JSON.parse(JSON.stringify(e.columns));for(let e=0;e<n.length;++e)n[e].pk&&(a.push(e),n[e].pk=!1,n[e].ai=!1);if(a.length>1){for(let a=0;a<n.length;++a)columnCreate(e.sqlClient,t,n[a]);createPks(t,e.columns,a)}else for(let a=0;a<e.columns.length;++a)columnCreate(e.sqlClient,t,e.columns[a])})).toSQL();this.emit(`Success : ${n}`);const s=this.sqlClient.schema.dropTable(e.table).toSQL();a.data.object={upStatement:n,downStatement:s}}catch(e){throw log.ppe(e,t),e}return a}async tableRename(e){const t=this.tableCreate.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{e.table=e.tn,await this.sqlClient.raw(this.sqlClient.schema.renameTable(e.tn_old,e.tn).toQuery());const t=this.querySeparator()+this.sqlClient.schema.renameTable(e.tn_old,e.tn).toQuery();this.emit(`Success : ${t}`);const n=this.querySeparator()+this.sqlClient.schema.renameTable(e.tn,e.tn_old).toQuery();a.data.object={upStatement:[{sql:t}],downStatement:[{sql:n}]}}catch(e){throw log.ppe(e,t),e}return a}async tableUpdate(e){const t=this.tableUpdate.name,a=new Result_1.default;log.api(`${t}:args:`,e);let n=!1,s={};try{e.table=e.tn;const t=e.originalColumns;e.connectionConfig=this._connectionConfig,e.sqlClient=this.sqlClient;const i=[],r=[];let c=0;for(let t=0;t<e.columns.length;++t)e.columns[t].pk&&r.push(t);for(let t=0;t<e.originalColumns.length;++t)e.originalColumns[t].pk&&i.push(t);if(r.length>i.length)c=r.length-i.length;else if(r.length<i.length)c=r.length-i.length;else for(let e=0;e<r.length;++e)r[e]!==i[e]&&(c=1);console.log("pksChanged:",c);const o=this.sqlClient.schema.alterTable(e.table,(function(i){if(c)pkUpdate(i,e.columns,e.originalColumns);else for(let r=0;r<e.columns.length;++r){const c=(0,find_1.default)(t,{cn:e.columns[r].cno});8&e.columns[r].altered?(n=!0,s=renameColumn(e.sqlClient,e.connectionConfig,i,c,e.columns[r]),a.data.object=s):4&e.columns[r].altered?removeColumn(i,e.columns[r],c):2&e.columns[r].altered?columnUpdate(e.sqlClient,i,e.columns[r],c):1&e.columns[r].altered&&columnUpdate(e.sqlClient,i,e.columns[r],null)}}));if(await this.sqlClient.raw(o.toQuery()),n)await this.sqlClient.raw(s.upStatement),a.data.object=s;else{const n=this.sqlClient.schema.alterTable(e.table,(function(a){if(c)pkUpdate(a,e.columns,e.originalColumns);else for(let n=0;n<e.columns.length;++n){const s=(0,find_1.default)(t,{cn:e.columns[n].cno});8&e.columns[n].altered||(4&e.columns[n].altered?removeColumn(a,e.columns[n],s):2&e.columns[n].altered?columnUpdate(e.sqlClient,a,e.columns[n],s):1&e.columns[n].altered&&columnUpdate(e.sqlClient,a,e.columns[n],null))}})).toSQL(),s=this.sqlClient.schema.alterTable(e.table,(function(a){if(c)pkUpdate(a,e.columns,e.originalColumns);else for(let n=0;n<e.columns.length;++n){const s=(0,find_1.default)(t,{cn:e.columns[n].cno});8&e.columns[n].altered||(4&e.columns[n].altered?columnUpdate(e.sqlClient,a,s,null):1&e.columns[n].altered?removeColumn(a,e.columns[n],null):2&e.columns[n].altered&&columnUpdate(e.sqlClient,a,s,e.columns[n]))}})).toSQL();a.data.object={upStatement:n,downStatement:s}}}catch(e){throw log.ppe(e,t),e}return a}async tableDelete(e){const t=this.tableDelete.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{const{columns:t}=e;e.sqlClient=this.sqlClient;const n=this.sqlClient.schema.dropTable(e.tn).toSQL(),s=this.sqlClient.schema.createTable(e.tn,(function(a){for(let n=0;n<t.length;++n)columnCreate(e.sqlClient,a,t[n])})).toSQL();this.emit(`Success : ${n}`),await this.sqlClient.raw(this.sqlClient.schema.dropTable(e.tn).toQuery()),a.data.object={upStatement:n,downStatement:s}}catch(e){throw log.ppe(e,t),e}return a}async indexCreate(e){const t=this.indexCreate.name,a=new Result_1.default;log.api(`${t}:args:`,e);const n=e.indexName||null;try{e.table=e.tn;const t=this.sqlClient.schema.table(e.table,(function(t){e.non_unique?t.index(e.columns,n):t.unique(e.columns,n)}));await this.sqlClient.raw(t.toQuery());const s=this.querySeparator()+this.sqlClient.schema.table(e.table,(function(t){e.non_unique?t.index(e.columns,n):t.unique(e.columns,n)})).toQuery();this.emit(`Success : ${s}`);const i=this.querySeparator()+this.sqlClient.schema.table(e.table,(function(t){e.non_unique?t.dropIndex(e.columns,n):t.dropUnique(e.columns,n)})).toQuery();a.data.object={upStatement:[{sql:s}],downStatement:[{sql:i}]}}catch(e){throw log.ppe(e,t),e}return a}async indexDelete(e){const t=this.indexDelete.name,a=new Result_1.default;log.api(`${t}:args:`,e);const n=e.indexName||null;try{e.table=e.tn;const t=this.sqlClient.schema.table(e.table,(function(t){e.non_unique_original?t.dropIndex(e.columns,n):t.dropUnique(e.columns,n)}));await this.sqlClient.raw(t.toQuery());const s=this.querySeparator()+this.sqlClient.schema.table(e.table,(function(t){e.non_unique_original?t.dropIndex(e.columns,n):t.dropUnique(e.columns,n)})).toQuery();this.emit(`Success : ${s}`);const i=this.querySeparator()+this.sqlClient.schema.table(e.table,(function(t){e.non_unique_original?t.index(e.columns,n):t.unique(e.columns,n)})).toQuery();a.data.object={upStatement:[{sql:s}],downStatement:[{sql:i}]}}catch(e){throw log.ppe(e,t),e}return a}async relationCreate(e){const t=this.relationCreate.name,a=new Result_1.default;log.api(`${t}:args:`,e);const n=e.foreignKeyName||null;try{const t=this.sqlClient.schema.table(e.childTable,(function(t){t=t.foreign(e.childColumn,n).references(e.parentColumn).on(e.parentTable),e.onUpdate&&(t=t.onUpdate(e.onUpdate)),e.onDelete&&t.onDelete(e.onDelete)}));await this.sqlClient.raw(t.toQuery());const s=this.querySeparator()+t.toQuery();this.emit(`Success : ${s}`);const i=this.querySeparator()+this.sqlClient.schema.table(e.childTable,(function(t){t.dropForeign(e.childColumn,n)})).toQuery();a.data.object={upStatement:[{sql:s}],downStatement:[{sql:i}]}}catch(e){throw log.ppe(e,t),e}return a}async relationDelete(e){const t=this.relationDelete.name,a=new Result_1.default;log.api(`${t}:args:`,e);const n=e.foreignKeyName||null;try{const t=this.sqlClient.schema.table(e.childTable,(function(t){t.dropForeign(e.childColumn,n)}));await this.sqlClient.raw(t.toQuery());const s=this.querySeparator()+this.sqlClient.schema.table(e.childTable,(function(t){t.dropForeign(e.childColumn,n)})).toQuery(),i=this.sqlClient.schema.table(e.childTable,(function(t){t.foreign(e.childColumn,n).references(e.parentColumn).on(e.parentTable)}));await this.sqlClient.raw(i.toQuery());const r=this.querySeparator()+i.toQuery();a.data.object={upStatement:[{sql:s}],downStatement:[{sql:r}]}}catch(e){throw log.ppe(e,t),e}return a}getKnexDataType(e){try{switch(e){case"int":return"integer";case"bigint":return"bigInteger";case"varchar":return"string";case"text":case"float":case"decimal":case"boolean":case"date":case"datetime":case"time":case"timestamp":case"binary":case"json":return e;case"enum":return"enu";default:return"specificType"}}catch(e){return log.debug(e),"string"}}getType(e,t){for(let a=0;a<t.length;++a)if(-1!==e.indexOf(t[a]))return 1;return 0}async fakerColumnsList(e){const t=this.fakerColumnsList.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{const t=path_1.default.join(e.seedsFolder,`${e.tn}.json`),n=await(0,util_1.promisify)(jsonfile_1.default.readFile)(t);a.data.list=n}catch(e){log.ppe(e,t),a.data.list=[]}return a}async fakerColumnsCreate(e){const t=this.fakerColumnsCreate.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{const t=path_1.default.join(e.seedsFolder,`${e.tn}.json`);await(0,util_1.promisify)(jsonfile_1.default.writeFile)(t,e.fakerColumns,{spaces:2}),this.emit(`Created : ${t}`)}catch(e){throw log.ppe(e,t),e}return a}async fakerColumnsUpdate(e){const t=this.fakerColumnsUpdate.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{this.emit("Success :")}catch(e){throw log.ppe(e,t),e}return a}async fakerColumnsDelete(e){const t=this.fakerColumnsDelete.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{this.emit("Success :")}catch(e){throw log.ppe(e,t),e}return a}async _getmetaDb(){}async seedInit(e){const t=this.seedInit.name,a=new Result_1.default;log.api(`${t}:args:`,e),console.log("in knex SeedInit");try{await(0,mkdirp_1.default)(e.seedsFolder)}catch(e){throw log.ppe(e,t),e}return a}async seedTerm(e){const t=this.seedInit.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{this.emit("Success : seedTerm")}catch(e){throw log.ppe(e,t),e}return a}async seedStart(e){const t=this.seedStart.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{this.emit("Seeding : Started"),await this.mockDb(e),this.emit("Seeding : Finished")}catch(e){throw log.ppe(e,t),e}return a}async seedStop(e){const t=this.seedStop.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{this.emit("Success : seedStop")}catch(e){throw log.ppe(e,t),e}return a}async seedSettingsRead(e){const t=this.seedSettingsRead.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{const t=path_1.default.join(e.seedsFolder,"__xseeds.json"),n=await(0,util_1.promisify)(jsonfile_1.default.readFile)(t);a.data=n}catch(e){log.ppe(e,t)}return a}async seedSettingsCreate(e){const t=this.seedSettingsCreate.name,a=new Result_1.default;log.api(`${t}:args:`,e);try{const t=path_1.default.join(e.seedsFolder,"__xseeds.json");await(0,util_1.promisify)(jsonfile_1.default.writeFile)(t,e.settings,{spaces:2}),this.emit("Success : Seed settings updated")}catch(e){throw log.ppe(e,t),e}return a}querySeparator(){return"/* xc */\n"}getTnPath(e){return e}async tableCreateStatement(e){}async tableInsertStatement(e){}async tableUpdateStatement(e){}async tableDeleteStatement(e){}async tableTruncateStatement(e){}async tableSelectStatement(e){}async sequelizeModelCreate(e){}genQuery(e,t=[],a=0){a&&(t=((Array.isArray(t)?t:[t])||[]).map((e=>"string"==typeof e?this.sanitize(e):e)));const n=this.sqlClient.raw(e,t).toQuery();return a?this.sanitize(n):this.unsanitize(n)}sanitize(e){return e.replace(/([^\\]|^)(\?+)/g,((e,t,a)=>`${t}${a.split("?").join("\\?")}`))}unsanitize(e){return e.replace(/\\[?]/g,"?")}genValue(e){return this.genQuery("?",[e],!0)}genIdentifier(e){return this.genQuery("??",[e],!0)}genRaw(e){const t=this.genQuery("?",[e],!0);return"number"==typeof e||"boolean"==typeof e?t:t.substring(1,t.length-1)}sanitiseDataType(e){if(/^[\w -]+(?:\(\d+(?:\s?,\s?\d+)?\))?$/.test(e))return e;throw new Error(`Invalid data type: ${e}`)}sanitiseDefaultValue(e){if(null!=e){if("string"==typeof e){if(["NULL","null","TRUE","true","FALSE","false"].includes(e))return e;if(/^\d+(\.\d+)?$/.test(e))return e;if(/^\w+\(\)$/.test(e))return e;if(/^\s*current_timestamp(?:\(\))?(?:\s+on\s+update\s+current_timestamp(?:\(\))?)?\s*$/i.test(e))return e;const t=e.match(/^(['"])(.*)\1$/);return t?this.genQuery("?",[t[2].replace('"'===t[1]?/\\"/g:/\\'/g,t[1])]):this.genQuery("?",[e])}return this.genQuery("?",[e])}}}exports.default=KnexClient},1440:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.connectionConfig=e,this.sqlClient=null}async testConnection(e){}migrationInit(e){}migrationUp(e){}migrationDown(e){}selectAll(e){}executeSqlFiles(){}async createDatabaseIfNotExists(e){}async createTableIfNotExists(e){}startTransaction(){}commit(){}rollback(){}hasTable(e){}hasDatabase(e){}async tableCreate(e){}async tableUpdate(e){}async columnCreate(e){}async columnUpdate(e){}async columnDelete(e){}async indexCreate(e){}async indexUpdate(e){}async indexDelete(e){}async relationCreate(e){}async relationUpdate(e){}async relationDelete(e){}async databaseList(e){}async tableList(e){}async schemaList(e){}async tableDelete(e){}async columnList(e){}async indexList(e){}async relationList(e){}async schemaCreate(e){}async schemaDelete(e){}async triggerList(e){}async triggerCreate(e){}async triggerRead(e){}async functionList(e){}async functionRead(e){}async procedureList(e){}async procedureRead(e){}async viewList(e){}async viewRead(e){}async sequenceList(e={}){}async sequenceCreate(e={}){}async sequenceUpdate(e={}){}async sequenceDelete(e={}){}async tableCreateStatement(e){}async tableInsertStatement(e){}async tableUpdateStatement(e){}async tableDeleteStatement(e){}async tableTruncateStatement(e){}async tableSelectStatement(e){}async totalRecords(e){}async getDefaultByteaOutputFormat(e={}){}}},7400:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SqlClientFactory=void 0;const s=n(a(9896)),i=a(9023),r=n(a(8187)),c=n(a(6123)),o=n(a(5869)),l=n(a(4321)),u=n(a(8831)),d=n(a(566)),m=n(a(7262)),p=n(a(6975));class h{static create(e){if(e.meta=e.meta||{},e.pool=e.pool||{min:0,max:5},e.meta.dbtype=e.meta.dbtype||"","mysql"===e.client||"mysql2"===e.client)return"tidb"===e.meta.dbtype?new m.default(e):"vitess"===e.meta.dbtype?new p.default(e):new r.default(e);if("sqlite3"===e.client)return new l.default(e);if("mssql"===e.client)return new c.default(e);if("oracledb"===e.client)return new o.default(e);if("pg"===e.client)return"yugabyte"===e.meta.dbtype?new d.default(e):new u.default(e);throw new Error("Database not supported")}}t.SqlClientFactory=h;t.default=class{static async create(e){return e.connection.ssl&&"object"==typeof e.connection.ssl&&(e.connection.ssl.caFilePath&&(e.connection.ssl.ca=(await(0,i.promisify)(s.default.readFile)(e.connection.ssl.caFilePath)).toString(),delete e.connection.ssl.caFilePath),e.connection.ssl.keyFilePath&&(e.connection.ssl.key=(await(0,i.promisify)(s.default.readFile)(e.connection.ssl.keyFilePath)).toString(),delete e.connection.ssl.keyFilePath),e.connection.ssl.certFilePath&&(e.connection.ssl.cert=(await(0,i.promisify)(s.default.readFile)(e.connection.ssl.certFilePath)).toString(),delete e.connection.ssl.certFilePath)),h.create(e)}}},4513:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getType=t.getColumnType=t.getDataType=t.getChartQuery=t.getMysqlSchemaQuery=t.getStepArray=t.getStepArraySimple=t.numberGetFixed=t.numberGetLength=t.numberRound=t.round=t.findObjectInArrayByKey=t.findOrInsertObjectArrayByKey=void 0;t.findOrInsertObjectArrayByKey=(e,t,a)=>{let n=0,s=0;for(s=0;s<a.length;++s)if(t in a[s]&&e[t]===a[s][t]){n=1;break}return n||a.push(e),a[s]};t.findObjectInArrayByKey=(e,t,a)=>{for(let n=0;n<a.length;++n)if(a[n][e]===t)return a[n];return null};t.round=function(e,t){const a=Math.pow(10,t),n=e*a;return Math.round(n)/a};t.numberRound=(e,t)=>{const a=Math.pow(10,t),n=e*a;return Math.round(n)/a};t.numberGetLength=e=>{let t=e;return e<0&&(t*=-1),t.toString().length};t.numberGetFixed=e=>parseInt(e.toFixed());t.getStepArraySimple=function(e,t,a){const n=[];for(let s=e;s<=t;s+=a)n.push(s);return n};t.getStepArray=(e,a,n)=>{e=(0,t.numberGetFixed)(e),a=(0,t.numberGetFixed)(a);let s=e-(n=(0,t.numberGetFixed)(n))/2,i=a+n/2;s=(0,t.numberGetFixed)(s),i=(0,t.numberGetFixed)(i);const r=(0,t.numberGetLength)(s),c=(0,t.numberGetLength)(i),o=(0,t.numberGetLength)(n);r>1&&(s=(0,t.numberRound)(s,-1)),c>2&&(i=(0,t.numberRound)(i,-1)),1!==o&&(n=(0,t.numberRound)(n,-1));const l=[];for(let e=s;e<i;e+=n)l.push(e);return l.push(i),l};t.getMysqlSchemaQuery=function(){return"select c.table_name as tn, c.column_name as cn, c.ordinal_position as cop,c.column_key as ck,c.is_nullable as nrqd, c.data_type, c.column_type as ct,c.extra as ext,c.privileges as priv, c.cc,c.cdf as cdf,c.data_type,c.character_maximum_length as clen,c.numeric_precision as np,c.numeric_scale as ns,c.datetime_precision as dp, k.constraint_name as cstn, k.referenced_table_name as rtn, k.referenced_column_name as rcn, s.index_name,s.seq_in_index, v.table_name as is_view from information_schema.columns as c left join information_schema.key_column_usage as k on c.column_name=k.column_name and c.table_schema = k.referenced_table_schema and c.table_name = k.table_name left join information_schema.statistics as s on c.column_name = s.column_name and c.table_schema = s.index_schema and c.table_name = s.table_name LEFT JOIN information_schema.VIEWS as v ON c.table_schema = v.table_schema and c.table_name = v.table_name where c.table_schema=? order by c.table_name, c.ordinal_position"};t.getChartQuery=function(){return"select ? as ??, count(*) as _count from ?? where ?? between ? and ? "};t.getDataType=function(e,t){for(let a=0;a<t.length;++a)if(-1!==e.indexOf(t[a]))return 1;return 0};t.getColumnType=function(e){return(0,t.getDataType)(e.data_type,["varchar","text","char","tinytext","mediumtext","longtext","ntext","image","blob","mediumblob","longblob","binary","varbinary","character","character varying","nchar","nvarchar","clob","nvarchar2","varchar2","raw","long raw","bfile","nclob"])?"string":(0,t.getDataType)(e.data_type,["bit","integer","int","smallint","mediumint","bigint","tinyint","int2","int4","int8","long","serial","bigserial","smallserial","bool","boolean","number"])?"int":(0,t.getDataType)(e.data_type,["float","double","decimal","numeric","real","double precision","real","money","smallmoney","dec"])?"float":(0,t.getDataType)(e.data_type,["date","datetime","timestamp","time","year","timestamp without time zone","timestamp with time zone","time without time zone","time with time zone","datetime2","smalldatetime","datetimeoffset","interval year","interval day"])?"date":"string"};t.getType=function(e,t){return t.includes(e)}},6123:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(1832)),i=n(a(133)),r=n(a(4020)),c=n(a(5924)),o=n(a(5578)),l=new c.default("MssqlClient");class u extends r.default{constructor(e){super(e)}async sequenceDelete(e){const t=this.sequenceDelete.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=this.querySeparator()+`DROP SEQUENCE ${e.sequence_name}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+`CREATE SEQUENCE ${e.sequence_name}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async sequenceList(e){const t=this.sequenceList.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("SELECT * FROM sys.SEQUENCES;");a.data.list=t.map((e=>Object.assign(Object.assign({},e),{sequence_name:e.name,original_sequence_name:e.name})))}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async sequenceCreate(e){const t=this.sequenceCreate.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=this.querySeparator()+`CREATE SEQUENCE ${e.sequence_name}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+`DROP SEQUENCE ${e.sequence_name}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async sequenceUpdate(e){const t=this.sequenceUpdate.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=this.querySeparator()+`ALTER SEQUENCE ${e.original_sequence_name} RENAME TO ${e.sequence_name};`,n=this.querySeparator()+`ALTER SEQUENCE ${e.sequence_name} RENAME TO ${e.original_sequence_name};`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:n}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async testConnection(e={}){const t=this.testConnection.name,a=new o.default;l.api(`${t}:args:`,e);try{await this.sqlClient.raw("SELECT 1+1 AS data")}catch(e){l.ppe(e),a.code=-1,a.message=e.message}finally{l.api(`${t}:result:`,a)}return a}getKnexDataTypes(){const e=new o.default;return e.data.list=["bigint","binary","bit","char","date","datetime","datetime2","datetimeoffset","decimal","float","geography","geometry","heirarchyid","image","int","money","nchar","ntext","numeric","nvarchar","real","json","smalldatetime","smallint","smallmoney","sql_variant","sysname","text","time","timestamp","tinyint","uniqueidentifier","varbinary","xml","varchar"],e}async version(e={}){const t=this.version.name,a=new o.default;l.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SELECT SERVERPROPERTY('productversion') AS version, SERVERPROPERTY ('productlevel') AS level, SERVERPROPERTY ('edition') AS edition, @@version AS versionD");a.data.object={};const t=e[0],n=t.version.split(".");a.data.object.version=t.version,a.data.object.primary=n[0],a.data.object.major=n[1],a.data.object.minor=n[2]}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async createDatabaseIfNotExists(e){const t=this.createDatabaseIfNotExists.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=JSON.parse(JSON.stringify(this.connectionConfig));delete t.connection.database;const a=(0,s.default)(t);0===(await a.raw(`SELECT name from sys.databases WHERE name = '${e.database}'`)).length&&await a.raw(`CREATE DATABASE  ${e.database}`),this.sqlClient=(0,s.default)(this.connectionConfig),await a.destroy(),this.connectionConfig.searchPath&&this.connectionConfig.searchPath[0]&&await this.sqlClient.raw(" IF NOT EXISTS ( SELECT  *\n                            FROM    sys.schemas\n                            WHERE   name = ? )\n                EXEC('CREATE SCHEMA ??')",[this.connectionConfig.searchPath[0],this.connectionConfig.searchPath[0]])}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async dropDatabase(e){const t=this.dropDatabase.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=JSON.parse(JSON.stringify(this.connectionConfig));delete t.connection.database;const a=(0,s.default)(t);await this.sqlClient.destroy(),this.sqlClient=a,l.debug("dropping database:",e),await a.raw(`ALTER DATABASE ${e.database} SET SINGLE_USER WITH ROLLBACK IMMEDIATE;\n         DROP DATABASE ${e.database};`)}catch(e){l.ppe(e,t)}return l.api(`${t}: result`,a),a}async createTableIfNotExists(e){const t=this.createTableIfNotExists.name,a=new o.default;l.api(`${t}:args:`,e);try{await this.sqlClient.schema.withSchema(this.schema).hasTable(e.tn)?l.debug(`${this.getTnPath(e.tn)} tables exists`):(await this.sqlClient.schema.withSchema(this.schema).createTable(e.tn,(function(e){e.increments(),e.string("title").notNullable(),e.string("titleDown").nullable(),e.string("description").nullable(),e.integer("batch").nullable(),e.string("checksum").nullable(),e.integer("status").nullable(),e.dateTime("created"),e.timestamps()})),l.debug("Table created:",`${this.getTnPath(e.tn)}`))}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async hasTable(e){const t=this.hasTable.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data.value=await this.sqlClient.schema.withSchema(this.schema).hasTable(e.tn)}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async hasDatabase(e){const t=this.hasDatabase.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw(`SELECT name FROM sys.databases WHERE name = '${e.databaseName}'`);a.data.value=t.length>0}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async databaseList(e={}){const t=this.databaseList.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data.list=await this.sqlClient.raw("SELECT name AS database_name, database_id, create_date FROM sys.databases ORDER BY name")}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async tableList(e={}){const t=this.tableList.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data.list=await this.sqlClient.raw("SELECT schema_name(t.schema_id) AS schema_name,\n        t.name AS tn, t.create_date, t.modify_date FROM sys.tables t WHERE schema_name(t.schema_id) = ? ORDER BY schema_name,tn ",[this.schema||"dbo"])}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async schemaList(e={}){const t=this.schemaList.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data.list=await this.sqlClient.raw(`SELECT name AS schema_name FROM master.${this.schema}.sysdatabases WHERE name not in ('master', 'tempdb', 'model', 'msdb');`)}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async columnList(e){const t=this.columnList.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw(`SELECT\n      c.table_name AS tn,\n       CASE WHEN trg1.trigger_name IS NULL THEN CAST(0 AS BIT) ELSE CAST(1 AS BIT) END AS au,\n       c.column_name AS cn,\n       c.ordinal_position AS cop,\n      pk.constraint_type AS ck,\n      CASE WHEN COLUMNPROPERTY(object_id(CONCAT('${this.schema}.', c.TABLE_NAME)), c.COLUMN_NAME, 'IsIdentity') = 1\n      THEN\n        1\n      ELSE\n        0\n      END AS ai,\n      c.is_nullable AS nrqd,\n      c.data_type AS dt,\n      c.column_default AS cdf,c.character_maximum_length AS clen,\n      c.character_octet_length,c.numeric_precision AS np,c.numeric_scale AS ns,c.datetime_precision AS dp,c.character_set_name AS csn,\n      c.collation_name AS clnn,\n      pk.constraint_type AS cst, pk.ordinal_position AS op, pk.constraint_name AS pk_constraint_name,\n      fk.parent_table AS rtn, fk.parent_column AS rcn,\n      v.table_name AS is_view,\n      df.default_constraint_name\n  FROM INFORMATION_SCHEMA.COLUMNS c\n    left join\n      ( SELECT kc.constraint_name, kc.table_name,kc.column_name, kc.ordinal_position,tc.constraint_type\n        FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE kc\n          INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS tc\n            ON kc.constraint_name = tc.constraint_name AND tc.constraint_type in ('primary key')\n        WHERE kc.table_catalog='${e.databaseName}' AND kc.table_schema='${this.schema}'\n        ) pk\n      ON \n      pk.table_name = c.table_name AND pk.column_name=c.column_name\n    left join\n          ( SELECT\n                ccu.table_name AS child_table\n                ,ccu.column_name AS child_column\n                ,kcu.table_name AS parent_table\n                ,kcu.column_name AS parent_column\n                ,ccu.constraint_name\n            FROM INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE ccu\n                INNER JOIN INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS rc\n                    ON ccu.constraint_name = rc.constraint_name\n                INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE kcu\n                    ON kcu.constraint_name = rc.unique_constraint_name  ) fk\n      ON\n      fk.child_table = c.table_name AND fk.child_column=c.column_name\n    left join INFORMATION_SCHEMA.VIEWS v\n      ON v.table_name=c.table_name\n    left join (\n              SELECT\n                  default_constraints.name default_constraint_name, all_columns.name name\n              FROM\n                  sys.all_columns\n                      INNER JOIN\n                  sys.tables\n                      ON all_columns.object_id = tables.object_id\n                      INNER JOIN\n                  sys.schemas\n                      ON tables.schema_id = schemas.schema_id\n                      INNER JOIN\n                  sys.default_constraints\n                      ON all_columns.default_object_id = default_constraints.object_id\n              WHERE\n        schemas.name = '${this.schema}'\n    AND tables.name =  '${e.tn}') df ON df.name = c.column_name\n\n     left join (  SELECT trg.name AS trigger_name,\n               tab.name AS [table1]\n          FROM sys.triggers trg\n              left join sys.objects tab\n                  ON trg.parent_id = tab.object_id\n          WHERE tab.name =  '${e.tn}') trg1 ON trg1.trigger_name = CONCAT('xc_trigger_${e.tn}_' , c.column_name)\n\n    WHERE c.table_catalog='${e.databaseName}' AND c.table_schema='${this.schema}' AND c.table_name = '${e.tn}'\n    ORDER BY c.table_name, c.ordinal_position`);for(let e=0;e<t.length;e++){const a=t[e];a.pk="PRIMARY KEY"===a.ck,a.not_nullable="NO"===a.nrqd,a.rqd="NO"===a.nrqd,a.ai=1===a.ai,a.nrqd="YES"===a.nrqd,a.cno=a.cn,a.dtxp=a.clen||a.np||a.dp,a.dtxs=a.ns,a.au=!!a.au}a.data.list=t}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async indexList(e={}){const t=this.indexList.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw(`SELECT  t.[name] AS table_view,\n        CASE WHEN t.[type] = 'U' THEN 'Table'\n            WHEN t.[type] = 'V' THEN 'View'\n            END AS [object_type],\n        i.index_id,\n        CASE WHEN i.is_primary_key = 1 THEN 'Primary key'\n            WHEN i.is_unique = 1 THEN 'Unique'\n            else 'Not Unique' END AS [type],\n        i.[name] AS index_name,\n        substring(column_names, 1, len(column_names)-1) AS [columns],\n        CASE WHEN i.[type] = 1 THEN 'Clustered index'\n            WHEN i.[type] = 2 THEN 'Nonclustered unique index'\n            WHEN i.[type] = 3 THEN 'XML index'\n            WHEN i.[type] = 4 THEN 'Spatial index'\n            WHEN i.[type] = 5 THEN 'Clustered columnstore index'\n            WHEN i.[type] = 6 THEN 'Nonclustered columnstore index'\n            WHEN i.[type] = 7 THEN 'Nonclustered hash index'\n            END AS index_type\n    FROM sys.objects t\n        INNER JOIN sys.indexes i\n            ON t.object_id = i.object_id\n        cross apply (SELECT col.[name] + ',' + CAST(ic.key_ordinal AS varchar)  + ','\n                        FROM sys.index_columns ic\n                            INNER JOIN sys.columns col\n                                ON ic.object_id = col.object_id\n                                AND ic.column_id = col.column_id\n                        WHERE ic.object_id = t.object_id\n                            AND ic.index_id = i.index_id\n                                ORDER BY col.column_id\n                                for xml path ('') ) D (column_names)\n    WHERE t.is_ms_shipped <> 1\n    AND index_id > 0 AND t.name = '${this.getTnPath(e.tn)}'\n    ORDER BY schema_name(t.schema_id) + '.' + t.[name], i.index_id`),n=[];for(let e=0,a=0;e<t.length;++e,++a)if(t[e].key_name=t[e].index_name,t[e].non_unique="Not Unique"===t[e].type?1:0,t[e].non_unique_original="Not Unique"===t[e].type?1:0,t[e].pk="Primary key"===t[e].type,t[e].columns=t[e].columns.split(","),2===t[e].columns.length)n[a]=t[e],n[a].cn=t[e].columns[0],n[a].seq_in_index=1;else{const s=t[e].columns.slice();for(let i=0;i<s.length;i+=2,++a)n[a]=JSON.parse(JSON.stringify(t[e])),n[a].cn=s[i].trim(),n[a].seq_in_index=parseInt(s[i+1]);a--}a.data.list=n}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async constraintList(e={}){const t=this.constraintList.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw(`SELECT  t.[name] AS table_view,\n        CASE WHEN t.[type] = 'U' THEN 'Table'\n            WHEN t.[type] = 'V' THEN 'View'\n            END AS [object_type],\n        i.index_id,\n        CASE WHEN i.is_primary_key = 1 THEN 'Primary key'\n            WHEN i.is_unique = 1 THEN 'Unique'\n            else 'Not Unique' END AS [type],\n        i.[name] AS index_name,\n        substring(column_names, 1, len(column_names)-1) AS [columns],\n        CASE WHEN i.[type] = 1 THEN 'Clustered index'\n            WHEN i.[type] = 2 THEN 'Nonclustered unique index'\n            WHEN i.[type] = 3 THEN 'XML index'\n            WHEN i.[type] = 4 THEN 'Spatial index'\n            WHEN i.[type] = 5 THEN 'Clustered columnstore index'\n            WHEN i.[type] = 6 THEN 'Nonclustered columnstore index'\n            WHEN i.[type] = 7 THEN 'Nonclustered hash index'\n            END AS index_type\n    FROM sys.objects t\n        INNER JOIN sys.indexes i\n            ON t.object_id = i.object_id\n        cross apply (SELECT col.[name] + ', ' + CAST(ic.key_ordinal AS varchar)  + ', '\n                        FROM sys.index_columns ic\n                            INNER JOIN sys.columns col\n                                ON ic.object_id = col.object_id\n                                AND ic.column_id = col.column_id\n                        WHERE ic.object_id = t.object_id\n                            AND ic.index_id = i.index_id\n                                ORDER BY col.column_id\n                                for xml path ('') ) D (column_names)\n    WHERE t.is_ms_shipped <> 1\n    AND index_id > 0 AND t.name = '${this.getTnPath(e.tn)}'\n    ORDER BY schema_name(t.schema_id) + '.' + t.[name], i.index_id`),n=[];for(let e=0,a=0;e<t.length;++e,++a)if(t[e].cstn=t[e].index_name,t[e].cst=t[e].type,t[e].columns=t[e].columns.split(","),2===t[e].columns.length)n[a]=t[e],n[a].cn=t[e].columns[0],n[a].op=1;else{const s=t[e].columns.slice();for(let i=0;i<s.length;i+=2,++a)n[a]=JSON.parse(JSON.stringify(t[e])),n[a].cn=s[i],n[a].op=parseInt(s[i+1]);a--}a.data.list=n}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async relationList(e={}){const t=this.relationList.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw(`SELECT  fk_tab.name AS tn, '>-' AS rel, pk_tab.name AS rtn,\n        fk_cols.constraint_column_id AS no, fk_col.name AS cn, ' = ' AS [join],\n        pk_col.name AS rcn, fk.name AS cstn,\n        fk.update_referential_action_desc AS ur, fk.delete_referential_action_desc AS dr\n        FROM sys.foreign_keys fk\n        INNER JOIN sys.tables fk_tab\n            ON fk_tab.object_id = fk.parent_object_id\n        INNER JOIN sys.tables pk_tab\n            ON pk_tab.object_id = fk.referenced_object_id\n        INNER JOIN sys.foreign_key_columns fk_cols\n            ON fk_cols.constraint_object_id = fk.object_id\n        INNER JOIN sys.columns fk_col\n            ON fk_col.column_id = fk_cols.parent_column_id\n            AND fk_col.object_id = fk_tab.object_id\n        INNER JOIN sys.columns pk_col\n            ON pk_col.column_id = fk_cols.referenced_column_id\n            AND pk_col.object_id = pk_tab.object_id\n        WHERE fk_tab.name = '${this.getTnPath(e.tn)}'\n        ORDER BY  fk_tab.name, pk_tab.name, fk_cols.constraint_column_id`),n={NO_ACTION:"NO ACTION",CASCADE:"CASCADE",RESTRICT:"RESTRICT",SET_NULL:"SET NULL",SET_DEFAULT:"SET DEFAULT"};for(const e of t)e.ur=n[e.ur],e.dr=n[e.dr];a.data.list=t}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async relationListAll(e={}){const t=this.relationList.name,a=new o.default;l.api(`${t}:args:`,e);try{const e=await this.raw("SELECT  fk_tab.name AS tn, '>-' AS rel, pk_tab.name AS rtn,\n        fk_cols.constraint_column_id AS no, fk_col.name AS cn, ' = ' AS [join],\n        pk_col.name AS rcn, fk.name AS cstn,\n        fk.update_referential_action_desc AS ur, fk.delete_referential_action_desc AS dr\n        FROM sys.foreign_keys fk\n        INNER JOIN sys.tables fk_tab\n            ON fk_tab.object_id = fk.parent_object_id\n        INNER JOIN sys.tables pk_tab\n            ON pk_tab.object_id = fk.referenced_object_id\n        INNER JOIN sys.foreign_key_columns fk_cols\n            ON fk_cols.constraint_object_id = fk.object_id\n        INNER JOIN sys.columns fk_col\n            ON fk_col.column_id = fk_cols.parent_column_id\n            AND fk_col.object_id = fk_tab.object_id\n        INNER JOIN sys.columns pk_col\n            ON pk_col.column_id = fk_cols.referenced_column_id\n            AND pk_col.object_id = pk_tab.object_id\n        ORDER BY  fk_tab.name, pk_tab.name, fk_cols.constraint_column_id"),t={NO_ACTION:"NO ACTION",CASCADE:"CASCADE",RESTRICT:"RESTRICT",SET_NULL:"SET NULL",SET_DEFAULT:"SET DEFAULT"};for(const a of e)a.ur=t[a.ur],a.dr=t[a.dr];a.data.list=e}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async triggerList(e={}){const t=this.triggerList.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=`SELECT trg.name AS trigger_name,\n               tab.name AS [table],\n              CASE WHEN is_instead_of_trigger = 1 THEN 'Instead of'\n                  else 'After' END AS [activation],\n              (CASE WHEN objectproperty(trg.object_id, 'ExecIsUpdateTrigger') = 1\n                          THEN 'Update' else '' end\n              + CASE WHEN objectproperty(trg.object_id, 'ExecIsDeleteTrigger') = 1\n                          THEN 'Delete' else '' end\n              + CASE WHEN objectproperty(trg.object_id, 'ExecIsInsertTrigger') = 1\n                          THEN 'Insert' else '' end\n              ) AS [event],\n              CASE WHEN trg.parent_class = 1 THEN 'Table trigger'\n                  WHEN trg.parent_class = 0 THEN 'Database trigger'\n              END [class],\n              CASE WHEN trg.[type] = 'TA' THEN 'Assembly (CLR) trigger'\n                  WHEN trg.[type] = 'TR' THEN 'SQL trigger'\n                  else '' END AS [type],\n              CASE WHEN is_disabled = 1 THEN 'Disabled'\n                  else 'Active' END AS [status],\n              object_definition(trg.object_id) AS [definition]\n          FROM sys.triggers trg\n              left join sys.objects tab\n                  ON trg.parent_id = tab.object_id\n          WHERE tab.name =  '${this.getTnPath(e.tn)}'\n          ORDER BY trg.name;`,n=await this.sqlClient.raw(t);for(let e=0;e<n.length;e++){const t=n[e];t.statement=t.definition,t.trigger=t.trigger_name,t.event=t.event.toUpperCase(),t.timing=t.activation.toUpperCase()}a.data.list=n}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async functionList(e={}){const t=this.functionList.name,a=new o.default;l.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SELECT o.name AS function_name,definition, o.create_date AS created, o.modify_date AS modified,o.*\n        FROM sys.sql_modules AS m\n        JOIN sys.objects AS o ON m.object_id = o.object_id\n        AND type IN ('FN', 'IF', 'TF')");for(let t=0;t<e.length;t++){const a=e[t];"FN"===a.type&&(a.type="FUNCTION")}a.data.list=e}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async procedureList(e={}){const t=this.procedureList.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw(`SELECT SPECIFIC_NAME AS procedure_name, ROUTINE_TYPE AS [type],LAST_ALTERED AS modified, CREATED AS created,ROUTINE_DEFINITION AS definition ,pc.*\n        FROM ${e.databaseName}.INFORMATION_SCHEMA.ROUTINES AS pc WHERE routine_type = 'PROCEDURE'`);a.data.list=t}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async viewList(e={}){const t=this.viewList.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("SELECT v.name AS view_name,v.*,m.* FROM sys.views v INNER JOIN sys.schemas s ON s.schema_id = v.schema_id AND schema_name(v.schema_id) = ?\n        INNER JOIN sys.sql_modules AS m ON m.object_id = v.object_id",[this.schema||"dbo"]);a.data.list=t}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async functionRead(e={}){const t=this.functionRead.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw(`SELECT o.name AS function_name,definition AS create_function, o.create_date AS created, o.modify_date AS modified,o.*\n        FROM sys.sql_modules AS m\n        JOIN sys.objects AS o ON m.object_id = o.object_id\n        AND type IN ('FN', 'IF', 'TF') AND o.name = '${e.function_name}'`);for(let e=0;e<t.length;e++){const a=t[e];"FN"===a.type&&(a.type="FUNCTION")}a.data.list=t}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async procedureRead(e={}){const t=this.procedureRead.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw(`SELECT SPECIFIC_NAME AS procedure_name, ROUTINE_TYPE AS [type],LAST_ALTERED AS modified, CREATED AS created,ROUTINE_DEFINITION AS create_procedure ,pc.*\n        FROM ${e.databaseName}.INFORMATION_SCHEMA.ROUTINES AS pc WHERE routine_type = 'PROCEDURE' AND SPECIFIC_NAME='${e.procedure_name}'`);a.data.list=t}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async viewRead(e={}){const t=this.viewRead.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw(`SELECT v.name AS view_name,v.*,m.*, m.definition AS view_definition FROM sys.views v INNER JOIN sys.schemas s ON s.schema_id = v.schema_id\n        INNER JOIN sys.sql_modules AS m ON m.object_id = v.object_id WHERE v.name = '${e.view_name}'`);a.data.list=t}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async triggerRead(e={}){const t=this.triggerRead.name,a=new o.default;l.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw(`SELECT [so].[name] AS [trigger_name], [so].[crdate] AS [created],\n        USER_NAME([so].[uid]) AS [trigger_owner], USER_NAME([so2].[uid]) AS [ts],\n        OBJECT_NAME([so].[parent_obj]) AS [tn],\n        OBJECTPROPERTY( [so].[id], 'ExecIsUpdateTrigger') AS [isupdate],\n        OBJECTPROPERTY( [so].[id], 'ExecIsDeleteTrigger') AS [isdelete],\n        OBJECTPROPERTY( [so].[id], 'ExecIsInsertTrigger') AS [isinsert],\n        OBJECTPROPERTY( [so].[id], 'ExecIsAfterTrigger') AS [isafter],\n        OBJECTPROPERTY( [so].[id], 'ExecIsInsteadOfTrigger') AS [isinsteadof],\n        OBJECTPROPERTY([so].[id], 'ExecIsTriggerDisabled') AS [disabled],df.definition\n        FROM sysobjects AS [so]\n        INNER JOIN sys.sql_modules AS df ON object_id = so.id\n        INNER JOIN sysobjects AS so2 ON so.parent_obj = so2.Id\n        WHERE [so].[type] = 'TR' AND so2.name = '${this.getTnPath(e.tn)}' AND [so].[name] = '${e.trigger_name}'`);for(let e=0;e<t.length;e++){const a=t[e];a.table=a.tn,a.statement=a.definition,a.trigger=a.trigger_name,a.event=[],a.timing=[]}a.data.list=t}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async schemaCreate(e={}){const t=this.schemaCreate.name,a=new o.default;l.api(`${t}:args:`,e);try{0===(await this.sqlClient.raw(`SELECT name FROM sys.databases WHERE name = '${e.database_name}'`)).length&&await this.sqlClient.raw(`CREATE DATABASE  ${e.database_name}`)}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async schemaDelete(e={}){const t=this.schemaDelete.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=JSON.parse(JSON.stringify(this.connectionConfig));if(t.connection.database===e.database_name){delete t.connection.database;const e=(0,s.default)(t);await this.sqlClient.destroy(),this.sqlClient=e}await this.sqlClient.raw(`ALTER DATABASE ${e.database_name} SET SINGLE_USER WITH ROLLBACK IMMEDIATE;\n         DROP DATABASE ${e.database_name};`)}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async triggerDelete(e={}){const t=this.triggerDelete.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=`${this.querySeparator()}DROP TRIGGER IF EXISTS ${e.trigger_name}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:`${this.querySeparator()}${e.oldStatement}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async functionDelete(e={}){const t=this.functionDelete.name,a=new o.default;l.api(`${t}:args:`,e);const n=this.querySeparator()+`DROP FUNCTION IF EXISTS ${e.function_name}`,s=this.querySeparator()+e.create_function;try{await this.sqlClient.raw(n),a.data.object={upStatement:[{sql:n}],downStatement:[{sql:s}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async procedureDelete(e={}){const t=this.procedureDelete.name,a=new o.default;l.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP PROCEDURE IF EXISTS ${e.procedure_name}`),a.data.object={upStatement:[{sql:this.querySeparator()+`DROP PROCEDURE IF EXISTS ${e.procedure_name}`}],downStatement:[{sql:this.querySeparator()+`${e.create_procedure}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async functionCreate(e={}){const t=this.functionCreate.name,a=new o.default;l.api(`${t}:args:`,e);try{await this.sqlClient.raw(`${e.create_function}`),a.data.object={upStatement:[{sql:this.querySeparator()+`${e.create_function}`}],downStatement:[{sql:this.querySeparator()+`DROP FUNCTION IF EXISTS ${e.function_name}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async functionUpdate(e={}){const t=this.functionUpdate.name,a=new o.default;l.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP FUNCTION IF EXISTS ${e.function_name}`),await this.sqlClient.raw(`${e.create_function}`),a.data.object={upStatement:[{sql:this.querySeparator()+`DROP FUNCTION IF EXISTS ${e.function_name};${this.querySeparator()}\n${e.create_function}`}],downStatement:[{sql:this.querySeparator()+`DROP FUNCTION IF EXISTS ${e.function_name};${this.querySeparator()} ${e.oldCreateFunction}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async procedureCreate(e={}){const t=this.procedureCreate.name,a=new o.default;l.api(`${t}:args:`,e);try{await this.sqlClient.raw(`${e.create_procedure}`),a.data.object={upStatement:[{sql:this.querySeparator()+`${e.create_procedure}`}],downStatement:[{sql:this.querySeparator()+`DROP PROCEDURE ${e.procedure_name}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async procedureUpdate(e={}){const t=this.procedureUpdate.name,a=new o.default;l.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP PROCEDURE IF EXISTS ${e.procedure_name}`),await this.sqlClient.raw(`${e.create_procedure}`),a.data.object={upStatement:[{sql:this.querySeparator()+`DROP PROCEDURE IF EXISTS ${e.procedure_name};${this.querySeparator()}\n${e.create_procedure}`}],downStatement:[{sql:this.querySeparator()+`DROP PROCEDURE IF EXISTS ${e.procedure_name};${this.querySeparator()}${e.oldCreateProcedure}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async triggerCreate(e={}){const t=this.triggerCreate.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=this.genQuery(`CREATE TRIGGER ?? ON ?? \n${e.timing} ${e.event}\n as\n${e.statement}`,[e.trigger_name,this.getTnPath(e.tn)]);await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:this.querySeparator()+`DROP TRIGGER ${e.trigger_name}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async triggerUpdate(e={}){const t=this.triggerUpdate.name,a=new o.default;l.api(`${t}:args:`,e);try{await this.sqlClient.raw(`ALTER TRIGGER ${e.trigger_name} ON ${this.getTnPath(e.tn)} \n${e.timing} ${e.event}\n AS\n${e.statement}`),a.data.object={upStatement:[{sql:this.querySeparator()+`ALTER TRIGGER ${e.trigger_name} ON ${this.getTnPath(e.tn)} \n${e.timing} ${e.event}\n AS\n${e.statement}`}],downStatement:[{sql:this.querySeparator()+`ALTER TRIGGER ${e.trigger_name} ON ${this.getTnPath(e.tn)} \n${e.timing} ${e.event}\n AS\n${e.statement}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async viewCreate(e={}){const t=this.viewCreate.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=e.view_definition;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:this.querySeparator()+`DROP VIEW ${e.view_name}`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async viewUpdate(e={}){const t=this.viewUpdate.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=e.view_definition;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:this.querySeparator()+`DROP VIEW ${e.view_name} ; ${this.querySeparator()}${e.oldViewDefination};`}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async viewDelete(e={}){const t=this.viewDelete.name,a=new o.default;l.api(`${t}:args:`,e);try{const t=`DROP VIEW ${e.view_name}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:this.querySeparator()+e.oldViewDefination}]}}catch(e){throw l.ppe(e,t),e}return l.api(`${t}: result`,a),a}async tableCreate(e){const t=this.tableCreate.name,a=new o.default;l.api(`${t}:args:`,e);try{e.table=e.tn,e.sqlClient=this.sqlClient;const t=this.querySeparator()+this.createTable(e.tn,e);await this.sqlClient.raw(t);const n=this.querySeparator()+this.sqlClient.schema.withSchema(this.schema).dropTable(e.table).toString();this.emit(`Success : ${t}`);const s=await this.afterTableCreate(e);a.data.object={upStatement:[{sql:t},...s.upStatement],downStatement:[...s.downStatement,{sql:n}]}}catch(e){throw l.ppe(e,t),e}return a}async afterTableCreate(e){const t={upStatement:[],downStatement:[]};let a="",n="";const s=e.columns.find((e=>e.pk));if(!s)return t;for(let t=0;t<e.columns.length;t++){const i=e.columns[t];if(i.au){const t=`[${this.schema}].[xc_trigger_${e.table_name}_${i.column_name}]`,r=this.querySeparator()+this.genQuery("CREATE TRIGGER ?? ON ?? AFTER UPDATE\n                  AS\n                  BEGIN\n                      SET NOCOUNT ON;\n                      UPDATE ?? Set ?? = GetDate() WHERE ?? in (SELECT ?? FROM Inserted)\n                  END;",[t,this.getTnPath(e.table_name),this.getTnPath(e.table_name),i.column_name,s.column_name,s.column_name]);a+=r,await this.sqlClient.raw(r),n+=this.querySeparator()+`DROP TRIGGER IF EXISTS ${this.schema}.${t};`}}return t.upStatement[0]={sql:a},t.downStatement[0]={sql:n},t}async afterTableUpdate(e){const t={upStatement:[],downStatement:[]};let a="",n="";const s=e.columns.find((e=>e.pk));if(!s)return t;for(let t=0;t<e.columns.length;t++){const i=e.columns[t];if(i.au&&1===i.altered){const t=`xc_trigger_${e.table_name}_${i.column_name}`,r=this.querySeparator()+`CREATE TRIGGER [${this.schema}].[${t}] ON  [${this.schema}].[${e.table_name}] AFTER UPDATE\n                  AS\n                  BEGIN\n                      SET NOCOUNT ON;\n                      UPDATE [${this.schema}].[${e.table_name}] Set [${i.column_name}] = GetDate() WHERE [${s.column_name}] in (SELECT [${s.column_name}] FROM Inserted)\n                  END;`;a+=r,await this.sqlClient.raw(r),n+=this.querySeparator()+`DROP TRIGGER IF EXISTS [${this.schema}].[${t}];`}}return t.upStatement[0]={sql:a},t.downStatement[0]={sql:n},t}async tableUpdate(e){const t=this.tableUpdate.name,a=new o.default;l.api(`${t}:args:`,e);try{e.table=e.tn;const t=e.originalColumns;e.connectionConfig=this._connectionConfig,e.sqlClient=this.sqlClient;let n="",s="";for(let a=0;a<e.columns.length;++a){const r=(0,i.default)(t,{cn:e.columns[a].cno});4&e.columns[a].altered?(n+=this.alterTableRemoveColumn(e.table,e.columns[a],r,n),s+=this.alterTableAddColumn(e.table,r,e.columns[a],s)):2&e.columns[a].altered||8&e.columns[a].altered?(n+=this.alterTableChangeColumn(e.table,e.columns[a],r,n),s+=this.alterTableChangeColumn(e.table,r,e.columns[a],s)):1&e.columns[a].altered&&(n+=this.alterTableAddColumn(e.table,e.columns[a],r,n),s+=this.alterTableRemoveColumn(e.table,e.columns[a],r,s))}n+=this.alterTablePK(e.table,e.columns,e.originalColumns,n),s+=this.alterTablePK(e.table,e.originalColumns,e.columns,s),await this.sqlClient.raw(n),console.log(n);const r=await this.afterTableUpdate(e);a.data.object={upStatement:[{sql:this.querySeparator()+n},...r.upStatement],downStatement:[...r.downStatement,{sql:this.querySeparator()+s}]}}catch(e){throw l.ppe(e,t),e}return a}async tableDelete(e){const t=this.tableDelete.name,a=new o.default;l.api(`${t}:args:`,e);try{e.sqlClient=this.sqlClient;const t=this.querySeparator()+this.sqlClient.schema.withSchema(this.schema).dropTable(e.tn).toString();let n=this.querySeparator()+this.createTable(e.tn,e);this.emit(`Success : ${t}`);let s=await this.relationList({tn:e.tn});s=s.data.list;for(const e of s)n+=this.querySeparator()+await this.sqlClient.withSchema(this.schema).schema.table(e.tn,(t=>{t=t.foreign(e.cn,null).references(e.rcn).on(this.getTnPath(e.rtn)),e.ur&&(t=t.onUpdate(e.ur)),e.dr&&t.onDelete(e.dr)})).toQuery();let i=await this.indexList(e);i=i.data.list.filter((({type:e,key_name:t})=>"Primary key"!==e&&-1===t.indexOf("fk_")));const r={};for(const{key_name:t,non_unique:a,cn:n}of i)t in r||(r[t]={tn:this.getTnPath(e.tn),indexName:t,non_unique:a,columns:[]}),r[t].columns.push(n);for(const{non_unique:e,tn:t,columns:a,key_name:s}of Object.values(r))n+=this.querySeparator()+this.sqlClient.schema.withSchema(this.schema).table(t,(function(t){e?t.index(a,s):t.unique(a,s)})).toQuery();await this.sqlClient.schema.withSchema(this.schema).dropTable(e.tn),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:n}]}}catch(e){throw l.ppe(e,t),e}return a}async relationCreate(e){const t=this.relationCreate.name,a=new o.default;l.api(`${t}:args:`,e);const n=e.foreignKeyName||null;try{const t=this;await this.sqlClient.schema.table(this.getTnPath(e.childTable),(function(a){a=a.foreign(e.childColumn,n).references(e.parentColumn).on(t.getTnPath(e.parentTable)),e.onUpdate&&(a=a.onUpdate(e.onUpdate)),e.onDelete&&a.onDelete(e.onDelete)}));const s=this.sqlClient.schema.table(this.getTnPath(e.childTable),(function(a){a=a.foreign(e.childColumn,n).references(e.parentColumn).on(t.getTnPath(e.parentTable)),e.onUpdate&&(a=a.onUpdate(e.onUpdate)),e.onDelete&&a.onDelete(e.onDelete)}));await s;const i=this.querySeparator()+s.toQuery();this.emit(`Success : ${i}`);const r=this.querySeparator()+this.sqlClient.schema.table(this.getTnPath(e.childTable),(function(t){t.dropForeign(e.childColumn,n)})).toQuery();a.data.object={upStatement:[{sql:i}],downStatement:[{sql:r}]}}catch(e){throw l.ppe(e,t),e}return a}async relationDelete(e){const t=this.relationDelete.name,a=new o.default;l.api(`${t}:args:`,e);const n=e.foreignKeyName||null;try{const t=this;await this.sqlClient.schema.table(this.getTnPath(e.childTable),(function(t){t.dropForeign(e.childColumn,n)}));const s=this.querySeparator()+this.sqlClient.schema.table(this.getTnPath(e.childTable),(function(t){t.dropForeign(e.childColumn,n)})).toQuery(),i=this.querySeparator()+await this.sqlClient.schema.table(this.getTnPath(e.childTable),(function(a){a.foreign(e.childColumn,n).references(e.parentColumn).on(t.getTnPath(e.parentTable))})).toQuery();a.data.object={upStatement:[{sql:s}],downStatement:[{sql:i}]}}catch(e){throw l.ppe(e,t),e}return a}async tableCreateStatement(e){const t=this.tableCreateStatement.name;let a=new o.default;l.api(`${t}:args:`,e);try{a=await this.columnList(e);const t=this.createTable(e.tn,{tn:e.tn,columns:a.data.list});a.data=t}catch(e){throw l.ppe(e,t),e}return a}async tableInsertStatement(e){const t=this.tableCreateStatement.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data=`INSERT INTO \`${this.getTnPath(e.tn)}\` (`;let t=" VALUES (";const n=await this.columnList(e);if(n.data&&n.data.list)for(let e=0;e<n.data.list.length;++e)e?(a.data+=`, \`${n.data.list[e].cn}\`\n\t`,t+=`, <${n.data.list[e].cn}>\n\t`):(a.data+=`\n${n.data.list[e].cn}\n\t`,t+=`\n<${n.data.list[e].cn}>\n\t`);a.data+=")",t+=");",a.data+=t}catch(e){throw l.ppe(e,t),e}return a}async tableUpdateStatement(e){const t=this.tableUpdateStatement.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data=`UPDATE ${this.getTnPath(e.tn)} \nSET\n`;const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`,${t.data.list[e].cn} = <\`${t.data.list[e].cn}\`>\n\t`:`${t.data.list[e].cn} = <\`${t.data.list[e].cn}\`>\n\t`;a.data+=";"}catch(e){throw l.ppe(e,t),e}return a}async tableDeleteStatement(e){const t=this.tableDeleteStatement.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data=`DELETE FROM ${this.getTnPath(e.tn)} WHERE ;`}catch(e){throw l.ppe(e,t),e}return a}async tableTruncateStatement(e){const t=this.tableTruncateStatement.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data=`TRUNCATE TABLE ${this.getTnPath(e.tn)};`}catch(e){throw l.ppe(e,t),e}return a}async tableSelectStatement(e){const t=this.tableSelectStatement.name,a=new o.default;l.api(`${t}:args:`,e);try{a.data="SELECT ";const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`, ${t.data.list[e].cn}\n\t`:`${t.data.list[e].cn}\n\t`;a.data+=` FROM ${e.tn};`}catch(e){throw l.ppe(e,t),e}return a}alterTablePK(e,t,a,n,s=!1){const i=[],r=[];let c=0;for(let e=0;e<t.length;++e)t[e].pk&&4!==t[e].altered&&r.push(t[e].cn);for(let e=0;e<a.length;++e)a[e].pk&&i.push(a[e].cn);if(r.length===i.length){for(let e=0;e<r.length;++e)if(i[e]!==r[e]){c=1;break}}else c=r.length-i.length;let o="";return(r.length||i.length)&&c&&(o+=i.length?",DROP PRIMARY KEY":"",r.length&&(o+=s?this.genQuery(", PRIMARY KEY(??)",[r],true):this.genQuery("ALTER TABLE ?? ADD PRIMARY KEY(??)",[this.getTnPath(e),r],true))),o}getTnPath(e){return this.schema?`${this.schema}.${e}`:e}alterTableRemoveColumn(e,t,a,n){let s=n?";":"";return t.cdf&&(s+=this.genQuery("\nALTER TABLE ?? DROP CONSTRAINT ??;",[this.getTnPath(e),t.default_constraint_name||`DF_${e}_${t.cn}`],true)),s+=this.genQuery("\nALTER TABLE ?? DROP COLUMN ??",[this.getTnPath(e),t.cn],true),s}createTableColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,0)}alterTableAddColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,1)}alterTableChangeColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,2)}createTable(e,t){let a="";for(let n=0;n<t.columns.length;++n)a+=this.createTableColumn(e,t.columns[n],null,a);return a+=this.alterTablePK(e,t.columns,[],a,!0),a=this.genQuery(`CREATE TABLE ?? (${a});`,[this.getTnPath(t.tn)],!0),a}alterTableColumn(e,t,a,n,s=2){let i="";const r=this.sanitiseDefaultValue(t.cdf),c=!0,o=!function(e){switch(e){case"datetimeoffset":case"geography":case"geometry":case"heirarchyid":case"image":case"money":case"real":case"json":case"smalldatetime":case"smallmoney":case"text":case"time":case"timestamp":case"int":case"tinyint":case"bigint":case"bit":case"smallint":case"float":case"uniqueidentifier":case"xml":return!0;default:return!1}}(t.dt)&&t.dtxp?`(${t.dtxp}${t.dtxs?`,${t.dtxs}`:""})`:"";return 0===s?(i=n?",":"",i+=this.genQuery(`?? ${this.sanitiseDataType(t.dt)}`,[t.cn],c),i+=o,i+=t.rqd?" NOT NULL":" NULL",i+=t.ai?" IDENTITY(1,1)":" ",i+=r?this.genQuery(` CONSTRAINT  ?? DEFAULT ${r}`,[`DF_${e}_${t.cn}`],c):"",r&&(t.default_constraint_name=`DF_${e}_${t.cn}`)):1===s?(i+=this.genQuery(` ADD ?? ${this.sanitiseDataType(t.dt)}`,[t.cn],c),i+=o,i+=t.rqd?" NOT NULL":" NULL",i+=t.ai?" IDENTITY(1,1)":" ",i+=r?this.genQuery(` CONSTRAINT ?? DEFAULT ${r}`,[`DF_${e}_${t.cn}`],c):" ",i=this.genQuery(`ALTER TABLE ?? ${i};`,[this.getTnPath(e)],c),r&&(t.default_constraint_name=`DF_${e}_${t.cn}`)):(t.cn!==a.cn&&(i+=this.genQuery("\nEXEC sp_rename ?, ?, 'COLUMN';\n",[`${this.getTnPath(e)}.${t.cno}`,`${t.cn}`],c)),t.dtxp===a.dtxp&&t.dtxs===a.dtxs&&t.dt===a.dt&&t.rqd===a.rqd||(i+=this.genQuery(`\nALTER TABLE ?? ALTER COLUMN ?? ${this.sanitiseDataType(t.dt)}${o}`,[this.getTnPath(e),t.cn],c),i+=t.rqd?" NOT NULL;\n":" NULL;\n"),t.cdf===a.cdf&&t.cn===a.cn||(a.default_constraint_name&&(i+=this.genQuery("\nALTER TABLE ?? DROP CONSTRAINT ??;",[this.getTnPath(e),a.default_constraint_name],c)),t.cdf&&(i+=this.genQuery(`\nALTER TABLE ??  ADD CONSTRAINT ?? DEFAULT ${this.sanitiseDefaultValue(t.cdf)} FOR ??;`,[this.getTnPath(e),`DF_${t.tn}_${t.cn}`,t.cn],c),t.default_constraint_name=`DF_${t.tn}_${t.cn}`))),i}get schema(){return this.connectionConfig&&this.connectionConfig.searchPath&&this.connectionConfig.searchPath[0]||"dbo"}async totalRecords(e={}){const t=this.totalRecords.name,a=new o.default;l.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SELECT SUM(RecordCount) AS TotalRecords FROM\n      (SELECT (SCHEMA_NAME(A.schema_id) + '.' + A.Name) AS TableName, AVG(B.rows) AS RecordCount\n        FROM sys.objects A\n        INNER JOIN sys.partitions B ON A.object_id = B.object_id\n        WHERE A.type = 'U'\n        GROUP BY A.schema_id,A.Name) src");a.data=e[0]}catch(e){a.code=-1,a.message=e.message,a.object=e}finally{l.api(`${t} :result: ${a}`)}return a}}t.default=u},8187:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var s=Object.getOwnPropertyDescriptor(t,a);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,s)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return s(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const c=r(a(6928)),o=a(9023),l=r(a(1832)),u=r(a(943)),d=r(a(9020)),m=r(a(133)),p=r(a(4688)),h=r(a(2745)),g=a(6331),f=r(a(8872)),b=r(a(5924)),E=r(a(2196)),y=r(a(5578)),_=r(a(4020)),T=r(a(9338)),C=r(a(7495)),O=i(a(5241)),N=new b.default("MysqlClient"),A=new E.default;class R extends _.default{constructor(e){super(e),this.queries=T.default,this._version={}}emit(e){N.api(e),A.evt.emit("UI",{status:0,data:`SQL : ${e}`})}emitW(e){N.warn(e),A.evt.emit("UI",{status:1,data:`SQL : ${e}`})}emitE(e){N.error(e),A.evt.emit("UI",{status:-1,data:`SQL : ${e}`})}async schemaCreateWithCredentials(e){const t=this.schemaCreateWithCredentials.name,a=new y.default;N.api(`${t}:args:`,e);try{e.schema||(e.schema=`nc${(0,g.nanoid)(8)}`),e.user||(e.user=`nc${(0,g.nanoid)(8)}`),e.password||(e.password=(0,g.nanoid)(16));const t=await this.sqlClient.raw("create database if not exists ??",[e.schema]);await this.sqlClient.raw("CREATE USER ?@'localhost' IDENTIFIED WITH mysql_native_password BY ?",[e.user,e.password]),await this.sqlClient.raw("GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, INDEX, DROP, ALTER, CREATE TEMPORARY TABLES, LOCK TABLES PRIVILEGES ON ??.* TO ?@'localhost'",[e.schema,e.user]),await this.sqlClient.raw("FLUSH PRIVILEGES"),N.debug("Create database if not exists",t),a.object=e}catch(e){a.code=-1,a.message=e.message,a.object=e}return a}async testConnection(e={}){const t=this.testConnection.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw("SELECT 1+1 as data")}catch(e){a.code=-1,a.message=e.message,a.object=e}finally{a.code?this.emitE(`TestConnection result: ${a.message}`):this.emit(`TestConnection result: ${a.code}`)}return a}getKnexDataTypes(){const e=new y.default;return e.data.list=["int","tinyint","smallint","mediumint","bigint","float","decimal","double","real","bit","boolean","serial","date","datetime","timestamp","time","year","char","varchar","nchar","text","tinytext","mediumtext","longtext","binary","varbinary","blob","tinyblob","mediumblob","longblob","enum","set","time","geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","json"],e}async version(e){const t=this.version.name,a=new y.default;N.api(`${t}:args:`,e);try{a.data.object={};const e=await this.sqlClient.raw("select version() as version");N.debug(e[0][0]),a.data.object.version=e[0][0].version;const t=e[0][0].version.split(".");t.length&&3===t.length?(a.data.object.primary=t[0],a.data.object.major=t[1],a.data.object.minor=t[2],a.data.object.key=t[0]+t[1]):(a.code=-1,a.message=`Invalid version : ${e[0][0].version}`)}catch(e){N.ppe(e),a.code=-1,a.message=e.message}finally{N.api(`${t} :result: %o`,a)}return a}async getDataTypes(e={}){const t=this.getDataTypes.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.version(),this._version.key in this.types?a.data.list=this.types[this._version.key]:a.data.list=this.types.default}catch(e){N.ppe(e),a.code=-1,a.message=e.message}finally{N.api(`${t} :result: ${a}`)}return a}async createDatabaseIfNotExists(e={}){const t=this.createDatabaseIfNotExists.name,a=new y.default;N.api(`${t}:args:`,e,this.connectionConfig);try{const a=JSON.parse(JSON.stringify(this.connectionConfig));delete a.connection.database;const n=(0,l.default)(a),s=await n.raw(this.queries[t].default.sql,[e.database]);N.debug("Create database if not exists",s),await n.destroy()}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async dropDatabase(e={}){const t=this.dropDatabase.name,a=new y.default;N.api(`${t}:args:`,e);try{N.api("dropping database:",e),await this.sqlClient.raw(this.queries[t].default.sql,[e.database])}catch(e){e&&N.ppe(e.message,t)}return N.api(`${t}: result`,a),a}async createTableIfNotExists(e={}){const t=this.createTableIfNotExists.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw(this.sqlClient.schema.hasTable(e.tn).toQuery())?N.debug(`${e.tn} tables exists`):(await this.sqlClient.raw(this.sqlClient.schema.createTable(e.tn,(function(e){e.increments(),e.string("title").notNullable(),e.string("titleDown").nullable(),e.string("description").nullable(),e.integer("batch").nullable(),e.string("checksum").nullable(),e.integer("status").nullable(),e.dateTime("created"),e.timestamps()})).toQuery()),N.debug("Table created:",`${e.tn}`))}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async hasTable(e){const t=this.hasTable.name,a=new y.default;N.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw(this.sqlClient.schema.hasTable(e.tn).toQuery());a.data.value=t}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async hasDatabase(e){const t=this.hasDatabase.name,a=new y.default;N.api(`${t}:args:`,e);try{const n=await this.sqlClient.raw(this.queries[t].default.sql,[`${e.databaseName}`]);a.data.value=n.length>0}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async databaseList(e={}){const t=this.databaseList.name,a=new y.default;N.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SHOW databases");if(N.debug(e.length),2===e.length){for(let t=0;t<e[0].length;++t)e[0][t].database_name=e[0][t].Database;a.data.list=e[0]}else N.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a.data.list.length),a}async tableList(e){const t=this.tableList.name,a=new y.default;N.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SHOW FULL TABLES WHERE TABLE_TYPE NOT LIKE 'VIEW'");let t;if(2===e.length){for(let a=0;a<e[0].length;++a)t||(t=Object.keys(e[0][a]).find((e=>/^Tables_in_/i.test(e)))),e[0][a].tn=e[0][a][t];a.data.list=e[0]}else N.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[];this.emitTele({mysql:1,table_count:a.data.list.length,api_count:10*a.data.list.length})}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a.data.list),a}async schemaList(e){const t=this.schemaList.name,a=new y.default;N.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("select schema_name \n                    from \n                        information_schema.schemata \n                            where \n                                schema_name not in ('information_schema','performance_schema','sys','mysql') \n                                order by schema_name;");2===e.length?a.data.list=e[0].map((e=>(0,d.default)(e,((e,t)=>t.toLowerCase())))):(N.debug("Unknown response for schemaList:",a.data.list.length),a.data.list=[])}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a.data.list),a}async columnList(e={}){var t;const a=this.columnList.name,n=new y.default;N.api(`${a}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const s=await this.sqlClient.raw(await this._getQuery({func:a}),[e.databaseName,e.tn,e.databaseName,e.tn]);if(2===s.length){const e=[];s[0].length||(n.code=-1,n.message="Table not found or Invalid table name");for(let a=0;a<s[0].length;++a){const n={};if(s[0][a]=(0,d.default)(s[0][a],((e,t)=>t.toLowerCase())),"57"!==this._version.key&&"80"!==this._version.key||(n.dp=s[0][a].dp,n.generated_expression=s[0][a].generated_expression),n.tn=s[0][a].tn,n.cn=s[0][a].cn,n.cno=s[0][a].cn,n.dt=s[0][a].dt,n.np=s[0][a].np,n.ns=s[0][a].ns,n.clen=s[0][a].clen,n.cop=s[0][a].cop,n.pk="PRI"===s[0][a].ck,n.nrqd="NO"!==s[0][a].nrqd,n.rqd=!n.nrqd,s[0][a].ct=s[0][a].ct||"",n.un=-1!==s[0][a].ct.indexOf("unsigned"),n.ct=s[0][a].ct||"",s[0][a].ext=s[0][a].ext||"",n.ai=-1!==s[0][a].ext.indexOf("auto_increment"),s[0][a].cst=s[0][a].cst||" ",n.unique=-1!==s[0][a].cst.indexOf("UNIQUE"),"timestamp"===n.dt||"datetime"===n.dt)if(s[0][a].cdf&&s[0][a].ext){const e=s[0][a].ext;e.includes("DEFAULT_GENERATED")?n.cdf=s[0][a].cdf+e.substring(e.lastIndexOf("DEFAULT_GENERATED")+17):n.cdf=`${s[0][a].cdf} ${e}`}else n.cdf=s[0][a].cdf;else n.cdf=s[0][a].cdf;(null===(t=this._version)||void 0===t?void 0:t.version)&&this._version.version.includes("Maria")&&"NULL"===n.cdf&&(n.cdf=null),n.cc=s[0][a].cc,n.csn=s[0][a].csn,n.dtx="specificType","int"===n.dt||"tinyint"===n.dt||"mediumint"===n.dt||"bigint"===n.dt||"enum"===n.dt||"set"===n.dt?(n.dtxp=n.ct.substring(n.ct.lastIndexOf("(")+1,n.ct.lastIndexOf(")")),n.dtxs=s[0][a].ns):(n.dtxp=s[0][a].clen||s[0][a].np||s[0][a].dp,n.dtxs=s[0][a].ns),n.au=!1,e.push(n)}n.data.list=e}else N.debug("Unknown response for databaseList:",s),n.data.list=[]}catch(e){throw N.ppe(e,a),e}return N.api(`${a}: result list length = `,n.data.list.length),n}async indexList(e={}){const t=this.indexList.name,a=new y.default;N.api(`${t}:args:`,e);try{const n=await this.sqlClient.raw(this.queries[t].default.sql,[e.tn]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),a.cn=a.column_name,delete a.column_name,a.tn=a.table,delete a.table,a.non_unique_original=a.non_unique,e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[];N.api(`${t}: result %O`,a.data.list)}catch(e){throw N.ppe(e,t),e}return a}async constraintList(e={}){const t=this.constraintList.name,a=new y.default;N.api(`${t}:args:`,e);try{const n=await this.sqlClient.raw(await this._getQuery({func:t}),[this.connectionConfig.connection.database,e.tn]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async relationList(e={}){const t=this.relationList.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[e.databaseName,e.tn]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async relationListAll(e={}){const t=this.relationListAll.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,{databaseName:e.databaseName});if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),e.push(a)}a.data.list=e,this.emitTele({mysql:1,relation_count:a.data.list.length,api_count:10*a.data.list.length})}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async triggerList(e={}){const t=this.triggerList.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[`%${e.tn}%`]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),a.trigger_name=a.trigger,e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async functionList(e={}){const t=this.functionList.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[e.databaseName]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),a.function_name=a.name,e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async procedureList(e={}){const t=this.procedureList.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[e.databaseName]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),a.procedure_name=a.name,e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async viewList(e={}){const t=this.viewList.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[]);let s;if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){s||(s=Object.keys(n[0][t]).find((e=>/^Tables_in_/i.test(e))));const a=n[0][t];a.view_name=a[s],e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a.data.list.length),a}async functionRead(e={}){const t=this.functionRead.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[e.function_name]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),a.create_function=a["create function"],e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async procedureRead(e={}){const t=this.procedureRead.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[e.procedure_name]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),a.create_procedure=a["create procedure"],e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async viewRead(e={}){const t=this.viewRead.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[e.databaseName,e.view_name]);if(2===n.length){const e=[];for(let t=0;t<n[0].length;++t){let a=n[0][t];a=(0,d.default)(a,(function(e,t){return t.toLowerCase()})),e.push(a)}a.data.list=e}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async triggerRead(e={}){const t=this.triggerRead.name,a=new y.default;N.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const n=await this.sqlClient.raw(this.queries[t].default.sql,[e.databaseName]);if(2===n.length){const t=[];for(let a=0;a<n[0].length;++a){const s=n[0][a];s.view_name=s[`Tables_in_${e.databaseName}`],t.push(s)}a.data.list=t}else N.debug("Unknown response for databaseList:",n),a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async schemaCreate(e={}){const t=this.triggerList.name;N.api(`${t}:args:`,e);return await this.sqlClient.raw(this.queries[t].default.sql,[e.database_name])}async schemaDelete(e={}){const t=this.schemaDelete.name;N.api(`${t}:args:`,e);return await this.sqlClient.raw(this.queries[t].default.sql,[e.database_name])}async triggerCreate(e={}){const t=this.triggerCreate.name,a=new y.default;N.api(`${t}:args:`,e);try{const t=this.querySeparator()+`CREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+`DROP TRIGGER ${e.trigger_name}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async triggerUpdate(e={}){const t=this.triggerUpdate.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw("DROP TRIGGER ??",[e.trigger_name]),await this.sqlClient.raw(`CREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`),a.data.object={upStatement:[{sql:`${this.querySeparator()}DROP TRIGGER ${e.trigger_name};\n${this.querySeparator()}CREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`}],downStatement:[{sql:`${this.querySeparator()}CREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.oldStatement}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async triggerDelete(e={}){const t=this.triggerDelete.name,a=new y.default;N.api(`${t}:args:`,e);try{const t=`${this.querySeparator()}DROP TRIGGER ${e.trigger_name}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:`${this.querySeparator()}CREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.oldStatement}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async viewCreate(e={}){const t=this.viewCreate.name,a=new y.default;N.api(`${t}:args:`,e);try{const t=this.querySeparator()+`CREATE VIEW ${e.view_name} AS \n${e.view_definition}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+`DROP VIEW ${e.view_name}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async viewUpdate(e={}){const t=this.viewUpdate.name,a=new y.default;N.api(`${t}:args:`,e);try{const t=this.querySeparator()+`CREATE OR REPLACE VIEW ${e.view_name} AS \n${e.view_definition}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+`CREATE VIEW ${e.view_name} AS \n${e.oldViewDefination}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async viewDelete(e={}){const t=this.viewDelete.name,a=new y.default;N.api(`${t}:args:`,e);try{const t=this.querySeparator()+`DROP VIEW ${e.view_name}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+`CREATE VIEW ${e.view_name} AS \n${e.oldViewDefination}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async functionCreate(e={}){const t=this.functionCreate.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw(`${e.create_function}`),a.data.object={upStatement:[{sql:this.querySeparator()+`${e.create_function}`}],downStatement:[{sql:this.querySeparator()+`DROP FUNCTION ${e.function_name}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async functionUpdate(e={}){const t=this.functionUpdate.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP FUNCTION IF EXISTS ${e.function_name}`),await this.sqlClient.raw(`${e.create_function}`),a.data.object={upStatement:[{sql:this.querySeparator()+`DROP FUNCTION IF EXISTS ${e.function_name};${this.querySeparator()}\n${e.create_function}`}],downStatement:[{sql:this.querySeparator()+`DROP FUNCTION IF EXISTS ${e.function_name};${this.querySeparator()}${e.oldCreateFunction}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async functionDelete(e={}){const t=this.functionDelete.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP FUNCTION IF EXISTS ${e.function_name}`),a.data.object={upStatement:[{sql:this.querySeparator()+`DROP FUNCTION IF EXISTS ${e.function_name}`}],downStatement:[{sql:this.querySeparator()+`${e.create_function}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async procedureCreate(e={}){const t=this.procedureCreate.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw(`${e.create_procedure}`),a.data.object={upStatement:[{sql:this.querySeparator()+`${e.create_procedure}`}],downStatement:[{sql:this.querySeparator()+`DROP PROCEDURE ${e.procedure_name}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async procedureUpdate(e={}){const t=this.procedureUpdate.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw("DROP PROCEDURE IF EXISTS ??",[e.procedure_name]),await this.sqlClient.raw(`${e.create_procedure}`),a.data.object={upStatement:[{sql:this.querySeparator()+`DROP PROCEDURE IF EXISTS ${e.procedure_name}; ${this.querySeparator()} \n${e.create_procedure}`}],downStatement:[{sql:this.querySeparator()+`DROP PROCEDURE IF EXISTS ${e.procedure_name}; ${this.querySeparator()} ${e.oldCreateProcedure}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async procedureDelete(e={}){const t=this.procedureDelete.name,a=new y.default;N.api(`${t}:args:`,e);try{await this.sqlClient.raw("DROP PROCEDURE IF EXISTS ??",[e.procedure_name]),a.data.object={upStatement:[{sql:this.querySeparator()+`DROP PROCEDURE IF EXISTS ${e.procedure_name}`}],downStatement:[{sql:this.querySeparator()+`${e.create_procedure}`}]}}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}async _getQuery(e){try{if((0,u.default)(this._version)){const t=await this.version();this._version=t.data.object,N.debug(`Version was empty for ${e.func}: population version for database as`,this._version)}return this._version.key in this.queries[e.func]?this.queries[e.func][this._version.key].sql:this.queries[e.func].default.sql}catch(e){throw N.ppe(e,this._getQuery.name),e}}mapFieldWithSuggestedFakerFn(e){return e.map((e=>{let t=null,a=1/0;const n=O.mapDataType(e.dt);return C.default.forEach(((s,i)=>{if("string"===n||n===s.type)if(i){const n=f.default.get(e.cn.toLowerCase(),s.name.toLowerCase());a>n&&(a=n,t=s)}else t=s,a=f.default.get(e.cn.toLowerCase(),s.name.toLowerCase())})),a<3?Object.assign(Object.assign({},e),{fakerFunction:t.value}):e}))}async seedInit(e){const t=this.seedInit.name,a=new y.default;N.api(`${t}:args:`,e),console.log("in mysql SeedInit");try{await(0,h.default)(e.seedsFolder);const t=c.default.join(e.seedsFolder,"__xseeds.json");await(0,o.promisify)(p.default.writeFile)(t,{rows:{value:8,description:"Maximum number of records"},foreign_key_rows:{value:2,description:"1:n - Total number foreign key per relation"}},{spaces:2});let n=await this.tableList();n=n.data.list;for(const t of n){let a=await this.columnList({tn:t.tn});a=a.data.list;for(let e=0;e<a.length;++e)a[e].fakerFunction=null;a=this.mapFieldWithSuggestedFakerFn(a);let n=await this.relationList({tn:t.tn});n=n.data.list;for(let e=0;e<n.length;e++){const t=n[e];for(let e=0;e<a.length;e++){const n=a[e];n.cn===t.cn&&(a[e]=Object.assign(Object.assign({},n),t))}}await this.fakerColumnsCreate({seedsFolder:e.seedsFolder,tn:t.tn,fakerColumns:a})}a.data=await(0,o.promisify)(p.default.readFile)(t)}catch(e){throw N.ppe(e,t),e}return a}async tableCreate(e){const t=this.tableCreate.name,a=new y.default;N.api(`${t}:args:`,e);try{e.table=e.tn,e.sqlClient=this.sqlClient;const t=this.querySeparator()+this.createTable(e);await this.sqlClient.raw(t);const n=this.querySeparator()+this.sqlClient.schema.dropTable(e.table).toString();this.emit(`Success : ${t}`),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:n}]}}catch(e){throw N.ppe(e,t),e}return a}async tableUpdate(e){const t=this.tableUpdate.name,a=new y.default;N.api(`${t}:args:`,e);try{e.table=e.tn;const t=e.originalColumns;e.connectionConfig=this._connectionConfig,e.sqlClient=this.sqlClient;let n="",s="";for(let a=0;a<e.columns.length;++a){const i=(0,m.default)(t,{cn:e.columns[a].cno});4&e.columns[a].altered?(n+=this.alterTableRemoveColumn(e.columns[a],i,n),s+=this.alterTableAddColumn(i,e.columns[a],s)):2&e.columns[a].altered||8&e.columns[a].altered?(n+=this.alterTableChangeColumn(e.columns[a],i,n),s+=this.alterTableChangeColumn(i,e.columns[a],s)):1&e.columns[a].altered&&(n+=this.alterTableAddColumn(e.columns[a],i,n),s+=this.alterTableRemoveColumn(e.columns[a],i,s))}n+=this.alterTablePK(e.columns,e.originalColumns,n),s+=this.alterTablePK(e.originalColumns,e.columns,s),n&&(n=this.genQuery(`ALTER TABLE ?? ${this.sanitize(n)};`,[e.tn]),s=this.genQuery(`ALTER TABLE ?? ${this.sanitize(s)};`,[e.tn])),await this.sqlClient.raw(n),console.log(n),a.data.object={upStatement:[{sql:this.querySeparator()+n}],downStatement:[{sql:this.querySeparator()+s}]}}catch(e){throw N.ppe(e,t),e}return a}async tableDelete(e){const t=this.tableDelete.name,a=new y.default;N.api(`${t}:args:`,e);try{e.sqlClient=this.sqlClient;const t=this.querySeparator()+this.sqlClient.schema.dropTable(e.table_name).toString();let n=await this.sqlClient.raw("show create table ??",[e.table_name]);n=Object.entries(n[0][0]).find((([e])=>"create table"===e.toLowerCase()))[1];const s=this.querySeparator()+n;this.emit(`Success : ${t}`),await this.sqlClient.raw(this.sqlClient.schema.dropTable(e.table_name).toQuery()),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:s}]}}catch(e){throw N.ppe(e,t),e}return a}async tableCreateStatement(e){const t=this.tableCreateStatement.name,a=new y.default;N.api(`${t}:args:`,e);try{a.data=";";const t=await this.sqlClient.raw("show create table ??;",[e.tn]);2===t.length&&(a.data=t[0][0]["Create Table"])}catch(e){throw N.ppe(e,t),e}return a}async tableInsertStatement(e){const t=this.tableCreateStatement.name,a=new y.default;N.api(`${t}:args:`,e);try{let t=" VALUES (";a.data=`INSERT INTO \`${e.tn}\` (`;const n=await this.columnList(e);if(n.data&&n.data.list)for(let e=0;e<n.data.list.length;++e)e?(a.data+=`, \`${n.data.list[e].cn}\`\n\t`,t+=`, <${n.data.list[e].cn}>\n\t`):(a.data+=`\n\`${n.data.list[e].cn}\`\n\t`,t+=`\n<${n.data.list[e].cn}>\n\t`);a.data+=")",t+=");",a.data+=t}catch(e){throw N.ppe(e,t),e}return a}async tableUpdateStatement(e){const t=this.tableUpdateStatement.name,a=new y.default;N.api(`${t}:args:`,e);try{a.data=`UPDATE \`${e.tn}\` \nSET\n`;const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`,\`${t.data.list[e].cn}\` = <\`${t.data.list[e].cn}\`>\n\t`:`\`${t.data.list[e].cn}\` = <\`${t.data.list[e].cn}\`>\n\t`;a.data+=";"}catch(e){throw N.ppe(e,t),e}return a}async tableDeleteStatement(e){const t=this.tableDeleteStatement.name,a=new y.default;N.api(`${t}:args:`,e);try{a.data=`DELETE FROM ${e.tn};`}catch(e){throw N.ppe(e,t),e}return a}async tableTruncateStatement(e){const t=this.tableTruncateStatement.name,a=new y.default;N.api(`${t}:args:`,e);try{a.data=`TRUNCATE TABLE ${e.tn};`}catch(e){throw N.ppe(e,t),e}return a}async tableSelectStatement(e){const t=this.tableSelectStatement.name,a=new y.default;N.api(`${t}:args:`,e);try{a.data="SELECT ";const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`, ${t.data.list[e].cn}\n\t`:`${t.data.list[e].cn}\n\t`;a.data+=` FROM ${e.tn};`}catch(e){throw N.ppe(e,t),e}return a}async sequenceList(e={}){const t=this.sequenceList.name,a=new y.default;N.api(`${t}:args:`,e);try{a.data.list=[]}catch(e){throw N.ppe(e,t),e}return N.api(`${t}: result`,a),a}alterTableRemoveColumn(e,t,a){let n=a?",":"";return n+=this.genQuery(" DROP COLUMN ??",[e.cn]),n}createTableColumn(e,t,a){return this.alterTableColumn(e,t,a,0)}alterTableAddColumn(e,t,a){return this.alterTableColumn(e,t,a,1)}alterTableChangeColumn(e,t,a){return this.alterTableColumn(e,t,a,2)}createTable(e){let t="";for(let a=0;a<e.columns.length;++a)t+=this.createTableColumn(e.columns[a],null,t);return t+=this.alterTablePK(e.columns,[],t,!0),t=this.genQuery(`CREATE TABLE ?? (${this.sanitize(t)});`,[e.tn]),t}alterTableColumn(e,t,a,n=2){let s=a?",":"";const i=parseInt(e.dtxs)?parseInt(e.dtxs):null;s+=2===n?this.genQuery(`\n    CHANGE\n    COLUMN ?? ?? ${this.sanitiseDataType(e.dt)}`,[t.cn,e.cn]):1===n?this.genQuery(`\n    ADD\n    COLUMN ?? ${this.sanitiseDataType(e.dt)}`,[e.cn]):this.genQuery(` ?? ${this.sanitiseDataType(e.dt)}`,[e.cn]),e.dt.endsWith("text")||(s+=e.dtxp&&" "!==e.dtxp?`(${e.dtxp}`:"",s+=i?`,${i}`:"",s+=e.dtxp&&" "!==e.dtxp?")":""),s+=e.un?" UNSIGNED":"",s+=e.rqd?" NOT NULL":" NULL",s+=e.ai?" auto_increment":"",s+=e.unique?" UNIQUE":"";const r=this.sanitiseDefaultValue(e.cdf);return s+=r?`\n    DEFAULT ${r}`:"",s}alterTablePK(e,t,a,n=!1){const s=[],i=[];let r=0;for(let t=0;t<e.length;++t)e[t].pk&&4!==e[t].altered&&i.push(e[t].cn);for(let e=0;e<t.length;++e)t[e].pk&&s.push(t[e].cn);if(i.length===s.length){for(let e=0;e<i.length;++e)if(s[e]!==i[e]){r=1;break}}else r=i.length-s.length;let c="";return(i.length||s.length)&&r&&(c+=s.length?",DROP PRIMARY KEY":"",i.length&&(c+=n?this.genQuery(", PRIMARY\n    KEY(??)",[i]):this.genQuery(", ADD\n    PRIMARY\n    KEY(??)",[i]))),c}async totalRecords(e={}){const t=this.totalRecords.name,a=new y.default;N.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SELECT SUM(table_rows) as TotalRecords FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = ?;",[this.connectionConfig.connection.database]);a.data=e[0][0]}catch(e){a.code=-1,a.message=e.message,a.object=e}finally{N.api(`${t} :result: ${a}`)}return a}}t.default=R},7262:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(9020)),i=n(a(5924)),r=n(a(5578)),c=n(a(8187)),o=new i.default("TidbClient");class l extends c.default{async constraintList(e={}){const t=this.constraintList.name,a=new r.default;o.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw("select *, TABLE_NAME as tn from INFORMATION_SCHEMA.KEY_COLUMN_USAGE where CONSTRAINT_SCHEMA=? and TABLE_NAME=?",[this.connectionConfig.connection.database,e.tn]);if(2===t.length){const e=[];for(let a=0;a<t[0].length;++a){let n=t[0][a];n=(0,s.default)(n,(function(e,t){return t.toLowerCase()})),e.push(n)}a.data.list=e}else o.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[]}catch(e){throw o.ppe(e,t),e}return o.api(`${t}: result`,a),a}}t.default=l},6975:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(9020)),i=n(a(5924)),r=n(a(5578)),c=n(a(8187)),o=new i.default("VitessClient");class l extends c.default{constructor(e){super(e)}async relationList(e={}){const t=new r.default;return t.data.list=[],t}async relationListAll(e={}){const t=new r.default;return t.data.list=[],t}async databaseList(e={}){const t=this.databaseList.name,a=new r.default;o.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SHOW databases");if(o.debug(e.length),2===e.length){for(let t=0;t<e[0].length;++t)e[0][t].database_name=e[0][t].Databases;a.data.list=e[0]}else o.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[]}catch(e){throw o.ppe(e,t),e}return o.api(`${t}: result`,a.data.list.length),a}async tableList(e={}){const t=this.tableList.name,a=new r.default;o.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SHOW TABLES"),t=`Tables_in_vt_${this.connectionConfig.connection.database}`;if(2===e.length){for(let a=0;a<e[0].length;++a)e[0][a].tn=e[0][a][t];a.data.list=e[0]}else o.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[]}catch(e){throw o.ppe(e,t),e}return o.api(`${t}: result`,a.data.list.length),a}async columnList(e={}){const t=this.columnList.name,a=new r.default;o.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("select *, table_name as tn from information_schema.columns where table_name = ? ORDER by ordinal_position",[e.tn]);if(2===t.length){const n=[];for(let a=0;a<t[0].length;++a){const i={};t[0][a]=(0,s.default)(t[0][a],((e,t)=>t.toLowerCase())),i.tn=e.tn,i.cn=t[0][a].cn,i.dt=t[0][a].dt,i.np=t[0][a].np,i.ns=t[0][a].ns,i.clen=t[0][a].clen,i.cop=t[0][a].op,i.dtx=this.getKnexDataType(i.dt),i.pk="PRI"===t[0][a].ck,i.nrqd="NO"!==t[0][a].nrqd,i.not_nullable=!i.nrqd,t[0][a].ct=t[0][a].ct||"",i.un=-1!==t[0][a].ct.indexOf("unsigned"),i.ct=t[0][a].ct||"",t[0][a].ext=t[0][a].ext||"",i.ai=-1!==t[0][a].ext.indexOf("auto_increment"),t[0][a].cst=t[0][a].cst||" ",i.unique=-1!==t[0][a].cst.indexOf("UNIQUE"),i.cdf=t[0][a].cdf,i.cc=t[0][a].cc,i.csn=t[0][a].csn,n.push(i)}a.data.list=n}else o.debug("Unknown response for databaseList:",t),a.data.list=[]}catch(e){throw o.ppe(e,t),e}return o.api(`${t}: result list length = `,a.data.list.length),a}async constraintList(e={}){const t=this.constraintList.name,a=new r.default;o.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw("select *, TABLE_NAME as tn from INFORMATION_SCHEMA.KEY_COLUMN_USAGE where TABLE_NAME = ? ORDER by ordinal_position;",[e.tn]);if(2===t.length){const e=[];for(let a=0;a<t[0].length;++a){let n=t[0][a];n=(0,s.default)(n,(function(e,t){return t.toLowerCase()})),e.push(n)}a.data.list=e}else o.debug("Unknown response for databaseList:",a.data.list.length),a.data.list=[]}catch(e){throw o.ppe(e,t),e}return o.api(`${t}: result`,a),a}}t.default=l},7495:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{name:"zipCode",group:"address",value:"address.zipCode",type:"string"},{name:"city",group:"address",value:"address.city",type:"string"},{name:"cityPrefix",group:"address",value:"address.cityPrefix",type:"string"},{name:"citySuffix",group:"address",value:"address.citySuffix",type:"string"},{name:"streetName",group:"address",value:"address.streetName",type:"string"},{name:"streetAddress",group:"address",value:"address.streetAddress",type:"string"},{name:"streetSuffix",group:"address",value:"address.streetSuffix",type:"string"},{name:"streetPrefix",group:"address",value:"address.streetPrefix",type:"string"},{name:"secondaryAddress",group:"address",value:"address.secondaryAddress",type:"string"},{name:"county",group:"address",value:"address.county",type:"string"},{name:"country",group:"address",value:"address.country",type:"string"},{name:"countryCode",group:"address",value:"address.countryCode",type:"string"},{name:"state",group:"address",value:"address.state",type:"string"},{name:"stateAbbr",group:"address",value:"address.stateAbbr",type:"string"},{name:"latitude",group:"address",value:"address.latitude",type:"number"},{name:"longitude",group:"address",value:"address.longitude",type:"number"},{name:"color",group:"commerce",value:"commerce.color",type:"string"},{name:"department",group:"commerce",value:"commerce.department",type:"string"},{name:"productName",group:"commerce",value:"commerce.productName",type:"string"},{name:"price",group:"commerce",value:"commerce.price",type:"number"},{name:"productAdjective",group:"commerce",value:"commerce.productAdjective",type:"string"},{name:"productMaterial",group:"commerce",value:"commerce.productMaterial",type:"string"},{name:"product",group:"commerce",value:"commerce.product",type:"string"},{name:"suffixes",group:"company",value:"company.suffixes",type:"string"},{name:"companyName",group:"company",value:"company.companyName",type:"string"},{name:"companySuffix",group:"company",value:"company.companySuffix",type:"string"},{name:"catchPhrase",group:"company",value:"company.catchPhrase",type:"string"},{name:"bs",group:"company",value:"company.bs",type:"string"},{name:"catchPhraseAdjective",group:"company",value:"company.catchPhraseAdjective",type:"string"},{name:"catchPhraseDescriptor",group:"company",value:"company.catchPhraseDescriptor",type:"string"},{name:"catchPhraseNoun",group:"company",value:"company.catchPhraseNoun",type:"string"},{name:"bsAdjective",group:"company",value:"company.bsAdjective",type:"string"},{name:"bsBuzz",group:"company",value:"company.bsBuzz",type:"string"},{name:"bsNoun",group:"company",value:"company.bsNoun",type:"string"},{name:"column",group:"database",value:"database.column",type:"string"},{name:"type",group:"database",value:"database.type",type:"string"},{name:"collation",group:"database",value:"database.collation",type:"string"},{name:"engine",group:"database",value:"database.engine",type:"string"},{name:"past",group:"date",value:"date.past",type:"date"},{name:"future",group:"date",value:"date.future",type:"date"},{name:"recent",group:"date",value:"date.recent",type:"date"},{name:"soon",group:"date",value:"date.soon",type:"date"},{name:"month",group:"date",value:"date.month",type:"string"},{name:"weekday",group:"date",value:"date.weekday",type:"string"},{name:"account",group:"finance",value:"finance.account",type:"string"},{name:"accountName",group:"finance",value:"finance.accountName",type:"string"},{name:"mask",group:"finance",value:"finance.mask",type:"string"},{name:"amount",group:"finance",value:"finance.amount",type:"number"},{name:"transactionType",group:"finance",value:"finance.transactionType",type:"string"},{name:"currencyCode",group:"finance",value:"finance.currencyCode",type:"string"},{name:"currencyName",group:"finance",value:"finance.currencyName",type:"string"},{name:"currencySymbol",group:"finance",value:"finance.currencySymbol",type:"string"},{name:"bitcoinAddress",group:"finance",value:"finance.bitcoinAddress",type:"string"},{name:"ethereumAddress",group:"finance",value:"finance.ethereumAddress",type:"string"},{name:"iban",group:"finance",value:"finance.iban",type:"string"},{name:"bic",group:"finance",value:"finance.bic",type:"string"},{name:"abbreviation",group:"hacker",value:"hacker.abbreviation",type:"string"},{name:"adjective",group:"hacker",value:"hacker.adjective",type:"string"},{name:"noun",group:"hacker",value:"hacker.noun",type:"string"},{name:"verb",group:"hacker",value:"hacker.verb",type:"string"},{name:"ingverb",group:"hacker",value:"hacker.ingverb",type:"string"},{name:"phrase",group:"hacker",value:"hacker.phrase",type:"string"},{name:"createCard",group:"helpers",value:"helpers.createCard",type:"string"},{name:"contextualCard",group:"helpers",value:"helpers.contextualCard",type:"string"},{name:"userCard",group:"helpers",value:"helpers.userCard",type:"string"},{name:"createTransaction",group:"helpers",value:"helpers.createTransaction",type:"string"},{name:"image",group:"image",value:"image.image",type:"string"},{name:"avatar",group:"image",value:"image.avatar",type:"string"},{name:"imageUrl",group:"image",value:"image.imageUrl",type:"string"},{name:"abstract",group:"image",value:"image.abstract",type:"string"},{name:"animals",group:"image",value:"image.animals",type:"string"},{name:"business",group:"image",value:"image.business",type:"string"},{name:"cats",group:"image",value:"image.cats",type:"string"},{name:"city",group:"image",value:"image.city",type:"string"},{name:"food",group:"image",value:"image.food",type:"string"},{name:"nightlife",group:"image",value:"image.nightlife",type:"string"},{name:"fashion",group:"image",value:"image.fashion",type:"string"},{name:"people",group:"image",value:"image.people",type:"string"},{name:"nature",group:"image",value:"image.nature",type:"string"},{name:"sports",group:"image",value:"image.sports",type:"string"},{name:"technics",group:"image",value:"image.technics",type:"string"},{name:"transport",group:"image",value:"image.transport",type:"string"},{name:"dataUri",group:"image",value:"image.dataUri",type:"string"},{name:"avatar",group:"internet",value:"internet.avatar",type:"string"},{name:"email",group:"internet",value:"internet.email",type:"string"},{name:"exampleEmail",group:"internet",value:"internet.exampleEmail",type:"string"},{name:"userName",group:"internet",value:"internet.userName",type:"string"},{name:"protocol",group:"internet",value:"internet.protocol",type:"string"},{name:"url",group:"internet",value:"internet.url",type:"string"},{name:"domainName",group:"internet",value:"internet.domainName",type:"string"},{name:"domainSuffix",group:"internet",value:"internet.domainSuffix",type:"string"},{name:"domainWord",group:"internet",value:"internet.domainWord",type:"string"},{name:"ip",group:"internet",value:"internet.ip",type:"string"},{name:"ipv6",group:"internet",value:"internet.ipv6",type:"string"},{name:"userAgent",group:"internet",value:"internet.userAgent",type:"string"},{name:"color",group:"internet",value:"internet.color",type:"string"},{name:"mac",group:"internet",value:"internet.mac",type:"string"},{name:"password",group:"internet",value:"internet.password",type:"string"},{name:"word",group:"lorem",value:"lorem.word",type:"string"},{name:"words",group:"lorem",value:"lorem.words",type:"string"},{name:"sentence",group:"lorem",value:"lorem.sentence",type:"string"},{name:"slug",group:"lorem",value:"lorem.slug",type:"string"},{name:"sentences",group:"lorem",value:"lorem.sentences",type:"string"},{name:"paragraph",group:"lorem",value:"lorem.paragraph",type:"string"},{name:"paragraphs",group:"lorem",value:"lorem.paragraphs",type:"string"},{name:"text",group:"lorem",value:"lorem.text",type:"string"},{name:"lines",group:"lorem",value:"lorem.lines",type:"string"},{name:"firstName",group:"name",value:"name.firstName",type:"string"},{name:"lastName",group:"name",value:"name.lastName",type:"string"},{name:"findName",group:"name",value:"name.findName",type:"string"},{name:"jobTitle",group:"name",value:"name.jobTitle",type:"string"},{name:"prefix",group:"name",value:"name.prefix",type:"string"},{name:"suffix",group:"name",value:"name.suffix",type:"string"},{name:"title",group:"name",value:"name.title",type:"string"},{name:"jobDescriptor",group:"name",value:"name.jobDescriptor",type:"string"},{name:"jobArea",group:"name",value:"name.jobArea",type:"string"},{name:"jobType",group:"name",value:"name.jobType",type:"string"},{name:"phoneNumber",group:"phone",value:"phone.phoneNumber",type:"string"},{name:"phoneNumberFormat",group:"phone",value:"phone.phoneNumberFormat",type:"string"},{name:"phoneFormats",group:"phone",value:"phone.phoneFormats",type:"string"},{name:"number",group:"random",value:"random.number",type:"number"},{name:"float",group:"random",value:"random.float",type:"number"},{name:"uuid",group:"random",value:"random.uuid",type:"string"},{name:"boolean",group:"random",value:"random.boolean",type:"boolean"},{name:"word",group:"random",value:"random.word",type:"string"},{name:"words",group:"random",value:"random.words",type:"string"},{name:"image",group:"random",value:"random.image",type:"string"},{name:"locale",group:"random",value:"random.locale",type:"string"},{name:"alphaNumeric",group:"random",value:"random.alphaNumeric",type:"string"},{name:"hexaDecimal",group:"random",value:"random.hexaDecimal",type:"string"},{name:"fileName",group:"system",value:"system.fileName",type:"string"},{name:"commonFileName",group:"system",value:"system.commonFileName",type:"string"},{name:"mimeType",group:"system",value:"system.mimeType",type:"string"},{name:"commonFileType",group:"system",value:"system.commonFileType",type:"string"},{name:"commonFileExt",group:"system",value:"system.commonFileExt",type:"string"},{name:"fileType",group:"system",value:"system.fileType",type:"string"},{name:"fileExt",group:"system",value:"system.fileExt",type:"string"},{name:"directoryPath",group:"system",value:"system.directoryPath",type:"string"},{name:"filePath",group:"system",value:"system.filePath",type:"string"},{name:"semver",group:"system",value:"system.semver",type:"string"}]},5241:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapDataType=void 0;t.mapDataType=function(e){switch(e){case"int":case"tinyint":case"smallint":case"mediumint":case"bigint":case"bit":case"boolean":case"float":case"decimal":case"double":case"serial":return"number";case"date":case"datetime":case"timestamp":case"time":case"year":return"date";case"char":case"varchar":case"nchar":case"text":case"tinytext":case"mediumtext":case"longtext":case"enum":case"set":case"json":return"string"}return"string"}},9338:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a="SELECT\nc.table_name as tn,\nc.column_name as cn,\nc.data_type as dt,\nc.column_type as ct,\nc.character_maximum_length as clen,\nc.numeric_precision as np,\nc.numeric_scale as ns,\n-- c.datetime_precision as dp,\nc.ordinal_position as cop,\nc.column_key as ck,\nc.extra as ext, -- gives ai\nc.column_default as cdf,\nc.is_nullable as nrqd,\nc.privileges as priv,\nc.column_comment as cc,\n-- c.generation_expression,\nc.character_set_name as csn,\nc.collation_name as clnn,\nct.CONSTRAINT_TYPE as cst\nFROM\ninformation_schema.COLUMNS as c\nLeft join(\n        select\n                tc.CONSTRAINT_NAME,\n                tc.TABLE_NAME,\n                tc.CONSTRAINT_SCHEMA,\n                tc.CONSTRAINT_TYPE,\n                s.COLUMN_NAME\n        from\n                information_schema.TABLE_CONSTRAINTS as tc\n        LEFT JOIN information_schema.STATISTICS as s ON\n                s.table_schema = tc.CONSTRAINT_SCHEMA\n                and s.TABLE_NAME = tc.TABLE_NAME\n                and s.INDEX_NAME = tc.CONSTRAINT_NAME\n        where\n                tc.CONSTRAINT_SCHEMA = ?\n                and s.TABLE_NAME = ?\n) ct on\nc.TABLE_SCHEMA = ct.CONSTRAINT_SCHEMA\nAND c.TABLE_NAME = ct.TABLE_NAME\nAND c.COLUMN_NAME = ct.COLUMN_NAME\nWHERE\nc.table_schema = ?\nand c.TABLE_NAME = ?\nORDER BY\nc.table_name,\nc.ordinal_position";t.default={columnList:{55:{sql:a,paramsHints:["databaseName","tn","databaseName","tn"]},56:{sql:a,paramsHints:["databaseName","tn","databaseName","tn"]},default:{sql:"SELECT\n      c.table_name as tn,\n      c.column_name as cn,\n      c.data_type as dt,\n      c.column_type as ct,\n      c.character_maximum_length as clen,\n      c.numeric_precision as np,\n      c.numeric_scale as ns,\n      c.datetime_precision as dp,\n      c.ordinal_position as cop,\n      c.column_key as ck,\n      c.extra as ext, -- gives ai\n      c.column_default as cdf,\n      c.is_nullable as nrqd,\n      c.privileges as priv,\n      c.column_comment as cc,\n--       c.generation_expression,\n      c.character_set_name as csn,\n      c.collation_name as clnn,\n      ct.CONSTRAINT_TYPE as cst\n     FROM\n      information_schema.COLUMNS as c\n    Left join(\n              select\n                      tc.CONSTRAINT_NAME,\n                      tc.TABLE_NAME,\n                      tc.CONSTRAINT_SCHEMA,\n                      tc.CONSTRAINT_TYPE,\n                      s.COLUMN_NAME\n              from\n                      information_schema.TABLE_CONSTRAINTS as tc\n              LEFT JOIN information_schema.STATISTICS as s ON\n                      s.table_schema = tc.CONSTRAINT_SCHEMA\n                      and s.TABLE_NAME = tc.TABLE_NAME\n                      and s.INDEX_NAME = tc.CONSTRAINT_NAME\n                      and tc.CONSTRAINT_TYPE != 'UNIQUE'\n                      and tc.CONSTRAINT_TYPE != 'FOREIGN KEY'\n              where\n                      tc.CONSTRAINT_SCHEMA = ?\n                      and s.TABLE_NAME = ?\n      ) ct on\n      c.TABLE_SCHEMA = ct.CONSTRAINT_SCHEMA\n      AND c.TABLE_NAME = ct.TABLE_NAME\n      AND c.COLUMN_NAME = ct.COLUMN_NAME\n    WHERE\n      c.table_schema = ?\n      and c.TABLE_NAME = ?\n    ORDER BY\n      c.table_name,\n      c.ordinal_position",paramsHints:["databaseName","tn","databaseName","tn"]}},constraintList:{default:{sql:"SELECT\n      k.constraint_name as cstn,\n      k.column_name as cn,\n      k.ordinal_position as op,\n      k.position_in_unique_constraint as puc,\n      t.constraint_type as cst\nFROM information_schema.table_constraints t\nLEFT JOIN information_schema.key_column_usage k\nUSING(constraint_name,table_schema,table_name)\nWHERE\nt.table_schema=?\nAND t.table_name=?;",paramsHints:["database","tn"]}},createDatabaseIfNotExists:{default:{sql:"create database if not exists ??  CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci",paramsHints:["database"]}},createTableIfNotExists:{default:{sql:"",paramsHints:[]}},dropDatabase:{default:{sql:"drop database ??",paramsHints:["database"]}},databaseList:{default:{sql:"SHOW databases",paramsHints:[]}},hasDatabase:{default:{sql:"SHOW DATABASES LIKE ?",paramsHints:["databaseName"]}},indexList:{default:{sql:"show index from ??",paramsHints:["tn"]}},functionList:{default:{sql:"show function status where db=?",paramsHints:["databaseName"]}},functionRead:{default:{sql:"SHOW CREATE FUNCTION ??",paramsHints:["function_name"]}},functionDelete:{default:{sql:"DROP FUNCTION IF EXISTS ??",paramsHints:["function_name"]}},procedureList:{default:{sql:"show procedure status where db=?",paramsHints:["databaseName"]}},procedureRead:{default:{sql:"show create procedure ??",paramsHints:["procedure_name"]}},procedureDelete:{default:{sql:"DROP PROCEDURE IF EXISTS ??",paramsHints:["procedure_name"]}},relationList:{default:{sql:"SELECT\n      kcu.CONSTRAINT_NAME as cstn,\n      kcu.TABLE_NAME as tn,\n      kcu.COLUMN_NAME as cn,\n      kcu.POSITION_IN_UNIQUE_CONSTRAINT as puc,\n      kcu.REFERENCED_TABLE_NAME as rtn,\n      kcu.REFERENCED_COLUMN_NAME as rcn,\n      rc.MATCH_OPTION as mo,\n      rc.UPDATE_RULE as ur,\n      rc.DELETE_RULE as dr,\n      kcu.table_schema as ts\n    FROM\n      information_schema.KEY_COLUMN_USAGE AS kcu\n    INNER JOIN information_schema.REFERENTIAL_CONSTRAINTS AS rc ON\n      kcu.CONSTRAINT_NAME = rc.CONSTRAINT_NAME\n    Group by\n      kcu.CONSTRAINT_NAME,\n      kcu.TABLE_NAME,\n      kcu.COLUMN_NAME,\n      kcu.POSITION_IN_UNIQUE_CONSTRAINT,\n      kcu.REFERENCED_TABLE_NAME,\n      kcu.REFERENCED_COLUMN_NAME,\n      rc.MATCH_OPTION,\n      rc.UPDATE_RULE,\n      rc.DELETE_RULE ,\n      kcu.table_schema\n    Having\n      kcu.table_schema = ?\n      AND kcu.referenced_column_name IS NOT NULL\n      AND kcu.table_name =?",paramsHints:["database","tn"]}},relationListAll:{default:{sql:"SELECT\n      kcu.constraint_name AS cstn,\n      kcu.table_name AS tn,\n      kcu.column_name AS cn,\n      kcu.position_in_unique_constraint AS puc,\n      kcu.referenced_table_name AS rtn,\n      kcu.referenced_column_name AS rcn,\n      rc.match_option AS mo,\n      rc.update_rule AS ur,\n      rc.delete_rule AS dr,\n      kcu.table_schema AS ts\n    FROM\n      (\n      SELECT\n        table_schema,\n        constraint_name,\n        table_name,\n        column_name,\n        position_in_unique_constraint,\n        referenced_table_name,\n        referenced_column_name\n      FROM\n        information_schema.KEY_COLUMN_USAGE\n      WHERE\n        table_schema = :databaseName) AS kcu\n    INNER JOIN\n              (\n      SELECT\n        constraint_schema,\n        match_option,\n        update_rule,\n        delete_rule,\n        constraint_name\n      FROM\n        information_schema.REFERENTIAL_CONSTRAINTS\n      WHERE\n        constraint_schema = :databaseName) AS rc ON\n      kcu.constraint_name = rc.constraint_name\n      AND kcu.table_schema = rc.constraint_schema\n    INNER JOIN\n              (\n      SELECT\n        table_schema,\n        table_name,\n        column_name\n      FROM\n        information_schema.COLUMNS\n      WHERE\n        table_schema = :databaseName\n        AND table_name IN (\n        SELECT\n          table_name\n        FROM\n          information_schema.TABLES\n        WHERE\n          table_schema = :databaseName\n          AND Lower(table_type) = 'base table')) AS col ON\n      col.table_schema = kcu.table_schema\n      AND col.table_name = kcu.table_name\n      AND kcu.referenced_column_name IS NOT NULL\n    GROUP BY\n      cstn ,\n      tn ,\n      rcn ,\n      cn ,\n      puc ,\n      rtn ,\n      cn,\n      mo ,\n      ur ,\n      dr ,\n      ts",paramsHints:["database"]}},schemaCreate:{default:{sql:"create database ??",paramsHints:["database_name"]}},schemaDelete:{default:{sql:"drop database ??",paramsHints:["database_name"]}},triggerList:{default:{sql:"SHOW TRIGGERS like ?",paramsHints:["tn"]}},tableList:{default:{sql:"",paramsHints:[]}},testConnection:{default:{sql:"",paramsHints:[]}},triggerRead:{default:{sql:"SHOW FULL TABLES IN ?? WHERE TABLE_TYPE LIKE 'VIEW';",paramsHints:["databaseName"]}},triggerDelete:{default:{sql:"DROP TRIGGER ??",paramsHints:["trigger_name"]}},version:{default:{sql:"",paramsHints:[]}},viewRead:{default:{sql:"select * FROM INFORMATION_SCHEMA.VIEWS WHERE\n       TABLE_SCHEMA = ? AND TABLE_NAME = ?",paramsHints:["databaseName","view_name"]}},viewList:{default:{sql:"SHOW FULL TABLES WHERE TABLE_TYPE LIKE 'VIEW'",paramsHints:[]}}}},5869:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(1832)),i=n(a(9020)),r=n(a(133)),c=n(a(4020)),o=n(a(5924)),l=n(a(5578)),u=new o.default("OracleClient");class d extends c.default{constructor(e){super(e)}getKnexDataTypes(){const e=new l.default;return e.data.list=["bfile","binary rowid","binary double","binary_float","blob","canoical","cfile","char","clob","content pointer","contigous array","date","decimal","double precision","float","integer","interval day to second","interval year to month","lob pointer","long","long raw","named collection","named object","nchar","nclob","number","nvarchar2","octet","oid","pointer","raw","real","ref","ref cursor","rowid","signed binary integer","smallint","table","time","time with tz","timestamp","timestamp with local time zone","timestamp with local tz","timestamp with timezone","timestamp with tz","unsigned binary integer","urowid","varchar","varchar2","varray","varying array"],e}async testConnection(e={}){const t=this.testConnection.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.raw('SELECT 1+1 AS "data" FROM DUAL')}catch(e){u.ppe(e),a.code=-1,a.message=e.message}finally{u.api(`${t}:result:`,a)}return a}async version(e={}){const t=this.version.name,a=new l.default;u.api(`${t}:args:`,e);try{const e=await this.raw("SELECT * FROM PRODUCT_COMPONENT_VERSION WHERE product LIKE 'Oracle%'");a.data.object={};let t=e[0];t=(0,i.default)(t,((e,t)=>t.toLowerCase()));const n=t.version.split(".");a.data.object.version=t.version,a.data.object.primary=n[0],a.data.object.major=n[1],a.data.object.minor=n[2]}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async createDatabaseIfNotExists(e={}){const t=this.createDatabaseIfNotExists.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=JSON.parse(JSON.stringify(this.connectionConfig));t.connection.database="xe",t.connection.user="system",t.connection.password="oracle";const a=(0,s.default)(t);u.debug("checking if db exists");0===(await a.raw(`select USERNAME from SYS.ALL_USERS WHERE USERNAME = '${this.connectionConfig.connection.user}'`)).length&&(u.debug("creating database:",e),await a.raw(`CREATE USER ${this.connectionConfig.connection.user} IDENTIFIED BY ${this.connectionConfig.connection.user}`),await a.raw(`GRANT ALL PRIVILEGES TO ${this.connectionConfig.connection.user}`),await a.raw(`GRANT EXECUTE ON DBMS_AQ TO ${this.connectionConfig.connection.user}`),await a.raw(`GRANT EXECUTE ON DBMS_AQADM TO ${this.connectionConfig.connection.user}`)),await a.destroy(),this.sqlClient=(0,s.default)(this.connectionConfig)}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async dropDatabase(e){const t=this.dropDatabase.name,a=new l.default;u.api(`${t}:args:`,e);try{const e=JSON.parse(JSON.stringify(this.connectionConfig));e.connection.database="xe",e.connection.user="system",e.connection.password="oracle";const t=(0,s.default)(e);await this.sqlClient.destroy(),u.debug("dropping database:",this.connectionConfig.connection.user);const a=await t.raw(`select SID,SERIAL# from v$session where username =  '${this.connectionConfig.connection.user}'\n      `);u.debug(`Active Sessions for ${this.connectionConfig.connection.user}: `,a);for(let e=0;e<a.length;e++){const n=a[e];await t.raw(`alter system kill session '${n.SID},${n["SERIAL#"]}' immediate`)}await t.raw(`drop user ${this.connectionConfig.connection.user} cascade`),u.debug("dropped database:",this.connectionConfig.connection.user)}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async createTableIfNotExists(e){const t=this.createTableIfNotExists.name,a=new l.default;u.api(`${t}:args:`,e);try{(await this.hasTable({tn:e.tn})).data.value?u.debug(`${e.tn} tables exists`):(await this.sqlClient.schema.createTable(e.tn,(function(e){e.string("title").notNullable(),e.string("titleDown").nullable(),e.string("description").nullable(),e.integer("batch").nullable(),e.string("checksum").nullable(),e.integer("status").nullable(),e.dateTime("created"),e.timestamps()})),u.debug("Table created:",`${e.tn}`))}catch(e){if(u.ppe(e,t),!(JSON.stringify(e.message).indexOf("exact fetch returns more than requested number of rows")>-1))throw e;u.warn("safely ignored Exception:exact fetch returns more than requested number of rows knex create table issue")}return u.api(`${t}: result`,a),a}async hasTable(e={}){const t=this.hasTable.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=await this.raw(`select TABLE_NAME as tn FROM all_tables WHERE OWNER = '${this.connectionConfig.connection.user}' AND tn = '${e.tn}'`);a.data.value=t.length>0}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async hasDatabase(e={}){const t=this.hasDatabase.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=await this.raw(`select USERNAME from SYS.ALL_USERS WHERE USERNAME = '${e.databaseName}'`);a.data.value=t.length>0}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async databaseList(e={}){const t=this.databaseList.name,a=new l.default;u.api(`${t}:args:`,e);try{const e=await this.raw('select USERNAME as "database_name" from SYS.ALL_USERS order by USERNAME');a.data.list=e}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async tableList(e={}){const t=this.tableList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`select table_name FROM all_tables WHERE owner='${e.databaseName}'`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async schemaList(e={}){const t=this.schemaList.name,a=new l.default;u.api(`${t}:args:`,e);try{const e=await this.raw("SELECT username AS schema_name\n                          FROM dba_users u\n                         WHERE ACCOUNT_STATUS = 'OPEN' AND EXISTS (\n                            SELECT 1\n                              FROM dba_objects o\n                             WHERE o.owner = u.username )\n                           AND default_tablespace not in ('SYSTEM','SYSAUX') ");for(let t=0;t<e.length;t++){let a=e[t];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),e[t]=a}a.data.list=e}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async columnList(e={}){const t=this.columnList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT\n      seq.sequence_name,\n      CASE\n        WHEN seq.sequence_name IS NOT NULL\n        AND p.constraint_type = 'P' THEN 1\n        ELSE 0\n      END as ai,\n      c.table_name as tn,\n      c.column_name AS cn,\n      c.column_id AS cop,\n      p.constraint_type AS ck,\n      c.NULLABLE AS nrqd,\n      c.DATA_TYPE AS dt,\n      c.DATA_LENGTH,\n      c.DATA_PRECISION,\n      c.DEFAULT_LENGTH,\n      c.DATA_DEFAULT AS cdf,\n      c.character_set_name as csn,\n      c.CHAR_LENGTH AS clen,\n      -- c.DEFAULT_ON_NULL,\n      c.LOW_VALUE,\n      c.HIGH_VALUE,\n      c.DATA_SCALE AS ns,\n      p.constraint_name AS pk_constraint_name,\n      p.POSITION AS p_con_ordinal_position\n    FROM\n      SYS.ALL_TAB_COLS c\n    LEFT JOIN(\n        SELECT\n          a.table_name,\n          a.column_name,\n          a.constraint_name,\n          c.constraint_type,\n          a.position,\n          c_pk.table_name r_table_name,\n          c_pk.constraint_name r_pk,\n          cc_pk.column_name r_column_name\n        FROM\n          all_cons_columns a\n        JOIN all_constraints c ON\n          (\n            a.owner = c.owner\n            AND a.constraint_name = c.constraint_name\n          )\n        LEFT JOIN all_constraints c_pk ON\n          (\n            c.r_owner = c_pk.owner\n            AND c.r_constraint_name = c_pk.constraint_name\n          )\n        LEFT JOIN all_cons_columns cc_pk ON\n          (\n            cc_pk.owner = c_pk.owner\n            AND cc_pk.constraint_name = c_pk.constraint_name\n          )\n        WHERE\n          a.owner = '${e.databaseName}'\n          AND c.constraint_type = 'P'\n      ) p ON\n      c.table_name = p.table_name\n      AND c.column_name = p.column_name\n    LEFT OUTER JOIN(\n        SELECT\n          t.table_name,\n          d.referenced_name AS sequence_name,\n          d.REFERENCED_OWNER AS OWNER,\n          c.COLUMN_NAME\n        FROM\n          user_trigger_cols t,\n          user_dependencies d,\n          user_tab_cols c\n        WHERE\n          d.name = t.trigger_name\n          AND t.TABLE_NAME = c.TABLE_NAME\n          AND t.COLUMN_NAME = c.COLUMN_NAME\n          AND d.referenced_type = 'SEQUENCE'\n          AND d.type = 'TRIGGER'\n      ) seq ON\n      c.table_name = seq.table_name\n      AND c.column_name = seq.column_name\n    WHERE\n      c.owner = '${e.databaseName}' AND  c.table_name = '${e.tn}'\n    ORDER BY\n      c.table_name,\n      c.column_id,\n      c.column_name`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.np=a.data_precision,a.pk="P"===a.ck,a.nrqd="Y"===a.nrqd,a.not_nullable="N"===a.nrqd,a.ai=1===a.ai,a.cno=a.cn,a.dtxp=a.clen||a.np,a.dtxs=a.ns,a.au=!1,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async indexList(e={}){const t=this.indexList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`select ind_col.COLUMN_POSITION AS postion, ind.index_name as key_name,\n        ind_col.column_name as cn,\n        ind.index_type,\n        ind.uniqueness,\n        ind.table_owner as schema_name,\n        ind.table_name as tn,\n        ind.table_type as table_type\n        from sys.all_indexes ind\n        inner join sys.all_ind_columns ind_col on ind.owner = ind_col.index_owner\n        and ind.index_name = ind_col.index_name\n        where ind.owner = '${e.databaseName}'  AND ind.table_name  = '${e.tn}'\n        order by ind.table_owner, ind.table_name, ind.index_name, ind_col.column_position`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.table=a.tn,a.non_unique="NONUNIQUE"===a.uniqueness?1:0,a.non_unique_original="NONUNIQUE"===a.uniqueness?1:0,a.seq_in_index=a.postion,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async constraintList(e={}){const t=this.constraintList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT cols.table_name as tn, cols.column_name as cn, cols.position, cons.*\n        FROM all_constraints cons, all_cons_columns cols\n        WHERE cols.table_name = '${e.tn}' AND cols.owner = '${e.databaseName}'\n        AND cons.constraint_type in ('P','R','U') AND cons.constraint_name = cols.constraint_name\n        AND cons.owner = cols.owner ORDER BY cons.constraint_name, cols.position`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.table=a.tn,"P"===a.cst&&(a.cst="Primary Key"),"U"===a.cst&&(a.cst="Unique"),"R"===a.cst&&(a.cst="Foreign Key"),a.op=a.position,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async relationList(e={}){const t=this.relationList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT\n        a.table_name as tn,\n        a.column_name as cn,\n        a.constraint_name cstn,\n        c.constraint_type cst,\n        a.position,\n        c_pk.table_name r_table_name,\n        c_pk.constraint_name r_pk,\n        cc_pk.column_name r_column_name,\n        c.delete_rule dr\n      FROM\n        all_cons_columns a\n      JOIN all_constraints c ON\n        (\ta.owner = c.owner\n          AND a.constraint_name = c.constraint_name )\n      LEFT JOIN all_constraints c_pk ON\n        (\tc.r_owner = c_pk.owner\n          AND c.r_constraint_name = c_pk.constraint_name )\n      LEFT JOIN all_cons_columns cc_pk ON\n        (\tcc_pk.owner = c_pk.owner\n          AND cc_pk.constraint_name = c_pk.constraint_name )\n      WHERE  a.owner = '${e.databaseName}'\n        AND c.constraint_type = 'R'\n\n      `);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.rtn=a.r_table_name,a.rcn=a.r_column_name,a.non_unique="NONUNIQUE"===a.uniqueness,a.puc=a.position,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async relationListAll(e={}){const t=this.relationList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT\n        a.table_name as tn,\n        a.column_name as cn,\n        a.constraint_name cstn,\n        c.constraint_type cst,\n        a.position puc,\n        c_pk.table_name r_table_name,\n        c_pk.constraint_name r_pk,\n        cc_pk.column_name r_column_name,\n        c.delete_rule dr\n      FROM\n        all_cons_columns a\n      JOIN all_constraints c ON\n        (\ta.owner = c.owner\n          AND a.constraint_name = c.constraint_name )\n      LEFT JOIN all_constraints c_pk ON\n        (\tc.r_owner = c_pk.owner\n          AND c.r_constraint_name = c_pk.constraint_name )\n      LEFT JOIN all_cons_columns cc_pk ON\n        (\tcc_pk.owner = c_pk.owner\n          AND cc_pk.constraint_name = c_pk.constraint_name )\n      WHERE  a.owner = '${e.databaseName}'\n        AND c.constraint_type = 'R'\n\n      `);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.rtn=a.r_table_name,a.rcn=a.r_column_name,a.non_unique="NONUNIQUE"===a.uniqueness,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async triggerList(e={}){const t=this.triggerList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.sqlClient.raw(`select owner as trigger_schema_name, trigger_name, trigger_type,\n      triggering_event, table_owner as schema_name, table_name as object_name, base_object_type as object_type,\n      status, trigger_body as script     from sys.all_triggers\n      -- excluding some Oracle maintained schemas\n      where owner = '${e.databaseName}' order by trigger_name, table_owner, table_name, base_object_type`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.trigger=a.trigger_name,a.table=a.object_name,a.event=a.triggering_event,a.timing=a.trigger_type,a.statement=a.script,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async functionList(e={}){const t=this.functionList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT *  FROM ALL_OBJECTS WHERE owner = '${e.databaseName}' and OBJECT_TYPE IN ('FUNCTION','PROCEDURE','PACKAGE')`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.function_name=a.object_name,a.type=a.object_type,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async procedureList(e={}){const t=this.procedureList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT *  FROM ALL_OBJECTS WHERE owner = '${e.databaseName}' and OBJECT_TYPE IN ('FUNCTION','PROCEDURE','PACKAGE')`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.procedure_name=a.object_name,a.type=a.object_type,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async viewList(e={}){const t=this.viewList.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT * FROM all_views WHERE owner='${e.databaseName}'`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.view_name=a.object_name,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async functionRead(e={}){const t=this.functionRead.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT * FROM all_source  WHERE TYPE = 'FUNCTION' AND OWNER = '${e.databaseName}' AND NAME = '${e.function_name}' ORDER BY line`),n=[];if(t.length>0){let e="";for(let a=0;a<t.length;a++){let n=t[a];n=(0,i.default)(n,((e,t)=>t.toLowerCase())),n.function_name=n.name,t[a]=n,e+=n.text}t[0].create_function=e,n.push(t[0])}a.data.list=n}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async procedureRead(e={}){const t=this.procedureRead.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT * FROM all_source  WHERE TYPE = 'PROCEDURE' AND OWNER = '${e.databaseName}' AND NAME = '${e.procedure_name}' ORDER BY line`),n=[];if(t.length>0){let e="";for(let a=0;a<t.length;a++){let n=t[a];n=(0,i.default)(n,((e,t)=>t.toLowerCase())),n.procedure_name=n.name,t[a]=n,e+=n.text}t[0].create_procedure=e,n.push(t[0])}a.data.list=n}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async viewRead(e={}){const t=this.viewRead.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.raw(`SELECT * FROM all_views WHERE owner='${e.databaseName}' and view_name='${e.view_name}'`);for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.view_name=a.object_name,a.view_definition=a.text,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async triggerRead(e={}){const t=this.triggerRead.name,a=new l.default;u.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.user;const t=await this.sqlClient.raw(`select owner as trigger_schema_name, trigger_name, trigger_type,\n      triggering_event, table_owner as schema_name, table_name as object_name,\n      base_object_type as object_type, status, trigger_body as script from sys.all_triggers\n      -- excluding some Oracle maintained schemas\n      where owner = '${e.databaseName}' and trigger_name = '${e.trigger_name}' order by trigger_name, table_owner, table_name, base_object_type`);if(!t[0])return[];for(let e=0;e<t.length;e++){let a=t[e];a=(0,i.default)(a,((e,t)=>t.toLowerCase())),a.trigger=a.trigger_name,a.table=a.object_name,a.event=a.triggering_event,a.timing=a.trigger_type,a.trigger_definition=a.script,t[e]=a}a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async schemaCreate(e={}){const t=this.schemaCreate.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.raw(`create database ${e.database_name}`)}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async schemaDelete(e={}){const t=this.schemaDelete.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.raw(`drop database ${e.database_name}`)}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async triggerDelete(e={}){const t=this.triggerDelete.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.raw(`DROP TRIGGER IF EXISTS ${e.trigger_name}`)}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async functionDelete(e={}){const t=this.functionDelete.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.raw(`DROP FUNCTION IF EXISTS ${e.function_name}`)}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async procedureDelete(e={}){const t=this.procedureDelete.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.raw(`DROP PROCEDURE IF EXISTS ${e.procedure_name}`)}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async functionCreate(e={}){const t=this.functionCreate.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw(`CREATE TRIGGER \`${e.function_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`);a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async functionUpdate(e={}){const t=this.functionUpdate.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP TRIGGER ${e.function_name}`);const t=await this.sqlClient.raw(`CREATE TRIGGER \`${e.function_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`);a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async procedureCreate(e={}){const t=this.procedureCreate.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw(`CREATE TRIGGER \`${e.procedure_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`);a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async procedureUpdate(e={}){const t=this.procedureUpdate.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP TRIGGER ${e.procedure_name}`);const t=await this.sqlClient.raw(`CREATE TRIGGER \`${e.procedure_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`);a.data.list=t}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async triggerCreate(e={}){const t=this.triggerCreate.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=`CREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`;await this.sqlClient.raw(t),a.data.object={upStatement:t,downStatement:`DROP TRIGGER ${e.trigger_name}`}}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async triggerUpdate(e={}){const t=this.triggerUpdate.name,a=new l.default;u.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP TRIGGER ${e.trigger_name}`),await this.sqlClient.raw(`CREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`),a.data.object={upStatement:`DROP TRIGGER ${e.trigger_name};\nCREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.statement}`,downStatement:`CREATE TRIGGER \`${e.trigger_name}\` \n${e.timing} ${e.event}\nON ${e.tn} FOR EACH ROW\n${e.oldStatement}`}}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async viewCreate(e={}){const t=this.viewCreate.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=`CREATE VIEW ${e.view_name} AS \n${e.view_definition}`;await this.sqlClient.raw(t),a.data.object={upStatement:t,downStatement:`DROP VIEW ${e.view_name}`}}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async viewUpdate(e={}){const t=this.viewUpdate.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=`CREATE OR REPLACE VIEW ${e.view_name} AS \n${e.view_definition}`;await this.sqlClient.raw(t),a.data.object={upStatement:t,downStatement:`CREATE VIEW ${e.view_name} AS \n${e.oldViewDefination}`}}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async viewDelete(e={}){const t=this.viewDelete.name,a=new l.default;u.api(`${t}:args:`,e);try{const t=`DROP VIEW ${e.view_name}`;await this.sqlClient.raw(t),a.data.object={upStatement:t,downStatement:`CREATE VIEW ${e.view_name} AS \n${e.oldViewDefination}`}}catch(e){throw u.ppe(e,t),e}return u.api(`${t}: result`,a),a}async tableCreate(e){const t=this.tableCreate.name,a=new l.default;u.api(`${t}:args:`,e);try{e.table=e.tn,e.sqlClient=this.sqlClient;const t=g(e.tn,e);await this.sqlClient.raw(t);const n=this.sqlClient.schema.dropTable(e.table).toSQL();this.emit(`Success : ${t}`),a.data.object={upStatement:[{sql:t}],downStatement:n}}catch(e){throw u.ppe(e,t),e}return a}async tableUpdate(e){const t=this.tableUpdate.name,a=new l.default;u.api(`${t}:args:`,e);try{e.table=e.tn;const t=e.originalColumns;e.connectionConfig=this._connectionConfig,e.sqlClient=this.sqlClient;let n="",s="";for(let a=0;a<e.columns.length;++a){const i=(0,r.default)(t,{cn:e.columns[a].cno});4&e.columns[a].altered?(n+=m(e.table,e.columns[a],i),s+=p(e.table,i,e.columns[a],s)):2&e.columns[a].altered||8&e.columns[a].altered?(n+=h(e.table,e.columns[a],i,n),s+=h(e.table,i,e.columns[a],s)):1&e.columns[a].altered&&(n+=p(e.table,e.columns[a],i,n),s+=m(e.table,e.columns[a],i))}await this.sqlClient.raw(n),console.log(n),a.data.object={upStatement:[{sql:n}],downStatement:[{sql:s}]}}catch(e){throw u.ppe(e,t),e}return a}async tableDelete(e){const t=this.tableDelete.name,a=new l.default;u.api(`${t}:args:`,e);try{e.sqlClient=this.sqlClient;const t=this.sqlClient.schema.dropTable(e.tn).toSQL(),n=g(e.tn,e);this.emit(`Success : ${t}`),await this.sqlClient.schema.dropTable(e.tn),a.data.object={upStatement:t,downStatement:[{sql:n}]}}catch(e){throw u.ppe(e,t),e}return a}async tableCreateStatement(e){const t=this.tableCreateStatement.name,a=new l.default;u.api(`${t}:args:`,e);try{a.data=";";const t=await this.sqlClient.raw(`show create table ${e.tn};`);2===t.length&&(a.data=t[0][0]["Create Table"])}catch(e){throw u.ppe(e,t),e}return a}async tableInsertStatement(e){const t=this.tableCreateStatement.name,a=new l.default;u.api(`${t}:args:`,e);try{let t=" VALUES (";a.data=`INSERT INTO \`${e.tn}\` (`;const n=await this.columnList(e);if(n.data&&n.data.list)for(let e=0;e<n.data.list.length;++e)e?(a.data+=`, \`${n.data.list[e].cn}\`\n\t`,t+=`, <${n.data.list[e].cn}>\n\t`):(a.data+=`\n\`${n.data.list[e].cn}\`\n\t`,t+=`\n<${n.data.list[e].cn}>\n\t`);a.data+=")",t+=");",a.data+=t}catch(e){throw u.ppe(e,t),e}return a}async tableUpdateStatement(e){const t=this.tableUpdateStatement.name,a=new l.default;u.api(`${t}:args:`,e);try{a.data=`UPDATE \`${e.tn}\` \nSET\n`;const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`,\`${t.data.list[e].cn}\` = <\`${t.data.list[e].cn}\`>\n\t`:`\`${t.data.list[e].cn}\` = <\`${t.data.list[e].cn}\`>\n\t`;a.data+=";"}catch(e){throw u.ppe(e,t),e}return a}async tableDeleteStatement(e){const t=this.tableDeleteStatement.name,a=new l.default;u.api(`${t}:args:`,e);try{a.data=`DELETE FROM ${e.tn};`}catch(e){throw u.ppe(e,t),e}return a}async tableTruncateStatement(e){const t=this.tableTruncateStatement.name,a=new l.default;u.api(`${t}:args:`,e);try{a.data=`TRUNCATE TABLE ${e.tn};`}catch(e){throw u.ppe(e,t),e}return a}async tableSelectStatement(e){const t=this.tableSelectStatement.name,a=new l.default;u.api(`${t}:args:`,e);try{a.data="SELECT ";const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`, ${t.data.list[e].cn}\n\t`:`${t.data.list[e].cn}\n\t`;a.data+=` FROM ${e.tn};`}catch(e){throw u.ppe(e,t),e}return a}async totalRecords(e={}){this.totalRecords.name;throw new Error("Function not supported for oracle yet")}}function m(e,t,a){let n=a?",":"";return n+=` DROP COLUMN \`${e.cn}\``,n}function p(e,t,a,n){return f(e,t,a,n,1)}function h(e,t,a,n){return f(e,t,a,n,2)}function g(e,t){let a="";for(let i=0;i<t.columns.length;++i)a+=(n=e,s=t.columns[i],f(n,s,null,a,0));var n,s;return a+=function(e,t,a,n=!1){const s=[],i=[];let r=0;for(let t=0;t<e.length;++t)e[t].pk&&4!==e[t].altered&&i.push(e[t].cn);for(let e=0;e<t.length;++e)t[e].pk&&s.push(t[e].cn);if(i.length===s.length){for(let e=0;e<i.length;++e)if(s[e]!==i[e]){r=1;break}}else r=i.length-s.length;let c="";return(i.length||s.length)&&r&&(c+=s.length?",DROP PRIMARY KEY":"",i.length&&(c+=n?`, PRIMARY KEY(${i.join(",")})`:`, ADD PRIMARY KEY(${i.join(",")})`)),c}(t.columns,[],0,!0),a=`CREATE TABLE ${t.tn} (`+a+")",a}function f(e,t,a,n,s=2){const i=parseInt(t.dtxs)?parseInt(t.dtxs):null;let r=n?",":"";const c=function(e){if(void 0===e.cdf||null===e.cdf)return e.cdf;switch(e.dt){case"bfile":case"binary rowid":case"binary double":case"binary_float":case"blob":case"canoical":case"cfile":case"char":case"clob":case"content pointer":case"contigous array":case"date":case"decimal":case"double precision":case"float":case"integer":case"interval day to second":case"interval year to month":case"lob pointer":case"long":case"long raw":case"named collection":case"named object":case"nchar":case"nclob":case"number":case"nvarchar2":case"octet":case"oid":case"pointer":case"raw":case"real":case"ref":case"ref cursor":case"rowid":case"signed binary integer":case"smallint":case"table":case"time":case"time with tz":case"timestamp":case"timestamp with local time zone":case"timestamp with local tz":case"timestamp with timezone":case"timestamp with tz":case"unsigned binary integer":case"urowid":case"varchar":case"varchar2":case"varray":case"varying array":return e.cdf}}(t);return 0===s?(t.ai?(t.dt,r+=` ${t.cn} serial`):r+=` ${t.cn} ${t.dt}`,r+=t.dtxp&&" "!==t.dtxp?`(${t.dtxp}`:"",r+=i?`,${i}`:"",r+=t.dtxp&&" "!==t.dtxp?")":"",r+=t.rqd?" NOT NULL":" NULL",r+=c?` DEFAULT ${c}`:""):1===s?(r+=` ADD  ${t.cn} ${t.dt}`,r+=t.rqd?" NOT NULL":" NULL",r+=c?` DEFAULT ${c}`:" ",r=`ALTER TABLE ${e} ${r};`):(t.cn!==a.cno&&(r+=`\nALTER TABLE ${e} RENAME COLUMN ${t.cno} TO ${t.cn};\n`),t.dt!==a.dt&&(r+=`\nALTER TABLE ${e} ALTER COLUMN ${t.cn} TYPE ${t.dt};\n`),t.rqd!==a.rqd&&(r+=`\nALTER TABLE ${e} ALTER COLUMN ${t.cn} `,r+=t.rqd?" SET NOT NULL;\n":" DROP NOT NULL;\n"),t.cdf!==a.cdf&&(r+=`\nALTER TABLE ${e} ALTER COLUMN ${t.cn} `,r+=t.cdf?` SET DEFAULT ${t.cdf};\n`:" DROP DEFAULT;\n")),r}t.default=d},8831:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(6331),i=n(a(1832)),r=n(a(943)),c=n(a(9020)),o=n(a(133)),l=a(2678),u=n(a(4020)),d=n(a(5924)),m=n(a(5578)),p=n(a(5838)),h=a(7990),g=n(a(5838)),f=new d.default("PGClient");class b extends u.default{constructor(e){super(e),this.queries=p.default,this._version={}}async schemaCreateWithCredentials(e){const t=this.schemaCreateWithCredentials.name,a=new m.default;f.api(`${t}:args:`,e);try{e.schema||(e.schema=`nc${(0,s.nanoid)(8)}`),e.user||(e.user=`nc${(0,s.nanoid)(8)}`),e.password||(e.password=(0,s.nanoid)(16));const t=await this.sqlClient.raw("create database ?",[e.schema]);await this.sqlClient.raw("create user ? with encrypted password ?",[e.user,e.password]),await this.sqlClient.raw("grant all privileges on database ?? to ?",[e.schema,e.user]),f.debug("Create database if not exists",t),a.object=e}catch(e){a.code=-1,a.message=e.message,a.object=e}return a}async sequenceDelete(e={}){const t=this.sequenceDelete.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=`${this.querySeparator()}DROP SEQUENCE ${this.genIdentifier(e.sequence_name)}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:`${this.querySeparator()}CREATE SEQUENCE ${this.genIdentifier(e.sequence_name)}`}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async sequenceList(e={}){const t=this.sequenceList.name,a=new m.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const{rows:t}=await this.raw("select *\n              from INFORMATION_SCHEMA.sequences;");a.data.list=t.map((e=>Object.assign(Object.assign({},e),{original_sequence_name:e.sequence_name})))}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async sequenceCreate(e={}){const t=this.sequenceCreate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+`CREATE SEQUENCE ${this.genIdentifier(e.sequence_name)}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+`DROP SEQUENCE ${this.genIdentifier(e.sequence_name)}`}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async sequenceUpdate(e={}){const t=this.sequenceUpdate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+`ALTER SEQUENCE ${this.genIdentifier(e.original_sequence_name)} RENAME TO ${this.genIdentifier(e.sequence_name)};`,n=this.querySeparator()+`ALTER SEQUENCE ${this.genIdentifier(e.sequence_name)} RENAME TO ${this.genIdentifier(e.original_sequence_name)};`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:n}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async testConnection(e={}){const t=this.testConnection.name,a=new m.default;f.api(`${t}:args:`,e);try{await this.raw("SELECT 1+1 as data")}catch(e){const t=JSON.parse(JSON.stringify(this.connectionConfig));t.connection.database="postgres";const n=(0,i.default)(Object.assign(Object.assign({},t),{pool:{min:0,max:1}}));try{await n.raw("SELECT 1+1 as data"),await n.destroy()}catch(t){/^database "[\w\d_]+" does not exist$/.test(t.message)||(f.ppe(t),a.code=-1,a.message=e.message)}}finally{f.api(`${t}:result:`,a)}return a}getKnexDataTypes(){const e=new m.default;return e.data.list=["int","integer","bigint","bigserial","char","int2","int4","int8","int4range","int8range","serial","serial2","serial8","character","bit","bool","boolean","date","double precision","event_trigger","fdw_handler","float4","float8","uuid","smallint","smallserial","character varying","text","real","time","time without time zone","timestamp","timestamp without time zone","timestamptz","timestamp with time zone","timetz","time with time zone","daterange","json","jsonb","gtsvector","index_am_handler","anyenum","anynonarray","anyrange","box","bpchar","bytea","cid","cidr","circle","cstring","inet","internal","interval","language_handler","line","lsec","macaddr","money","name","numeric","numrange","oid","opaque","path","pg_ddl_command","pg_lsn","pg_node_tree","point","polygon","record","refcursor","regclass","regconfig","regdictionary","regnamespace","regoper","regoperator","regproc","regpreocedure","regrole","regtype","reltime","smgr","tid","tinterval","trigger","tsm_handler","tsquery","tsrange","tstzrange","tsvector","txid_snapshot","unknown","void","xid","xml"],e}async version(e={}){const t=this.version.name,a=new m.default;f.api(`${t}:args:`,e);try{a.data.object={};const e=await this.sqlClient.raw("SHOW server_version");f.debug(e.rows[0]),a.data.object.version=e.rows[0].server_version;const t=e.rows[0].server_version.split(".");!t.length||3!==t.length&&2!==t.length?(a.code=-1,a.message=`Invalid version : ${e.rows[0].server_version}`):(a.data.object.primary=t[0],a.data.object.major=t[1],a.data.object.minor=t.length>2?t[2]:t[1],a.data.object.key=t[0]+t[1])}catch(e){f.ppe(e),a.code=-1,a.message=e.message}finally{f.api(`${t} :result: %o`,a)}return a}async createDatabaseIfNotExists(e={}){var t;const a=this.createDatabaseIfNotExists.name,n=new m.default;let s;f.api(`${a}:args:`,e);try{const a=JSON.parse(JSON.stringify(this.connectionConfig));let n=[];try{a.connection.database="postgres",s=(0,i.default)(Object.assign(Object.assign({},a),{pool:{min:0,max:1}})),f.debug("checking if db exists"),n=(await s.raw("SELECT datname as database FROM pg_database WHERE datistemplate = false and datname = ?",[e.database])).rows}catch(t){f.debug("checking if db exists"),n=(await this.sqlClient.raw("SELECT datname as database FROM pg_database WHERE datistemplate = false and datname = ?",[e.database])).rows}0===n.length&&(f.debug("creating database:",e),await s.raw("CREATE DATABASE ?? ENCODING 'UTF8'",[e.database]));const r=this.getEffectiveSchema(e);!!(null===(t=(await this.sqlClient.raw("SELECT schema_name FROM information_schema.schemata WHERE schema_name = ?",[r])).rows)||void 0===t?void 0:t[0])||await this.sqlClient.raw("CREATE SCHEMA IF NOT EXISTS ??  AUTHORIZATION ?? ",[r,this.connectionConfig.connection.user])}catch(e){throw f.ppe(e,a),e}finally{s&&await s.destroy()}return f.api(`${a}: result`,n),n}getEffectiveSchema(e={}){return(null==e?void 0:e.schema)||this.schema}async dropDatabase(e){const t=this.dropDatabase.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=JSON.parse(JSON.stringify(this.connectionConfig));t.connection.database="postgres";const a=(0,i.default)(Object.assign(Object.assign({},t),{pool:{min:0,max:1}}));await this.sqlClient.destroy(),this.sqlClient=a,await a.raw("ALTER DATABASE ?? WITH CONNECTION LIMIT 0;\n      SELECT pg_terminate_backend(sa.pid) FROM pg_stat_activity sa WHERE\n      sa.pid <> pg_backend_pid() AND sa.datname = ?;",[e.database,e.database]),f.debug("dropping database:",e),await a.raw("DROP DATABASE ??;",[e.database]),await a.destroy()}catch(e){f.ppe(e,t)}return f.api(`${t}: result`,a),a}async createTableIfNotExists(e){const t=this.createTableIfNotExists.name,a=new m.default;f.api(`${t}:args:`,e);try{if(0===(await this.sqlClient.raw("SELECT table_schema,table_name as tn, table_catalog FROM information_schema.tables where table_schema=? and\n         table_name = ? and table_catalog = ?",[this.getEffectiveSchema(e),e.tn,this.connectionConfig.connection.database])).rows.length){const t=await this.sqlClient.raw(this.sqlClient.schema.createTable(e.tn,(function(e){e.increments(),e.string("title").notNullable(),e.string("titleDown").nullable(),e.string("description").nullable(),e.integer("batch").nullable(),e.string("checksum").nullable(),e.integer("status").nullable(),e.dateTime("created"),e.timestamps()})).toQuery());f.debug("Table created:",`${e.tn}`,t)}else f.debug(`${e.tn} tables exists`)}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async hasTable(e={}){const t=this.hasTable.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:t}=await this.sqlClient.raw("SELECT table_schema,table_name as tn, table_catalog FROM information_schema.tables where table_schema=? and table_name = ? and table_catalog = ?'",[this.getEffectiveSchema(e),e.tn,this.connectionConfig.connection.database]);a.data.value=t.length>0}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async hasDatabase(e={}){const t=this.hasDatabase.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:t}=await this.sqlClient.raw("SELECT datname as database FROM pg_database WHERE datistemplate = false and datname = ?",[e.database]);a.data.value=t.length>0}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async databaseList(e={}){const t=this.databaseList.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:e}=await this.sqlClient.raw("SELECT datname as database_name\n           FROM pg_database\n           WHERE datistemplate = false;");a.data.list=e}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async tableList(e={}){const t=this.tableList.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:t}=await this.raw("SELECT table_schema as ts, table_name as tn,table_type\n              FROM information_schema.tables\n              where table_schema = ?\n              ORDER BY table_schema, table_name",[this.getEffectiveSchema(e)]);a.data.list=t.filter((({table_type:e})=>"base table"===e.toLowerCase()))}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async schemaList(e={}){const t=this.schemaList.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:e}=await this.raw("SELECT datname as schema_name FROM pg_database\n                              WHERE \n                                  datistemplate = false \n                                      order by schema_name;");a.data.list=e}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async columnList(e={}){var t,a,n,s,i;const r=this.columnList.name,c=new m.default;f.api(`${r}:args:`,e);try{const r=null===(i=null===(s=null===(n=null===(a=null===(t=(await this.sqlClient.raw("SELECT version()")).rows[0])||void 0===t?void 0:t.version)||void 0===a?void 0:a.split(" "))||void 0===n?void 0:n[1])||void 0===s?void 0:s.split("."))||void 0===i?void 0:i[0],o=+r>=10?"c.is_identity as ii,":"";e.databaseName=this.connectionConfig.connection.database;const l=await this.sqlClient.raw(`select\n                    c.table_name as tn, c.column_name as cn, c.data_type as dt,\n                    (CASE WHEN  trg.trigger_name is NULL THEN false  else  true end) as au,\n                    pk.constraint_type as ck,\n                    c.character_maximum_length as clen,\n                    c.numeric_precision as np,\n                    c.numeric_scale as ns,\n                    c.datetime_precision as dp,\n                    c.ordinal_position as cop,\n                    c.is_nullable as nrqd,\n                    c.column_default as cdf,\n                    c.generation_expression,\n                    c.character_octet_length,\n                    c.character_set_name as csn,\n                    -- c.collation_name as clnn,\n                    pk.ordinal_position as pk_ordinal_position, pk.constraint_name as pk_constraint_name,\n                    c.udt_name,\n                    ${o}\n\n       (SELECT count(*)\n            FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc1\n                inner join INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE cu\n                    on cu.CONSTRAINT_NAME = tc1.CONSTRAINT_NAME\n            where\n                tc1.CONSTRAINT_TYPE = 'UNIQUE'\n                and tc1.TABLE_NAME = c.TABLE_NAME\n                and cu.COLUMN_NAME = c.COLUMN_NAME\n                and tc1.TABLE_SCHEMA=c.TABLE_SCHEMA) IsUnique,\n                (SELECT\n        string_agg(enumlabel, ',')\n        FROM "pg_enum" "e"\n        INNER JOIN "pg_type" "t" ON "t"."oid" = "e"."enumtypid"\n        INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace"\n        WHERE "n"."nspname" = table_schema AND "t"."typname"=udt_name\n                ) enum_values\n\n\n            from information_schema.columns c\n              left join\n                ( select kc.constraint_name, kc.table_name,kc.column_name, kc.ordinal_position,tc.constraint_type\n                  from information_schema.key_column_usage kc\n                    inner join information_schema.table_constraints as tc\n                      on kc.constraint_name = tc.constraint_name \n                      and kc.constraint_schema = tc.constraint_schema and tc.constraint_type in ('PRIMARY KEY')\n                  where kc.table_catalog = :database and kc.table_schema= :schema\n                  order by table_name,ordinal_position ) pk\n                on\n                pk.table_name = c.table_name and pk.column_name=c.column_name\n                left join information_schema.triggers trg on trg.event_object_table = c.table_name and trg.trigger_name = CONCAT('xc_trigger_' , :table::text , '_' , c.column_name)\n              where c.table_catalog=:database and c.table_schema=:schema and c.table_name=:table\n              order by c.table_name, c.ordinal_position`,{schema:this.getEffectiveSchema(e),database:e.databaseName,table:e.tn}),u=[];for(let e=0;e<l.rows.length;++e){const t={};t.tn=l.rows[e].tn,t.cn=l.rows[e].cn,t.cno=l.rows[e].cn,t.dt=l.rows[e].dt,t.np=l.rows[e].np,t.ns=l.rows[e].ns,t.clen=l.rows[e].clen,t.dp=l.rows[e].dp,t.cop=l.rows[e].cop,t.dtx=l.rows[e].dt,t.pk=null!==l.rows[e].pk_constraint_name,t.nrqd="NO"!==l.rows[e].nrqd,t.not_nullable=!t.nrqd,t.rqd=!t.nrqd,l.rows[e].ct=l.rows[e].dt||"",t.un=-1!==l.rows[e].ct.indexOf("unsigned"),t.ai=!1,l.rows[e].cdf&&(t.ai=-1!==l.rows[e].cdf.indexOf("nextval")),t.cdf=l.rows[e].cdf?l.rows[e].cdf.replace(/::[\w (),]+$/,"").replace(/^'|'$/g,""):l.rows[e].cdf,t.cc=l.rows[e].cc,t.csn=l.rows[e].csn,t.dtxp=l.rows[e].clen||l.rows[e].np||l.rows[e].dp,t.dtxs=l.rows[e].ns,t.au=l.rows[e].au,t.data_type_custom=l.rows[e].udt_name,"USER-DEFINED"===t.dt&&(t.dtxp=l.rows[e].enum_values),+r>=10&&"YES"===l.rows[e].ii&&(t.ai=!0),u.push(t)}c.data.list=u}catch(e){throw f.ppe(e,r),e}return f.api(`${r}: result`,c),c}async indexList(e={}){const t=this.indexList.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:t}=await this.sqlClient.raw("SELECT\n      f.attname AS cn,\n      i.relname as key_name,\n      ix.indnatts, ix.indkey, f.attnum as seq_in_index,\n      pg_catalog.format_type(f.atttypid,f.atttypmod) AS type,\n      f.attnotnull as rqd,\n      p.contype as cst,\n      p.conname as cstn,\n      ix.indisprimary as primarykey,\n      not ix.indisunique as non_unique_original,\n      not ix.indisunique as non_unique,\n      CASE\n          WHEN i.oid<>0 THEN true\n          ELSE false\n      END AS is_index,\n      CASE\n          WHEN f.atthasdef = 't' THEN pg_get_expr(d.adbin, d.adrelid)\n      END AS default  FROM pg_attribute f\n      JOIN pg_class c ON c.oid = f.attrelid\n      JOIN pg_type t ON t.oid = f.atttypid\n      LEFT JOIN pg_attrdef d ON d.adrelid = c.oid AND d.adnum = f.attnum\n      LEFT JOIN pg_namespace n ON n.oid = c.relnamespace\n      LEFT JOIN pg_constraint p ON p.conrelid = c.oid AND f.attnum = ANY (p.conkey)\n      LEFT JOIN pg_class AS g ON p.confrelid = g.oid\n      LEFT JOIN pg_index AS ix ON f.attnum = ANY(ix.indkey) and c.oid = f.attrelid and c.oid = ix.indrelid\n      LEFT JOIN pg_class AS i ON ix.indexrelid = i.oid\n      WHERE\n        c.relkind = 'r'::char\n      AND n.nspname = ?\n      AND c.relname = ?\n      and i.oid<>0\n      AND f.attnum > 0\n      ORDER BY i.relname, f.attnum;",[this.getEffectiveSchema(e),e.tn]);a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async relationDelete(e){const t=this.relationDelete.name,a=new m.default;f.api(`${t}:args:`,e);const n=e.foreignKeyName||null;e.childTableWithSchema=e.schema?`${e.schema}.${e.childTable}`:e.childTable,e.parentTableWithSchema=e.schema?`${e.schema}.${e.parentTable}`:e.parentTable;try{await this.sqlClient.raw(this.sqlClient.schema.table(e.childTableWithSchema,(function(t){t.dropForeign(e.childColumn,n)})).toQuery());const t=this.querySeparator()+this.sqlClient.schema.table(e.childTableWithSchema,(function(t){t.dropForeign(e.childColumn,n)})).toQuery(),s=this.querySeparator()+this.sqlClient.schema.table(e.childTableWithSchema,(function(t){t.foreign(e.childColumn,n).references(e.parentColumn).on(e.parentTableWithSchema)})).toQuery();a.data.object={upStatement:[{sql:t}],downStatement:[{sql:s}]}}catch(e){throw f.ppe(e,t),e}return a}async constraintList(e={}){const t=this.constraintList.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw('\n      SELECT c.conname AS cstn,\n          CASE\n              WHEN c.contype = \'u\' THEN \'UNIQUE\'\n          WHEN c.contype = \'p\' THEN \'PRIMARY KEY\'\n              ELSE \'FOREIGN KEY\'\n          END AS cst,\n           col.attnum,\n           sch.nspname                                   AS "schema",\n           tbl.relname                                   AS "table",\n           ARRAY_AGG(col.attname ORDER BY u.attposition) AS columns,\n           pg_get_constraintdef(c.oid)                   AS definition\n        FROM pg_constraint c\n           JOIN LATERAL UNNEST(c.conkey) WITH ORDINALITY AS u(attnum, attposition) ON TRUE\n           JOIN pg_class tbl ON tbl.oid = c.conrelid\n           JOIN pg_namespace sch ON sch.oid = tbl.relnamespace\n           JOIN pg_attribute col ON (col.attrelid = tbl.oid AND col.attnum = u.attnum)\n        where tbl.relname=?\n        GROUP BY constraint_name, col.attnum, constraint_type, "schema", "table", definition\n        ORDER BY "schema", "table"; ',[e.tn]),n=[];for(let e=0,a=0;e<t.rows.length;++e,++a)if(t.rows[e].columns=t.rows[e].columns.replace("{",""),t.rows[e].columns=t.rows[e].columns.replace("}",""),t.rows[e].columns=t.rows[e].columns.split(","),1===t.rows[e].columns.length)n[a]=t.rows[e],n[a].columns=t.rows[e].columns[0],n[a].seq_in_index=1;else{const s=t.rows[e].columns.slice();for(let i=0;i<s.length;++i,++a)n[a]=JSON.parse(JSON.stringify(t.rows[e])),n[a].columns=s[i],n[a].seq_in_index=i;a--}a.data.list=n}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async relationList(e={}){const t=this.relationList.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:t}=await this.sqlClient.raw("SELECT distinct\n                tc.table_schema as ts,\n                tc.constraint_name as cstn,\n                tc.table_name as tn,\n                kcu.column_name as cn,\n                ccu.table_schema AS foreign_table_schema,\n                ccu.table_name AS rtn,\n                ccu.column_name AS rcn,\n                pc.confupdtype as ur, pc.confdeltype as dr\n        FROM\n            information_schema.table_constraints AS tc\n            JOIN information_schema.key_column_usage AS kcu\n              ON tc.constraint_name = kcu.constraint_name\n              AND tc.table_schema = kcu.table_schema\n            JOIN information_schema.constraint_column_usage AS ccu\n              ON ccu.constraint_name = tc.constraint_name\n              AND ccu.table_schema = tc.table_schema\n            join (select conname,confupdtype,confdeltype from pg_catalog.pg_constraint) pc\n            on pc.conname = tc.constraint_name\n        WHERE tc.constraint_type = 'FOREIGN KEY' AND tc.table_schema=:schema and tc.table_name=:table\n        order by tc.table_name;",{schema:this.getEffectiveSchema(e),table:e.tn}),n={a:"NO ACTION",c:"CASCADE",r:"RESTRICT",n:"SET NULL",d:"SET DEFAULT"};for(const e of t)e.ur=n[e.ur],e.dr=n[e.dr];a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async relationCreate(e){const t=this.relationCreate.name,a=new m.default;f.api(`${t}:args:`,e);const n=e.foreignKeyName||null;e.childTableWithSchema=e.schema?`${e.schema}.${e.childTable}`:e.childTable,e.parentTableWithSchema=e.schema?`${e.schema}.${e.parentTable}`:e.parentTable;try{const t=this.sqlClient.schema.table(e.childTableWithSchema,(function(t){t=t.foreign(e.childColumn,n).references(e.parentColumn).on(e.parentTableWithSchema),e.onUpdate&&(t=t.onUpdate(e.onUpdate)),e.onDelete&&t.onDelete(e.onDelete)}));await this.sqlClient.raw(t.toQuery());const s=this.querySeparator()+t.toQuery();this.emit(`Success : ${s}`);const i=this.querySeparator()+this.sqlClient.schema.table(e.childTableWithSchema,(function(t){t.dropForeign(e.childColumn,n)})).toQuery();a.data.object={upStatement:[{sql:s}],downStatement:[{sql:i}]}}catch(e){throw f.ppe(e,t),e}return a}async relationListAll(e={}){const t=this.relationList.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:t}=await this.sqlClient.raw("SELECT DISTINCT tc.table_schema as ts,\n                tc.constraint_name as cstn,\n                tc.table_name as tn,\n                kcu.column_name as cn,\n                ccu.table_schema AS foreign_table_schema,\n                ccu.table_name   AS rtn,\n                ccu.column_name  AS rcn,\n                pc.confupdtype   as ur,\n                pc.confdeltype   as dr\n         FROM information_schema.table_constraints AS tc\n                JOIN information_schema.key_column_usage AS kcu\n                     ON tc.constraint_name = kcu.constraint_name\n                       AND tc.table_schema = kcu.table_schema\n                JOIN information_schema.constraint_column_usage AS ccu\n                     ON ccu.constraint_name = tc.constraint_name\n                       AND ccu.table_schema = tc.table_schema\n                join (select conname, confupdtype, confdeltype\n                      from pg_catalog.pg_constraint) pc\n                     on pc.conname = tc.constraint_name\n         WHERE tc.constraint_type = 'FOREIGN KEY'\n           AND tc.table_schema = ?\n         order by tc.table_name;",[this.getEffectiveSchema(e)]),n={a:"NO ACTION",c:"CASCADE",r:"RESTRICT",n:"SET NULL",d:"SET DEFAULT"};for(const e of t)e.ur=n[e.ur],e.dr=n[e.dr];a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerList(e={}){const t=this.triggerList.name,a=new m.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const{rows:t}=await this.sqlClient.raw("select * from information_schema.triggers where trigger_schema=? and event_object_table=?",[this.getEffectiveSchema(e),e.tn]);for(let e=0;e<t.length;++e)t[e].statement=t[e].action_statement,t[e].table=t[e].event_object_table,t[e].trigger=t[e].trigger_name,t[e].event=t[e].event_manipulation,t[e].timing=t[e].action_timing;a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async functionList(e={}){const t=this.functionList.name,a=new m.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const{rows:t}=await this.sqlClient.raw("SELECT *\n              FROM pg_catalog.pg_namespace n\n                     JOIN pg_catalog.pg_proc p\n                          ON pronamespace = n.oid\n              WHERE nspname = ?;",[this.getEffectiveSchema(e)]),n=[];for(let e=0;e<t.length;++e)"prokind"in t[e]&&"p"===t[e].prokind||n.push({create_function:t[e].prosrc,function_name:t[e].proname});a.data.list=n}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureList(e={}){const t=this.procedureList.name,a=new m.default;a.data.list=[],f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const{rows:t}=await this.sqlClient.raw("SELECT *\n              FROM pg_catalog.pg_namespace n\n                     JOIN pg_catalog.pg_proc p\n                          ON pronamespace = n.oid\n              WHERE nspname = ?;",[this.getEffectiveSchema(e)]),n=[];for(let e=0;e<t.length;++e)"prokind"in t[e]&&"p"===t[e].prokind&&n.push({create_procedure:t[e].prosrc,procedure_name:t[e].proname});a.data.list=n}catch(e){}return f.api(`${t}: result`,a),a}async viewList(e={}){const t=this.viewList.name,a=new m.default;f.api(`${t}:args:`,e);try{const{rows:t}=await this.sqlClient.raw("select *\n           from INFORMATION_SCHEMA.views\n           WHERE table_schema = ?;",[this.getEffectiveSchema(e)]);for(let e=0;e<t.length;++e)t[e].view_name=t[e].tn||t[e].table_name;a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async functionRead(e={}){const t=this.functionRead.name,a=new m.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const{rows:t}=await this.sqlClient.raw("SELECT format('%I.%I(%s)', ns.nspname, p.proname, oidvectortypes(p.proargtypes)) as function_declaration, pg_get_functiondef(p.oid) as create_function\n                FROM pg_proc p INNER JOIN pg_namespace ns ON (p.pronamespace = ns.oid)\n            WHERE ns.nspname = ? and p.proname = ?;",[this.getEffectiveSchema(e),e.function_name]);for(let a=0;a<t.length;++a)t[a].function_name=e.function_name;a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureRead(e={}){const t=this.procedureRead.name,a=new m.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("show create procedure ?;",[e.procedure_name]),n=[];if(2===t.length)for(let e=0;e<t[0].length;++e){let a=t[0][e];a=(0,c.default)(a,((e,t)=>t.toLowerCase())),a.create_procedure=a["create procedure"],n.push(a)}else f.debug("Unknown response for tableList:",t);a.data.list=n}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewRead(e={}){const t=this.viewRead.name,a=new m.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const{rows:t}=await this.sqlClient.raw("select * from INFORMATION_SCHEMA.views WHERE table_name=? and table_schema = ANY (current_schemas(false));",[e.view_name]);for(let e=0;e<t.length;++e)t[e].view_name=t[e].tn;a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerRead(e={}){const t=this.triggerRead.name,a=new m.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("SHOW FULL TABLES IN ?? WHERE TABLE_TYPE LIKE 'VIEW';",[e.databaseName]);let n=[];if(2===t.length){const a=[];for(let n=0;n<t[0].length;++n){const s=t[0][n];s.view_name=s[`Tables_in_${e.databaseName}`],a.push(s)}n=a}else f.debug("Unknown response for tableList:",t);a.data.list=n}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async schemaCreate(e={}){const t=this.schemaCreate.name,a=new m.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw("create database ??",[e.database_name])}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async schemaDelete(e={}){const t=this.schemaDelete.name,a=new m.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw("drop database ??",[e.database_name])}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerDelete(e={}){const t=this.triggerDelete.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=this.genQuery("DROP TRIGGER IF EXISTS ?? ON ??",[e.trigger_name,e.tn]);await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:this.querySeparator()+this.genQuery(`CREATE TRIGGER ?? \n${e.timing} ${e.event}\nON ?? FOR EACH ROW\n${e.statement}`,[e.trigger_name,e.tn])}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async functionDelete(e={}){const t=this.functionDelete.name,a=new m.default;f.api(`${t}:args:`,e);const n=this.querySeparator()+`DROP FUNCTION IF EXISTS ${this.genIdentifier(e.function_declaration)}`,s=this.querySeparator()+e.create_function;try{await this.sqlClient.raw(n),a.data.object={upStatement:[{sql:n}],downStatement:[{sql:s}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureDelete(e={}){const t=this.procedureDelete.name,a=new m.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP PROCEDURE IF EXISTS ${this.genIdentifier(e.procedure_name)}`)}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async _getQuery(e){try{if((0,r.default)(this._version)){const t=await this.version();this._version=t.data.object,f.debug(`Version was empty for ${e.func}: population version for database as`,this._version)}return this._version.key in this.queries[e.func]?this.queries[e.func][this._version.key].sql:this.queries[e.func].default.sql}catch(e){throw f.ppe(e,this._getQuery.name),e}}async functionCreate(e={}){const t=this.functionCreate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+e.create_function;await this.sqlClient.raw(t);const n=await this.functionRead({function_name:e.function_name}),s=this.querySeparator()+`DROP FUNCTION IF EXISTS ${this.genIdentifier(n.data.list[0].function_declaration)}`;a.data.object={upStatement:[{sql:t}],downStatement:[{sql:s}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async functionUpdate(e={}){const t=this.functionUpdate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+e.create_function;let n=this.querySeparator()+e.oldCreateFunction;await this.sqlClient.raw(`DROP FUNCTION IF EXISTS ${this.genIdentifier(e.function_declaration)};`),await this.sqlClient.raw(t);const s=await this.functionRead({function_name:e.function_name});n=`DROP FUNCTION IF EXISTS ${this.genIdentifier(s.data.list[0].function_declaration)};`+n,a.data.object={upStatement:[{sql:t}],downStatement:[{sql:n}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureCreate(e={}){const t=this.procedureCreate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+`CREATE TRIGGER ${this.genIdentifier(e.procedure_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`;await this.sqlClient.raw(t);const n=this.querySeparator()+`DROP PROCEDURE IF EXISTS ${this.genIdentifier(e.procedure_name)}`;a.data.object={upStatement:[{sql:t}],downStatement:[{sql:n}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureUpdate(e={}){const t=this.procedureUpdate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+`DROP TRIGGER ${e.procedure_name}`,n=this.querySeparator()+`CREATE TRIGGER ${this.genIdentifier(e.procedure_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`;await this.sqlClient.raw(t),await this.sqlClient.raw(n),a.data.object={upStatement:[{sql:n}],downStatement:[{sql:";"}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerCreate(e={}){const t=this.triggerCreate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+`CREATE TRIGGER ${this.genIdentifier(e.trigger_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+`DROP TRIGGER ${this.genIdentifier(e.trigger_name)}`}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerUpdate(e={}){const t=this.triggerUpdate.name,a=new m.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP TRIGGER ${this.genIdentifier(e.trigger_name)} ON ${this.genIdentifier(e.tn)}`),await this.sqlClient.raw(`CREATE TRIGGER ${this.genIdentifier(e.trigger_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`),a.data.object={upStatement:this.querySeparator()+`DROP TRIGGER ${this.genIdentifier(e.trigger_name)} ON ${this.genIdentifier(e.tn)};${this.querySeparator()}CREATE TRIGGER ${this.genIdentifier(e.trigger_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`,downStatement:this.querySeparator()+`CREATE TRIGGER ${this.genIdentifier(e.trigger_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.oldStatement}`}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewCreate(e={}){const t=this.viewCreate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=e.view_definition;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:this.querySeparator()+`DROP VIEW ${this.genIdentifier(e.view_name)}`}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewUpdate(e={}){const t=this.viewUpdate.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=`CREATE OR REPLACE VIEW ${this.genIdentifier(e.view_name)} AS \n${e.view_definition}`;await this.sqlClient.raw(t),a.data.object={upStatement:this.querySeparator()+t,downStatement:this.querySeparator()+`CREATE VIEW ${this.genIdentifier(e.view_name)} AS \n${e.oldViewDefination}`}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewDelete(e={}){const t=this.viewDelete.name,a=new m.default;f.api(`${t}:args:`,e);try{const t=`DROP VIEW ${this.genIdentifier(e.view_name)}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:this.querySeparator()+`CREATE VIEW ${this.genIdentifier(e.view_name)} AS \n${e.oldViewDefination}`}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async tableCreate(e){const t=this.tableCreate.name,a=new m.default;f.api(`${t}:args:`,e);try{e.table=e.tn,e.sqlClient=this.sqlClient;const t=this.querySeparator()+this.createTable(e.tn,e);await this.sqlClient.raw(t);const n=this.querySeparator()+this.sqlClient.schema.dropTable(e.table).toString();this.emit(`Success : ${t}`);const s=await this.afterTableCreate(e);a.data.object={upStatement:[{sql:t},...s.upStatement],downStatement:[...s.downStatement,{sql:n}]}}catch(e){throw f.ppe(e,t),e}return a}async afterTableCreate(e){const t={upStatement:[],downStatement:[]};let a="",n="";for(let t=0;t<e.columns.length;t++){const s=e.columns[t];if(s.au){const t=e.schema?`xc_au_${e.schema}_${e.tn}_${s.cn}`:`xc_au_${e.tn}_${s.cn}`,i=e.schema?`xc_trigger_${e.schema}_${e.tn}_${s.cn}`:`xc_trigger_${e.tn}_${s.cn}`,r=this.genQuery("CREATE OR REPLACE FUNCTION ??()\n                          RETURNS TRIGGER AS $$\n                          BEGIN\n                            NEW.?? = NOW();\n                            RETURN NEW;\n                          END;\n                          $$ LANGUAGE plpgsql;",[t,s.cn]);a+=this.querySeparator()+r+this.querySeparator()+this.genQuery("CREATE TRIGGER ??\n            BEFORE UPDATE ON ??\n            FOR EACH ROW\n            EXECUTE PROCEDURE ??();",[i,e.schema?`${e.schema}.${e.tn}`:e.tn,t]),n+=this.querySeparator()+this.genQuery("DROP TRIGGER IF EXISTS ?? ON ??;",[i,e.schema?`${e.schema}.${e.tn}`:e.tn])+this.querySeparator()+this.genQuery("DROP FUNCTION IF EXISTS ??()",[t])}}return""!==a&&await this.sqlClient.raw(a),t.upStatement[0]={sql:a},t.downStatement[0]={sql:n},t}async afterTableUpdate(e){const t={upStatement:[],downStatement:[]};let a="",n="";for(let t=0;t<e.columns.length;t++){const s=e.columns[t];if(s.au&&1===s.altered){const t=e.schema?`xc_au_${e.schema}_${e.tn}_${s.cn}`:`xc_au_${e.tn}_${s.cn}`,i=e.schema?`xc_trigger_${e.schema}_${e.tn}_${s.cn}`:`xc_trigger_${e.tn}_${s.cn}`,r=this.genQuery("CREATE OR REPLACE FUNCTION ??()\n                          RETURNS TRIGGER AS $$\n                          BEGIN\n                            NEW.?? = NOW();\n                            RETURN NEW;\n                          END;\n                          $$ LANGUAGE plpgsql;",[t,s.cn]);a+=this.querySeparator()+r+this.querySeparator()+this.genQuery("CREATE TRIGGER ??\n            BEFORE UPDATE ON ??\n            FOR EACH ROW\n            EXECUTE PROCEDURE ??();",[i,e.schema?`${e.schema}.${e.tn}`:e.tn,t]),n+=this.querySeparator()+this.genQuery("DROP TRIGGER IF EXISTS ?? ON ??;",[i,e.tn])+this.querySeparator()+this.genQuery("DROP FUNCTION IF EXISTS ??()",[t])}}return""!==a&&await this.sqlClient.raw(a),t.upStatement[0]={sql:a},t.downStatement[0]={sql:n},t}async tableUpdate(e){const t=this.tableUpdate.name,a=new m.default;f.api(`${t}:args:`,e);try{e.table=e.schema?`${e.schema}.${e.tn}`:e.tn;const t=e.originalColumns;e.connectionConfig=this._connectionConfig,e.sqlClient=this.sqlClient;let n="",s="";for(let a=0;a<e.columns.length;++a){const i=(0,o.default)(t,{cn:e.columns[a].cno});4&e.columns[a].altered?(n+=this.alterTableRemoveColumn(e.table,e.columns[a],i,n),s+=this.alterTableAddColumn(e.table,i,e.columns[a],s)):2&e.columns[a].altered||8&e.columns[a].altered?(n+=this.alterTableChangeColumn(e.table,e.columns[a],i,n),s+=this.alterTableChangeColumn(e.table,i,e.columns[a],s)):1&e.columns[a].altered&&(n+=this.alterTableAddColumn(e.table,e.columns[a],i,n),s+=this.alterTableRemoveColumn(e.table,e.columns[a],i,s))}n+=(n?";":"")+this.alterTablePK(e.table,e.columns,e.originalColumns,n),s+=(s?";":"")+this.alterTablePK(e.table,e.originalColumns,e.columns,s),""!==n&&await this.sqlClient.raw(n);const i=await this.afterTableUpdate(e);a.data.object={upStatement:[{sql:this.querySeparator()+n},...i.upStatement],downStatement:[...i.downStatement,{sql:this.querySeparator()+s}]}}catch(e){throw f.ppe(e,t),e}return a}async tableDelete(e){const t=this.tableDelete.name,a=new m.default;f.api(`${t}:args:`,e);try{e.sqlClient=this.sqlClient;const t=this.querySeparator()+this.sqlClient.schema.dropTable(e.schema?`${e.schema}.${e.tn}`:e.tn).toString();let n=this.createTable(e.tn,e),s=await this.relationList(e);s=s.data.list;for(const e of s){const t=this.sqlClient.raw(this.sqlClient.schema.table(e.tn,(function(t){t=t.foreign(e.cn,null).references(e.rcn).on(e.rtn),e.ur&&(t=t.onUpdate(e.ur)),e.dr&&t.onDelete(e.dr)})).toQuery());n+=this.querySeparator()+t,await t}let i=await this.indexList(e);i=i.data.list.filter((({cst:e})=>"p"!==e&&"f"!==e));const r={};for(const{key_name:t,non_unique:a,cn:n}of i)t in r||(r[t]={tn:e.tn,indexName:t,non_unique:a,columns:[]}),r[t].columns.push(n);for(const{non_unique:e,tn:t,columns:a,indexName:s}of Object.values(r))n+=this.querySeparator()+this.sqlClient.schema.table(t,(function(t){e?t.index(a,s):t.unique(a,s)})).toQuery();this.emit(`Success : ${t}`),await this.sqlClient.raw(this.sqlClient.schema.dropTable(e.schema?`${e.schema}.${e.tn}`:e.tn).toQuery()),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:this.querySeparator()+n}]}}catch(e){throw f.ppe(e,t),e}return a}async tableCreateStatement(e){const t=this.tableCreateStatement.name;let a=new m.default;f.api(`${t}:args:`,e);try{a=await this.columnList(e);const t=this.createTable(e.tn,{tn:e.tn,columns:a.data.list});a.data=t}catch(e){throw f.ppe(e,t),e}return a}async tableInsertStatement(e){const t=this.tableCreateStatement.name,a=new m.default;f.api(`${t}:args:`,e);try{a.data=`INSERT INTO \`${e.tn}\` (`;let t=" VALUES (";const n=await this.columnList(e);if(n.data&&n.data.list)for(let e=0;e<n.data.list.length;++e)e?(a.data+=`, \`"${n.data.list[e].cn}"\`\n\t`,t+=`, <${n.data.list[e].cn}>\n\t`):(a.data+=`\n"${n.data.list[e].cn}"\n\t`,t+=`\n<${n.data.list[e].cn}>\n\t`);a.data+=")",t+=");",a.data+=t}catch(e){throw f.ppe(e,t),e}return a}async tableUpdateStatement(e){const t=this.tableUpdateStatement.name,a=new m.default;f.api(`${t}:args:`,e);try{a.data=`UPDATE "${e.tn}" \nSET\n`;const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`,"${t.data.list[e].cn}" = <\`${t.data.list[e].cn}\`>\n\t`:`"${t.data.list[e].cn}" = <\`${t.data.list[e].cn}\`>\n\t`;a.data+=";"}catch(e){throw f.ppe(e,t),e}return a}async tableDeleteStatement(e){const t=this.tableDeleteStatement.name,a=new m.default;f.api(`${t}:args:`,e);try{a.data=`DELETE FROM "${e.tn}" where ;`}catch(e){throw f.ppe(e,t),e}return a}async tableTruncateStatement(e){const t=this.tableTruncateStatement.name,a=new m.default;f.api(`${t}:args:`,e);try{a.data=`TRUNCATE TABLE "${e.tn}";`}catch(e){throw f.ppe(e,t),e}return a}async tableSelectStatement(e){const t=this.tableSelectStatement.name,a=new m.default;f.api(`${t}:args:`,e);try{a.data="SELECT ";const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`, "${t.data.list[e].cn}"\n\t`:`"${t.data.list[e].cn}"\n\t`;a.data+=` FROM "${e.tn}";`}catch(e){throw f.ppe(e,t),e}return a}alterTablePK(e,t,a,n,s=!1){const i=[],r=[];let c=0;for(let e=0;e<t.length;++e)t[e].pk&&4!==t[e].altered&&r.push(t[e].cn);for(let e=0;e<a.length;++e)a[e].pk&&i.push(a[e].cn);if(r.length===i.length){for(let e=0;e<r.length;++e)if(i[e]!==r[e]){c=1;break}}else c=r.length-i.length;let o="";return(r.length||i.length)&&c&&(o+=i.length?this.genQuery("alter TABLE ?? drop constraint IF EXISTS ??;",[e,`${e}_pkey`]):"",r.length&&(o+=s?this.genQuery(", PRIMARY KEY(??)",[r]):this.genQuery("alter TABLE ?? add constraint ?? PRIMARY KEY(??);",[e,`${e}_pkey`,r]))),o}alterTableRemoveColumn(e,t,a,n){let s=n?",":"";return s+=this.genQuery("ALTER TABLE ?? DROP COLUMN ??",[e,t.cn],!0),s}createTableColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,0)}alterTableAddColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,1)}alterTableChangeColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,2)}createTable(e,t){let a="";for(let n=0;n<t.columns.length;++n)a+=this.createTableColumn(e,t.columns[n],null,a);return a+=this.alterTablePK(e,t.columns,[],a,!0),a=this.genQuery(`CREATE TABLE ?? (${a});`,[t.schema?`${t.schema}.${t.tn}`:t.tn]),a}alterTableColumn(e,t,a,n,s=2){let i="";const r=this.sanitiseDefaultValue(t.cdf),c=!0;if(0===s)i=n?",":"",t.ai?"int8"===t.dt||t.dt.indexOf("bigint")>-1?i+=this.genQuery(" ?? bigserial",[t.cn],c):"int2"===t.dt||t.dt.indexOf("smallint")>-1?i+=this.genQuery(" ?? smallserial",[t.cn],c):i+=this.genQuery(" ?? serial",[t.cn],c):(i+=this.genQuery(` ?? ${this.sanitiseDataType(t.dt)}`,[t.cn],c),i+=t.rqd?" NOT NULL":" NULL",i+=r?` DEFAULT ${r}`:"",i+=t.unique?" UNIQUE":"");else if(1===s)i+=this.genQuery(` ADD ?? ${this.sanitiseDataType(t.dt)}`,[t.cn],c),i+=t.rqd?" NOT NULL":" NULL",i+=r?` DEFAULT ${r}`:"",i+=t.unique?" UNIQUE":"",i=this.genQuery(`ALTER TABLE ?? ${i};`,[e],c);else{if(t.cn!==a.cn&&(i+=this.genQuery("\nALTER TABLE ?? RENAME COLUMN ?? TO ?? ;\n",[e,a.cn,t.cn],c)),t.dt!==a.dt){i+=this.genQuery("\nALTER TABLE ?? ALTER COLUMN ?? DROP DEFAULT;\n",[e,t.cn],c),[l.UITypes.Date,l.UITypes.DateTime,l.UITypes.Time,l.UITypes.Duration].includes(t.uidt)&&(i+=g.default.dateConversionFunction.default.sql),i+=this.genQuery(`\nALTER TABLE ?? ALTER COLUMN ?? TYPE ${this.sanitiseDataType(t.dt)} USING `,[e,t.cn],c);const n=(0,h.formatColumn)(this.genQuery("??",[t.cn],c),a.uidt),s="number"==typeof t.dtxp?t.dtxp:null,r=(0,h.generateCastQuery)(t.uidt,t.dt,n,s,t.meta.date_format||"YYYY-MM-DD");i+=this.genQuery(r,[],c)}t.rqd!==a.rqd&&(i+=this.genQuery("\nALTER TABLE ?? ALTER COLUMN ?? ",[e,t.cn],c),i+=t.rqd?" SET NOT NULL;\n":" DROP NOT NULL;\n"),t.cdf!==a.cdf&&(i+=this.genQuery("\nALTER TABLE ?? ALTER COLUMN ?? ",[e,t.cn],c),i+=t.cdf?` SET DEFAULT ${this.sanitiseDefaultValue(t.cdf)};\n`:" DROP DEFAULT;\n")}return i}get schema(){var e,t;return(null===(t=null===(e=this.connectionConfig)||void 0===e?void 0:e.searchPath)||void 0===t?void 0:t[0])||"public"}async totalRecords(e={}){const t=this.totalRecords.name,a=new m.default;f.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SELECT SUM(n_live_tup) as TotalRecords FROM pg_stat_user_tables;");a.data=e.rows[0]}catch(e){a.code=-1,a.message=e.message,a.object=e}finally{f.api(`${t} :result: ${a}`)}return a}async getDefaultByteaOutputFormat(){var e,t;const a=this.getDefaultByteaOutputFormat.name,n=new m.default;f.api(`${a}:args:`,{});try{const a=await this.sqlClient.raw("SHOW bytea_output;");n.data=null===(t=null===(e=a.rows)||void 0===e?void 0:e[0])||void 0===t?void 0:t.bytea_output}catch(e){n.data="escape"}finally{f.api(`${a} :result: ${n}`)}return n}async tableRename(e){const t=this.tableCreate.name,a=new m.default;f.api(`${t}:args:`,e);try{e.table=e.tn,await this.sqlClient.raw(this.sqlClient.schema.renameTable(this.sqlClient.raw("??.??",[this.getEffectiveSchema(e),e.tn_old]),e.tn).toQuery());const t=this.querySeparator()+this.sqlClient.schema.renameTable(this.sqlClient.raw("??.??",[this.getEffectiveSchema(e),e.tn]),e.tn_old).toQuery();this.emit(`Success : ${t}`);const n=this.querySeparator()+this.sqlClient.schema.renameTable(this.sqlClient.raw("??.??",[this.getEffectiveSchema(e),e.tn_old]),e.tn).toQuery();a.data.object={upStatement:[{sql:t}],downStatement:[{sql:n}]}}catch(e){throw f.ppe(e,t),e}return a}async indexCreate(e){const t=this.indexCreate.name,a=new m.default;f.api(`${t}:args:`,e);const n=e.indexName||null;try{e.table=e.schema?`${e.schema}.${e.tn}`:e.tn,await this.sqlClient.raw(this.sqlClient.schema.table(e.table,(function(t){e.non_unique?t.index(e.columns,n):t.unique(e.columns,n)})).toQuery());const t=this.querySeparator()+this.sqlClient.schema.table(e.table,(function(t){e.non_unique?t.index(e.columns,n):t.unique(e.columns,n)})).toQuery();this.emit(`Success : ${t}`);const s=this.querySeparator()+this.sqlClient.schema.table(e.table,(function(t){e.non_unique?t.dropIndex(e.columns,n):t.dropUnique(e.columns,n)})).toQuery();a.data.object={upStatement:[{sql:t}],downStatement:[{sql:s}]}}catch(e){throw f.ppe(e,t),e}return a}async indexDelete(e){const t=this.indexDelete.name,a=new m.default;f.api(`${t}:args:`,e);const n=e.indexName||null;try{e.table=e.schema?`${e.schema}.${e.tn}`:e.tn,await this.sqlClient.raw(this.sqlClient.schema.table(e.table,(function(t){e.non_unique_original?t.dropIndex(e.columns,n):t.dropUnique(e.columns,n)})).toQuery());const t=this.querySeparator()+this.sqlClient.schema.table(e.table,(function(t){e.non_unique_original?t.dropIndex(e.columns,n):t.dropUnique(e.columns,n)})).toQuery();this.emit(`Success : ${t}`);const s=this.querySeparator()+this.sqlClient.schema.table(e.table,(function(t){e.non_unique_original?t.index(e.columns,n):t.unique(e.columns,n)})).toQuery();a.data.object={upStatement:[{sql:t}],downStatement:[{sql:s}]}}catch(e){throw f.ppe(e,t),e}return a}}t.default=b},566:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(8831)),i=n(a(5578)),r=new(n(a(5924)).default)("YBClient");class c extends s.default{constructor(e){super(e)}async tableList(e={}){const t=this.tableList.name,a=new i.default;r.api(`${t}:args:`,e);try{const{rows:e}=await this.raw("select tablename as tn, * from pg_catalog.pg_tables where schemaname != 'information_schema' and schemaname != 'pg_catalog'");a.data.list=e}catch(e){throw r.ppe(e,t),e}return r.api(`${t}: result`,a),a}async columnList(e={}){const t=this.columnList.name,a=new i.default;r.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.raw('\n      select c.relname as tn, a.attname as cn, pg_catalog.format_type(a.atttypid, a.atttypmod) as "dt",a.attnotnull as "not_nullable",\n      pg_catalog.pg_get_expr(ad.adbin, ad.adrelid, true) as cdf, dsc.description as comment,a.attnum as cop,\n      coalesce(i.indisprimary,false) as pk,\n      a.*,ad.oid as attr_id\n      FROM pg_catalog.pg_attribute a\n      INNER JOIN pg_catalog.pg_class c ON (a.attrelid=c.oid)\n      LEFT OUTER JOIN pg_catalog.pg_attrdef ad ON (a.attrelid=ad.adrelid AND a.attnum = ad.adnum)\n      LEFT OUTER JOIN pg_catalog.pg_description dsc ON (c.oid=dsc.objoid AND a.attnum = dsc.objsubid)\n      LEFT JOIN pg_index i ON (a.attnum = any(i.indkey) and a.attrelid = i.indrelid and i.indrelid = :table::regclass AND i.indisprimary)\n      WHERE NOT a.attisdropped AND c.relname = :table and a.attnum > 0 ORDER BY a.attnum',{table:e.tn}),n=[];for(let a=0;a<t.rows.length;++a){const s={};s.tn=e.tn,s.cn=t.rows[a].cn,s.dt=t.rows[a].dt,s.np=t.rows[a].np,s.ns=t.rows[a].ns,s.clen=t.rows[a].clen,s.dp=t.rows[a].dp,s.cop=t.rows[a].cop,s.dtx=this.getKnexDataType(s.dt),s.pk=null!==t.rows[a].pk_constraint_name,s.not_nullable=t.rows[a].not_nullable,s.nrqd=!s.not_nullable,t.rows[a].ct=t.rows[a].dt||"",s.un=-1!==t.rows[a].ct.indexOf("unsigned"),s.ai=!1,t.rows[a].cdf&&(s.ai=-1!==t.rows[a].cdf.indexOf("nextval")),s.cdf=t.rows[a].cdf?t.rows[a].cdf.replace(/::[\w (),]+$/,"").replace(/^'|'$/g,""):t.rows[a].cdf,s.cc=t.rows[a].comment,s.csn=t.rows[a].csn,n.push(s)}a.data.list=n}catch(e){throw r.ppe(e,t),e}return r.api(`${t}: result`,a),a}}t.default=c},5988:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TIME_FORMATS=t.DATE_FORMATS=void 0;const a={MM:"[0-9]{1,2}"};t.DATE_FORMATS={ymd:Object.keys(a).map((e=>[`Y-${e}-DD`,`^\\d{1,4}[:\\- /]+${a[e]}[:\\- /]+\\d{1,2}$`])),dmy:Object.keys(a).map((e=>[`DD-${e}-Y`,`^\\d{1,2}[:\\- /]+${a[e]}[:\\- /]+\\d{1,4}$`])),mdy:Object.keys(a).map((e=>[`${e}-DD-Y`,`^${a[e]}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,4}$`])),empty:[["","^.*$"]]},t.TIME_FORMATS=[["HH24:MI:SS:MS:US","^\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,3}[:\\- /]+\\d*$"],["HH24:MI:SS:MS","^\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,3}$"],["HH24:MI:SS","^\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,2}$"],["HH24:MI","^\\d{1,2}[:\\- /]+\\d{1,2}$"],["HH24","^\\d{1,2}$"],["HH12:MI:SS:MS:US (AM|PM)","^\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,3}[:\\- /]+\\d* (AM|PM)$"],["HH12:MI:SS:MS (AM|PM)","^\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,3} (AM|PM)$"],["HH12:MI:SS (AM|PM)","^\\d{1,2}[:\\- /]+\\d{1,2}[:\\- /]+\\d{1,2} (AM|PM)$"],["HH12:MI (AM|PM)","^\\d{1,2}[:\\- /]+\\d{1,2} (AM|PM)$"],["HH12 (AM|PM)","^\\d{1,2} (AM|PM)$"]]},5838:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a={columnList:{default:{sql:"SELECT\n      c.table_name as tn,\n      c.column_name as cn,\n      c.data_type as dt,\n      c.column_type as ct,\n      c.character_maximum_length as clen,\n      c.numeric_precision as np,\n      c.numeric_scale as ns,\n      c.datetime_precision as dp,\n      c.ordinal_position as cop,\n      c.column_key as ck,\n      c.extra as ext, -- gives ai\n      c.column_default as cdf,\n      c.is_nullable as nrqd,\n      c.privileges as priv,\n      c.column_comment as cc,\n      c.generation_expression,\n      c.character_set_name as csn,\n      c.collation_name as clnn,\n      ct.CONSTRAINT_TYPE as cst\n    FROM\n      information_schema.COLUMNS as c\n    Left join(\n              select\n                      tc.CONSTRAINT_NAME,\n                      tc.TABLE_NAME,\n                      tc.CONSTRAINT_SCHEMA,\n                      tc.CONSTRAINT_TYPE,\n                      s.COLUMN_NAME\n              from\n                      information_schema.TABLE_CONSTRAINTS as tc\n              LEFT JOIN information_schema.STATISTICS as s ON\n                      s.table_schema = tc.CONSTRAINT_SCHEMA\n                      and s.TABLE_NAME = tc.TABLE_NAME\n                      and s.INDEX_NAME = tc.CONSTRAINT_NAME\n              where\n                      tc.CONSTRAINT_SCHEMA = ?\n                      and s.TABLE_NAME = ? \n      ) ct on\n      c.TABLE_SCHEMA = ct.CONSTRAINT_SCHEMA\n      AND c.TABLE_NAME = ct.TABLE_NAME\n      AND c.COLUMN_NAME = ct.COLUMN_NAME\n    WHERE\n      c.table_schema = ?\n      and c.TABLE_NAME = ?\n    ORDER BY\n      c.table_name,\n      c.ordinal_position",paramsHints:["databaseName","tn","databaseName","tn"]}},constraintList:{default:{sql:"SELECT \n      k.constraint_name as cstn, \n      k.column_name as cn, \n      k.ordinal_position as op, \n      k.position_in_unique_constraint as puc, \n      t.constraint_type as cst\nFROM information_schema.table_constraints t\nLEFT JOIN information_schema.key_column_usage k\nUSING(constraint_name,table_schema,table_name)\nWHERE\nt.table_schema=?\nAND t.table_name=?;",paramsHints:["database","tn"]}},createDatabaseIfNotExists:{default:{sql:"create database if not exists ??",paramsHints:["database"]}},createTableIfNotExists:{default:{sql:"",paramsHints:[]}},dropDatabase:{default:{sql:"drop database ??",paramsHints:["database"]}},databaseList:{default:{sql:"SHOW databases",paramsHints:[]}},hasDatabase:{default:{sql:"SHOW DATABASES LIKE ??",paramsHints:["databaseName"]}},indexList:{default:{sql:"show index from ??",paramsHints:["tn"]}},functionList:{default:{sql:"show function status where db=?",paramsHints:["databaseName"]}},functionRead:{default:{sql:"SHOW CREATE FUNCTION ??",paramsHints:["function_name"]}},functionDelete:{default:{sql:"DROP FUNCTION IF EXISTS ??",paramsHints:["function_name"]}},procedureList:{default:{sql:"show procedure status where db=?",paramsHints:["databaseName"]}},procedureRead:{default:{sql:"show create procedure ??",paramsHints:["procedure_name"]}},procedureDelete:{default:{sql:"DROP PROCEDURE IF EXISTS ??",paramsHints:["procedure_name"]}},relationList:{default:{sql:"SELECT\n      kcu.CONSTRAINT_NAME as cstn,\n      kcu.TABLE_NAME as tn,\n      kcu.COLUMN_NAME as cn,\n      kcu.POSITION_IN_UNIQUE_CONSTRAINT as puc,\n      kcu.REFERENCED_TABLE_NAME as rtn,\n      kcu.REFERENCED_COLUMN_NAME as rcn,\n      rc.MATCH_OPTION as mo,\n      rc.UPDATE_RULE as ur,\n      rc.DELETE_RULE as dr\n    FROM\n      information_schema.`KEY_COLUMN_USAGE` AS kcu\n    INNER JOIN information_schema.REFERENTIAL_CONSTRAINTS AS rc ON\n      kcu.CONSTRAINT_NAME = rc.CONSTRAINT_NAME\n    WHERE\n      kcu.table_schema = ?\n      AND kcu.referenced_column_name IS NOT NULL\n      AND kcu.table_name=?",paramsHints:["database","tn"]}},schemaCreate:{default:{sql:"create database ??",paramsHints:["database_name"]}},schemaDelete:{default:{sql:"drop database ??",paramsHints:["database_name"]}},triggerList:{default:{sql:"SHOW TRIGGERS like ?",paramsHints:["tn"]}},tableList:{default:{sql:"",paramsHints:[]}},testConnection:{default:{sql:"",paramsHints:[]}},triggerRead:{default:{sql:"SHOW FULL TABLES IN ?? WHERE TABLE_TYPE LIKE 'VIEW';",paramsHints:["databaseName"]}},triggerDelete:{default:{sql:"DROP TRIGGER ??",paramsHints:["trigger_name"]}},version:{default:{sql:"",paramsHints:[]}},viewRead:{default:{sql:"select * FROM INFORMATION_SCHEMA.VIEWS WHERE\n       TABLE_SCHEMA = ? AND TABLE_NAME = ?",paramsHints:["databaseName","view_name"]}},viewList:{default:{sql:"SHOW FULL TABLES IN ?? WHERE TABLE_TYPE LIKE 'VIEW'",paramsHints:["databaseName"]}},dateConversionFunction:{default:{sql:"CREATE OR REPLACE FUNCTION to_date_time_safe(value text, format text) RETURNS TIMESTAMP AS $$\n  BEGIN\n    RETURN to_timestamp(value, format);\n    EXCEPTION\n      WHEN others THEN RETURN NULL;  \n  END;\n  $$ LANGUAGE plpgsql;",paramsHints:[]}}};t.default=a},7990:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatColumn=t.generateCastQuery=void 0;const n=a(2678),s=a(5988);function i(e){return`\n    CAST(\n      NULLIF(\n        REPLACE(\n          REPLACE(\n            REGEXP_REPLACE(\n              REGEXP_REPLACE(${e}, '[^0-9.]', '', 'g'), \n              '(\\d)\\.', '\\1-'\n            ), \n            '.', ''\n          ), \n          '-', '.'\n        ), ''\n      ) AS DECIMAL\n    )\n  `}function r(e,t){if(!(t in s.DATE_FORMATS))throw new Error(`Invalid date format: ${t}`);const a="empty"===t?s.TIME_FORMATS:[...s.TIME_FORMATS,["","^$"]];return`CASE \n    ${s.DATE_FORMATS[t].map((([t,n])=>a.map((([a,s])=>`WHEN ${e} ~ '${n.slice(0,-1)}\\s*${s.slice(1)}' THEN to_date_time_safe(${e}, '${t} ${a}')`)).join("\n"))).join("\n")}\n    ELSE NULL\n   END;`}function c(e){const t=e.indexOf("Y"),a=e.indexOf("M"),n=e.indexOf("D");return t<a?a<n?"ymd":t<n?"ydm":"dym":t<n?"myd":a<n?"mdy":"dmy"}t.generateCastQuery=function(e,t,a,s,o){switch(e){case n.UITypes.SingleLineText:case n.UITypes.MultiSelect:case n.UITypes.SingleSelect:case n.UITypes.Email:case n.UITypes.PhoneNumber:case n.UITypes.URL:return`${a}::VARCHAR(${s||255});`;case n.UITypes.LongText:return`${a}::TEXT;`;case n.UITypes.Number:return`CAST(${i(a)} AS BIGINT);`;case n.UITypes.Year:return function(e,t,a){return`\n  NULLIF(\n    NULLIF(\n      LEAST(\n        ${a+1}, GREATEST(${t-1}, ${e})\n      ), ${t-1}\n    ), ${a+1}\n  );\n`}(i(a),1e3,9999);case n.UITypes.Decimal:case n.UITypes.Currency:return`${i(a)};`;case n.UITypes.Percent:return`LEAST(100, GREATEST(0, ${i(a)}));`;case n.UITypes.Rating:return`LEAST(${s||5}, GREATEST(0, ${i(a)}));`;case n.UITypes.Checkbox:return`\n    CASE\n      WHEN LOWER(${l=a}) IN ('checked', 'x', 'yes', 'y', '1', '[x]', '', '', '', '', 'enabled', 'on', 'done', 'true') THEN true\n      WHEN LOWER(${l}) IN ('unchecked', '', 'no', 'n', '0', '[]', '[ ]', 'disabled', 'off', 'false') THEN false\n      ELSE null\n    END;\n  `;case n.UITypes.Date:return`CAST(${r(a,c(o)).slice(0,-1)} AS DATE);`;case n.UITypes.DateTime:return r(a,c(o));case n.UITypes.Time:return r(a,"empty");case n.UITypes.Duration:return function(e){return`\n    CASE\n      WHEN ${e} ~ '^\\d+:\\d{1,2}$' THEN 60 * CAST(SPLIT_PART(${e}, ':', 1) AS INT) + CAST(SPLIT_PART(${e}, ':', 2) AS INT)\n      ELSE ${i(e)}\n    END;\n  `}(a);default:return`null::${t};`}var l},t.formatColumn=function(e,t){switch(t){case n.UITypes.LongText:case n.UITypes.SingleLineText:case n.UITypes.MultiSelect:case n.UITypes.Email:case n.UITypes.URL:case n.UITypes.SingleSelect:case n.UITypes.PhoneNumber:return e;case n.UITypes.Number:case n.UITypes.Decimal:case n.UITypes.Currency:case n.UITypes.Percent:case n.UITypes.Rating:case n.UITypes.Duration:case n.UITypes.Year:return`CAST(${e} AS VARCHAR(255))`;case n.UITypes.Checkbox:return`CAST(CASE WHEN ${e} THEN '1' ELSE '0' END AS TEXT)`;default:return`CAST(${e} AS TEXT)`}}},4321:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(9023),i=n(a(9896)),r=n(a(1832)),c=n(a(943)),o=n(a(9020)),l=n(a(133)),u=a(6331),d=n(a(4020)),m=n(a(5924)),p=n(a(5578)),h=n(a(9252)),g=(0,u.customAlphabet)("1234567890abcdefghijklmnopqrstuvwxyz_",6),f=new m.default("SqliteClient");class b extends d.default{constructor(e){e.connection.useNullAsDefault=!0,super(e),this.sqlClient=(null==e?void 0:e.knex)||(0,r.default)(e.connection),this.queries=h.default,this._version={}}getKnexDataTypes(){const e=new p.default;return e.data.list=["int","integer","tinyint","smallint","mediumint","bigint","int2","int8","character","blob sub_type text","numeric","blob","real","double","double precision","float","numeric","boolean","date","datetime","text","varchar","timestamp"],e}async testConnection(e={}){const t=this.testConnection.name,a=new p.default;f.api(`${t}:args:`,e);try{await this.raw("SELECT 1+1 as data")}catch(e){f.ppe(e),a.code=-1,a.message=e.message}finally{f.api(`${t} :result: ${a}`)}return a}async version(e){const t=this.version.name,a=new p.default;f.api(`${t}:args:`,e);try{a.data.object={};const e=await this.raw("select sqlite_version() as version");f.debug(e[0]),a.data.object.version=e[0].version;const t=e[0].version.split(".");t.length&&3===t.length?(a.data.object.primary=t[0],a.data.object.major=t[1],a.data.object.minor=t[2],a.data.object.key=t[0]+t[1]):(a.code=-1,a.message=`Invalid version : ${e[0].version}`)}catch(e){f.ppe(e),a.code=-1,a.message=e.message}finally{f.api(`${t} :result: %o`,a)}return a}async createDatabaseIfNotExists(e){const t=this.createDatabaseIfNotExists.name,a=new p.default;f.api(`${t}:args:`,e);try{if(await(0,s.promisify)(i.default.exists)(e.database))this.sqlClient=(0,r.default)(this.connectionConfig.connection);else{f.debug("sqlite file do no exists - create one");const t=await(0,s.promisify)(i.default.open)(e.database,"w"),a=await(0,s.promisify)(i.default.close)(t);f.debug("sqlite file is created",t,a),this.sqlClient=(0,r.default)(this.connectionConfig.connection),await this.sqlClient.raw('PRAGMA encoding = "UTF-8"')}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async dropDatabase(e){const t=this.dropDatabase.name,a=new p.default;f.api(`${t}:args:`,e);try{f.debug("dropping database:",e),await(0,s.promisify)(i.default.unlink)(e.database),f.debug("dropped database:")}catch(e){f.ppe(e,t)}return f.api(`${t}: result`,a),a}async createTableIfNotExists(e={}){const t=this.createTableIfNotExists.name,a=new p.default;f.api(`${t}:args:`,e);try{if((await this.hasTable({tn:e.tn})).data.value)f.debug(`${e.tn} tables exists`);else{const t=await this.sqlClient.schema.createTable(e.tn,(function(e){e.increments(),e.string("title").notNullable(),e.string("titleDown").nullable(),e.string("description").nullable(),e.integer("batch").nullable(),e.string("checksum").nullable(),e.integer("status").nullable(),e.dateTime("created"),e.timestamps()}));f.debug("Table created:",`${e.tn}`,t)}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async hasTable(e){const t=this.hasTable.name,a=new p.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw("select * from ??",[e.tn]),a.data.value=!0}catch(e){a.data.value=!1}return f.api(`${t}: result`,a),a}async hasDatabase(e={}){const t=this.hasDatabase.name,a=new p.default;f.api(`${t}:args:`,e);let n=!1;return f.debug("sqlite databaseName:",e.databaseName),n=await(0,s.promisify)(i.default.exists)(e.databaseName),a.data.value=n,a}async databaseList(e){return[]}async tableList(e={}){const t=this.tableList.name,a=new p.default;f.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SELECT name as tn FROM sqlite_master where type = 'table'");a.data.list=[];for(let t=0;t<e.length;++t)"sqlite_sequence"!==e[t].tn.toLocaleLowerCase()&&a.data.list.push(e[t])}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async schemaList(e={}){const t=this.schemaList.name;new p.default;throw f.api(`${t}:args:`,e),new Error("SchemaList : Not supported for sqlite")}async columnList(e={}){const t=this.columnList.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw("PRAGMA table_info(??)",[e.tn]),n=(await this.triggerList(e)).data.list;for(let a=0;a<t.length;++a){switch(t[a].cn=t[a].name,t[a].cno=t[a].cn,t[a].dt=t[a].type.toLocaleLowerCase(),t[a].dt){case"integer":case"int":case"text":case"varchar":case"numeric":case"blob":case"blob sub_type text":case"real":case"timestamp":case"tinyint":case"smallint":case"mediumint":case"bigint":case"int2":case"int8":case"character":case"double":case"double precision":case"float":case"boolean":case"date":case"datetime":case"time":break;default:if("t"===t[a].dt[0]||"i"===t[a].dt[0]){const e=/(\w+)\(([^)]+)\)/.exec(t[a].dt);e&&e.length&&e.length>1&&(t[a].dtxp=e[2],t[a].dt=e[1])}}t[a].nrqd=1!==t[a].notnull,t[a].not_nullable=1===t[a].notnull,t[a].rqd=1===t[a].notnull,t[a].cdf=t[a].dflt_value,t[a].pk=t[a].pk>0,t[a].cop=t[a].cid,t[a].ai=t[a].pk&&"integer"===t[a].dt,t[a].dtx=this.getKnexDataType(t[a].dt),t[a].dtxp="",t[a].dtxs="",t[a].au=!!n.find((({trigger:n})=>n===`xc_trigger_${e.tn}_${t[a].cn}`))}a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async indexList(e={}){const t=this.indexList.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw("PRAGMA index_list(??)",[e.tn]),n=[];for(let e=0,a=0;e<t.length;++e,++a){t[e].key_name=t[e].name,t[e].non_unique=0===t[e].unique?1:0,t[e].non_unique_original=0===t[e].unique?1:0,t[e].unique=1===t[e].unique?1:0;const s=await this.sqlClient.raw("PRAGMA index_info(??)",[t[e].key_name]);if(1===s.length)n[a]=t[e],n[a].cn=s[0].name,n[a].seq_in_index=1;else{for(let i=0;i<s.length;++i,++a)n[a]=JSON.parse(JSON.stringify(t[e])),n[a].cn=s[i].name,n[a].seq_in_index=i;a--}}a.data.list=n}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async relationList(e={}){const t=this.relationList.name,a=new p.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("PRAGMA foreign_key_list(??)",[e.tn]);for(let a=0;a<t.length;++a)t[a].tn=e.tn,t[a].cn=t[a].from,t[a].rtn=t[a].table,t[a].rcn=t[a].to,t[a].ur=t[a].on_update,t[a].dr=t[a].on_delete,t[a].mo=t[a].match;a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async relationListAll(e={}){const t=this.relationList.name,a=new p.default;f.api(`${t}:args:`,e);try{let e=await this.tableList();e=e.data.list;const t=[];for(let a=0;a<e.length;++a){const n=await this.sqlClient.raw("PRAGMA foreign_key_list(??)",[e[a].tn]);for(let s=0;s<n.length;++s)n[s].tn=e[a].tn,n[s].cn=n[s].from,n[s].rtn=n[s].table,n[s].rcn=n[s].to,n[s].ur=n[s].on_update,n[s].dr=n[s].on_delete,n[s].mo=n[s].match,t.push(n[s])}a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerList(e={}){const t=this.triggerList.name,a=new p.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("select *, name as trigger_name from sqlite_master where type = 'trigger' and tbl_name=?;",[e.tn]);for(let e=0;e<t.length;++e)t[e].trigger=t[e].name,t[e].table=t[e].tbl_name,t[e].statement=t[e].sql;a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async functionList(e={}){const t=this.functionList.name,a=new p.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("show function status where db=?",[e.databaseName]);if(2===t.length){const e=[];for(let a=0;a<t[0].length;++a){let n=t[0][a];n=(0,o.default)(n,(function(e,t){return t.toLowerCase()})),n.function_name=n.name,e.push(n)}a.data.list=e}else f.debug("Unknown response for databaseList:",t),a.data.list=[]}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureList(e={}){const t=this.procedureList.name,a=new p.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("show procedure status where db=?",[e.databaseName]);if(2===t.length){const e=[];for(let a=0;a<t[0].length;++a){let n=t[0][a];n=(0,o.default)(n,(function(e,t){return t.toLowerCase()})),n.procedure_name=n.name,e.push(n)}a.data.list=e}else f.debug("Unknown response for databaseList:",t),a.data.list=[]}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewList(e={}){const t=this.viewList.name,a=new p.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("SELECT * FROM sqlite_master WHERE type = 'view'");for(let e=0;e<t.length;++e)t[e].view_name=t[e].name,t[e].view_definition=t[e].sql;a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async functionRead(e={}){const t=this.functionRead.name,a=new p.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("SHOW CREATE FUNCTION ??;",[e.function_name]);if(2===t.length){const e=[];for(let a=0;a<t[0].length;++a){let n=t[0][a];n=(0,o.default)(n,(function(e,t){return t.toLowerCase()})),n.create_function=n["create function"],e.push(n)}a.data.list=e}else f.debug("Unknown response for databaseList:",t),a.data.list=[]}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureRead(e={}){const t=this.procedureRead.name,a=new p.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("show create procedure ??;",[e.procedure_name]);if(2===t.length){const e=[];for(let a=0;a<t[0].length;++a){let n=t[0][a];n=(0,o.default)(n,(function(e,t){return t.toLowerCase()})),n.create_procedure=n["create procedure"],e.push(n)}a.data.list=e}else f.debug("Unknown response for databaseList:",t),a.data.list=[]}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewRead(e={}){const t=this.viewRead.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw("SELECT * FROM sqlite_master WHERE type = 'view' AND name = ?",[e.view_name]);for(let e=0;e<t.length;++e)t[e].view_name=t[e].name,t[e].view_definition=t[e].sql;a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerRead(e={}){const t=this.triggerRead.name,a=new p.default;f.api(`${t}:args:`,e);try{e.databaseName=this.connectionConfig.connection.database;const t=await this.sqlClient.raw("SHOW FULL TABLES IN ?? WHERE TABLE_TYPE LIKE 'VIEW';",[e.databaseName]);if(2===t.length){const n=[];for(let a=0;a<t[0].length;++a){const s=t[0][a];s.view_name=s[`Tables_in_${e.databaseName}`],n.push(s)}a.data.list=n}else f.debug("Unknown response for databaseList:",t),a.data.list=[]}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async schemaCreate(e={}){const t=this.schemaCreate.name;f.api(`${t}:args:`,e);return await this.sqlClient.raw("create database ??",[e.database_name])}async schemaDelete(e={}){const t=this.schemaDelete.name;f.api(`${t}:args:`,e);return await this.sqlClient.raw("drop database ??",[e.database_name])}async triggerDelete(e={}){const t=this.triggerDelete.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+"DROP TRIGGER ??";await this.sqlClient.raw(t,[e.trigger_name]),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:";"}]}}catch(e){throw f.ppe(e,t),e}return a}async functionDelete(e={}){const t=this.functionDelete.name;f.api(`${t}:args:`,e);return await this.sqlClient.raw("DROP FUNCTION IF EXISTS ??",[e.function_name])}async procedureDelete(e={}){const t=this.procedureDelete.name;f.api(`${t}:args:`,e);return await this.sqlClient.raw("DROP PROCEDURE IF EXISTS ??",[e.procedure_name])}async _getQuery(e){try{if((0,c.default)(this._version)){const t=await this.version();this._version=t.data.object,f.debug(`Version was empty for ${e.func}: population version for database as`,this._version)}return this._version.key in this.queries[e.func]?this.queries[e.func][this._version.key].sql:this.queries[e.func].default.sql}catch(e){throw f.ppe(e,this._getQuery.name),e}}async functionCreate(e={}){const t=this.functionCreate.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw(`CREATE TRIGGER ${this.genIdentifier(e.function_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`);a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async functionUpdate(e={}){const t=this.functionUpdate.name,a=new p.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP TRIGGER ${this.genIdentifier(e.function_name)}`);const t=await this.sqlClient.raw(`CREATE TRIGGER ${this.genIdentifier(e.function_name)}\` \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`);a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureCreate(e={}){const t=this.procedureCreate.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=await this.sqlClient.raw(`CREATE TRIGGER ${this.genIdentifier(e.procedure_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`);a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async procedureUpdate(e={}){const t=this.procedureUpdate.name,a=new p.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw(`DROP TRIGGER ${e.procedure_name}`);const t=await this.sqlClient.raw(`CREATE TRIGGER ${this.genIdentifier(e.procedure_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`);a.data.list=t}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerCreate(e={}){const t=this.triggerCreate.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=this.querySeparator()+`CREATE TRIGGER ${this.genIdentifier(e.trigger_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:t}],downStatement:[{sql:";"}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async triggerUpdate(e={}){const t=this.triggerUpdate.name,a=new p.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw("DROP TRIGGER ??",[e.trigger_name]),await this.sqlClient.raw(`CREATE TRIGGER ${this.genIdentifier(e.trigger_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`);const t=`DROP TRIGGER ${this.genIdentifier(e.trigger_name)};\nCREATE TRIGGER ${this.genIdentifier(e.trigger_name)} \n${e.timing} ${e.event}\nON ${this.genIdentifier(e.tn)} FOR EACH ROW\n${e.statement}`;a.data.object={upStatement:[{sql:t}],downStatement:[{sql:";"}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewCreate(e={}){const t=this.viewCreate.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=e.view_definition+";";await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:";"}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewUpdate(e={}){const t=this.viewUpdate.name,a=new p.default;f.api(`${t}:args:`,e);try{const t=e.view_definition;await this.sqlClient.raw(t),a.data.object={upStatement:[{sql:this.querySeparator()+t}],downStatement:[{sql:";"}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async viewDelete(e={}){const t=this.viewDelete.name,a=new p.default;f.api(`${t}:args:`,e);try{await this.sqlClient.raw("DROP VIEW ??;",[e.view_name]),a.data.object={upStatement:[{sql:this.querySeparator()+`DROP VIEW ${e.view_name};`}],downStatement:[{sql:";"}]}}catch(e){throw f.ppe(e,t),e}return f.api(`${t}: result`,a),a}async tableCreate(e){const t=this.tableCreate.name,a=new p.default;f.api(`${t}:args:`,e);try{e.table=e.tn,e.sqlClient=this.sqlClient;const t=this.querySeparator()+this.createTable(e.tn,e);await this.sqlClient.raw(t);const n=[{sql:";"}];this.emit(`Success : ${t}`);const s=await this.afterTableCreate(e);a.data.object={upStatement:[{sql:t},...s.upStatement],downStatement:n}}catch(e){throw f.ppe(e,t),e}return a}async afterTableCreate(e){const t={upStatement:[],downStatement:[]};let a="";const n=e.columns.find((e=>e.pk));if(!n)return t;const s=this.genIdentifier(e.tn);for(let t=0;t<e.columns.length;t++){const i=e.columns[t];if(i.au){const e=this.genIdentifier(`xc_trigger_${s}_${i.cn}`),t=`${this.querySeparator()}CREATE TRIGGER ${e}\n            AFTER UPDATE\n            ON "${s}" FOR EACH ROW\n            BEGIN\n              UPDATE "${s}" SET ${this.genIdentifier(i.cn)} = current_timestamp\n                WHERE ${this.genIdentifier(n.cn)} = old.${this.genIdentifier(n.cn)};\n            END;`;a+=t,await this.sqlClient.raw(t)}}return t.upStatement[0]={sql:a},t.downStatement[0]={sql:""},t}async afterTableUpdate(e){const t={upStatement:[],downStatement:[]};let a="";const n=e.columns.find((e=>e.pk));if(!n)return t;const s=this.genIdentifier(e.tn);for(let t=0;t<e.columns.length;t++){const i=e.columns[t];if(i.au&&1===i.altered){const t=this.genIdentifier(`xc_trigger_${e.tn}_${i.cn}`),r=`${this.querySeparator()}CREATE TRIGGER ${t}\n            AFTER UPDATE\n            ON "${s}" FOR EACH ROW\n            BEGIN\n              UPDATE "${s}" SET ${this.genIdentifier(i.cn)} = current_timestamp\n                WHERE ${this.genIdentifier(n.cn)} = old.${this.genIdentifier(n.cn)};\n            END;`;a+=r,await this.sqlClient.raw(r)}}return t.upStatement[0]={sql:a},t.downStatement[0]={sql:""},t}async tableUpdate(e){var t,a;const n=this.tableUpdate.name,s=new p.default;f.api(`${n}:args:`,e);try{e.table=e.tn;const n=e.originalColumns;e.connectionConfig=this._connectionConfig,e.sqlClient=this.sqlClient;let i="",r="";for(let t=0;t<e.columns.length;++t){const a=(0,l.default)(n,{cn:e.columns[t].cno});!e.columns[t].pk&&4&e.columns[t].altered?(i+=this.alterTableRemoveColumn(e.table,e.columns[t],a,i),r+=this.alterTableAddColumn(e.table,a,e.columns[t],r)):2&e.columns[t].altered||8&e.columns[t].altered?(i+=this.alterTableChangeColumn(e.table,e.columns[t],a,i),r+=";"):1&e.columns[t].altered&&(i+=this.alterTableAddColumn(e.table,e.columns[t],a,i),r+=";")}const c=this.alterTablePK(e.columns,e.originalColumns,i),o=null===(a=null===(t=await this.sqlClient.raw("PRAGMA foreign_keys;"))||void 0===t?void 0:t[0])||void 0===a?void 0:a.foreign_keys;o&&await this.sqlClient.raw("PRAGMA foreign_keys = OFF;"),await this.sqlClient.raw("PRAGMA legacy_alter_table = ON;"),await this.sqlClient.raw("SELECT * FROM ?? LIMIT 1",[e.table]);const u=await this.sqlClient.transaction(),d=e=>{const t=[];let a,n=0,s="";for(let i=0;i<e.length;i++)a||'"'!==e[i]&&"'"!==e[i]||(a='"'===e[i]?"double":"single"),("double"===a&&'"'===e[i]||"single"===a&&"'"===e[i])&&i>0&&"\\"!==e[i-1]&&n++,";"===e[i]&&n%2==0?(t.push(s),s="",a=void 0):s+=e[i];return""!==s.trim()&&t.push(s),t};try{const t=d(i);for(let e=0;e<t.length;e++)""!==t[e].trim()&&await u.raw(t[e]);c&&await u.schema.alterTable(e.table,(e=>{for(const t of c.oldPks.filter((e=>!c.newPks.includes(e))))e.dropPrimary(t);for(const t of c.dropPks)e.dropColumn(t);c.newPks.length&&e.primary(c.newPks)})),await u.commit()}catch(e){throw await u.rollback(),e}finally{o&&await this.sqlClient.raw("PRAGMA foreign_keys = ON;"),await this.sqlClient.raw("PRAGMA legacy_alter_table = OFF;")}console.log(i);const m=await this.afterTableUpdate(e);s.data.object={upStatement:[{sql:this.querySeparator()+i},...m.upStatement],downStatement:[{sql:";"}]}}catch(e){throw f.ppe(e,n),e}return s}async tableDelete(e){const t=this.tableDelete.name,a=new p.default;f.api(`${t}:args:`,e);try{e.sqlClient=this.sqlClient;const t=this.querySeparator()+this.sqlClient.schema.dropTable(e.tn).toString(),n=[{sql:";"}];this.emit(`Success : ${t}`),await this.sqlClient.schema.dropTable(e.tn),a.data.object={upStatement:[{sql:t}],downStatement:n}}catch(e){throw f.ppe(e,t),e}return a}async tableCreateStatement(e){const t=this.tableCreateStatement.name;let a=new p.default;f.api(`${t}:args:`,e);try{a=await this.columnList(e);const t=this.createTable(e.tn,{tn:e.tn,columns:a.data.list});a.data=t}catch(e){throw f.ppe(e,t),e}return a}async tableInsertStatement(e){const t=this.tableCreateStatement.name,a=new p.default;f.api(`${t}:args:`,e);try{a.data=`INSERT INTO "${e.tn}" (`;let t=" VALUES (";const n=await this.columnList(e);if(n.data&&n.data.list)for(let e=0;e<n.data.list.length;++e)e?(a.data+=`, \`${n.data.list[e].cn}\`\n\t`,t+=`, <${n.data.list[e].cn}>\n\t`):(a.data+=`\n${n.data.list[e].cn}\n\t`,t+=`\n<${n.data.list[e].cn}>\n\t`);a.data+=")",t+=");",a.data+=t}catch(e){throw f.ppe(e,t),e}return a}async tableUpdateStatement(e){const t=this.tableUpdateStatement.name,a=new p.default;f.api(`${t}:args:`,e);try{a.data=`UPDATE "${e.tn}" \nSET\n`;const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`,${t.data.list[e].cn} = <\`${t.data.list[e].cn}\`>\n\t`:`${t.data.list[e].cn} = <\`${t.data.list[e].cn}\`>\n\t`;a.data+=";"}catch(e){throw f.ppe(e,t),e}return a}async tableDeleteStatement(e){const t=this.tableDeleteStatement.name,a=new p.default;f.api(`${t}:args:`,e);try{a.data=`DELETE FROM "${e.tn}" where ;`}catch(e){throw f.ppe(e,t),e}return a}async tableTruncateStatement(e){const t=this.tableTruncateStatement.name,a=new p.default;f.api(`${t}:args:`,e);try{a.data=`TRUNCATE TABLE "${e.tn}";`}catch(e){throw f.ppe(e,t),e}return a}async tableSelectStatement(e){const t=this.tableSelectStatement.name,a=new p.default;f.api(`${t}:args:`,e);try{a.data="SELECT ";const t=await this.columnList(e);if(t.data&&t.data.list)for(let e=0;e<t.data.list.length;++e)a.data+=e?`, ${t.data.list[e].cn}\n\t`:`${t.data.list[e].cn}\n\t`;a.data+=` FROM "${e.tn}";`}catch(e){throw f.ppe(e,t),e}return a}async sequelizeModelCreate(e){const t=this.sequelizeModelCreate.name,a=new p.default;f.api(`${t}:args:`,e);try{console.time(t);let a=[];e.tn?a.push({tn:e.tn}):(a=await this.tableList(e),a=a.data.list);let n=await this.relationList(e);n=n.data.list,e.tn&&(n=n.filter((t=>t.tn===e.tn||t.rtn===e.tn)));for(let e=0;e<a.length;++e){let t=await this.columnList({tn:a[e].tn});t=t.data.list,console.log(`Sequelize model created: ${a[e].tn}(${t.length})\n`),console.log("\n\n- - - - - - - - - - - - - ")}console.timeEnd(t)}catch(e){throw f.ppe(e,t),e}return a}createTablePK(e,t){const a=[];for(let t=0;t<e.length;++t)e[t].pk&&4!==e[t].altered&&a.push(e[t].cn);let n="";return a.length&&(n+=this.genQuery(", PRIMARY KEY(??)",[a])),n}alterTablePK(e,t,a){const n=[],s=[],i=[];let r=!1;for(let t=0;t<e.length;++t)e[t].pk&&(4!==e[t].altered?n.push(e[t].cn):i.push(e[t].cn),r=!0);for(let e=0;e<t.length;++e)t[e].pk&&s.push(t[e].cn);return n.length===s.length&&n.every((e=>s.includes(e)))&&0===i.length&&(r=!1),!!r&&{newPks:n,oldPks:s,dropPks:i}}alterTableRemoveColumn(e,t,a,n){let s=n?";":"";return s+=this.genQuery("ALTER TABLE ?? DROP COLUMN ??",[e,t.cn],!0),s}createTableColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,0)}alterTableAddColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,1)}alterTableChangeColumn(e,t,a,n){return this.alterTableColumn(e,t,a,n,2)}createTable(e,t){let a="";for(let n=0;n<t.columns.length;++n)a+=this.createTableColumn(e,t.columns[n],null,a);return a+=this.createTablePK(t.columns,a),a=this.genQuery(`CREATE TABLE ?? (${a});`,[t.tn]),a}alterTableColumn(e,t,a,n,s=2){let i="",r=!0;if(2===s){const n=g(),s=this.genQuery("ALTER TABLE ?? RENAME COLUMN ?? TO ??;",[e,a.cn,`${a.cno}_nc_${n}`],r);let c="";c+=this.genQuery(` ADD ?? ${this.sanitiseDataType(t.dt)}`,[t.cn],r),c+=t.dtxp&&"text"!==t.dt?`(${this.genRaw(t.dtxp)})`:"",c+=t.cdf?` DEFAULT ${this.genValue(t.cdf)}`:t.rqd?" DEFAULT ''":" ",c+=t.rqd?" NOT NULL":" ",i+=t.unique?" UNIQUE":"",c=this.genQuery(`ALTER TABLE ?? ${c};`,[e],r);i=`${s}${c}${this.genQuery("UPDATE ?? SET ?? = ??;",[e,t.cn,`${a.cno}_nc_${n}`],r)}${this.genQuery("ALTER TABLE ?? DROP COLUMN ??;",[e,`${a.cno}_nc_${n}`],r)}`}else 0===s?(i=n?",":"",i+=this.genQuery(`?? ${this.sanitiseDataType(t.dt)}`,[t.cn],r),i+=t.dtxp&&"text"!==t.dt?`(${this.genRaw(t.dtxp)})`:"",i+=t.cdf?` DEFAULT ${this.genValue(t.cdf)}`:" ",i+=t.rqd?" NOT NULL":" "):1===s&&(r=!0,i+=this.genQuery(` ADD ?? ${this.sanitiseDataType(t.dt)}`,[t.cn],r),i+=t.dtxp&&"text"!==t.dt?`(${this.genRaw(t.dtxp)})`:"",i+=t.cdf?` DEFAULT ${this.genValue(t.cdf)}`:t.rqd?" DEFAULT ''":" ",i+=t.rqd?" NOT NULL":" ",i=this.genQuery(`ALTER TABLE ?? ${i};`,[e],r));return i}async totalRecords(e={}){const t=this.totalRecords.name,a=new p.default;f.api(`${t}:args:`,e);try{const e=await this.sqlClient.raw("SELECT name FROM sqlite_master WHERE type='table';");let t=0;for(const a of e){const e=await this.sqlClient.raw("SELECT COUNT(*) as ct FROM ??;",[a.name]);e&&e.length&&(t+=e[0].ct)}a.data.TotalRecords=t}catch(e){a.code=-1,a.message=e.message,a.object=e}finally{f.api(`${t} :result: ${a}`)}return a}genValue(e){return"CURRENT_TIMESTAMP"===e?e:super.genValue(e)}}t.default=b},9252:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={int:{},integer:{},tinyint:{},smallint:{},mediumint:{},bigint:{},"unsigned big int":{},int2:{},int4:{},character:{},varchar:{},nchar:{},text:{},clob:{},"varying character":{},"native character":{},blob:{},real:{},double:{},"double precision":{},float:{},numeric:{},decimal:{},boolean:{},date:{},datetime:{}}},5924:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var s=Object.getOwnPropertyDescriptor(t,a);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,s)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return s(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const c=r(a(6986)),o=r(a(263));Promise.resolve().then((()=>i(a(3672))));const l=r(a(6364));t.default=class{constructor(e){this.namespace=e,this.api=(0,o.default)(`${e}_A`),this.warn=(0,o.default)(`${e}_W`),this.info=(0,o.default)(`${e}_I`),this.error=(0,o.default)(`${e}_E`),this.debug=(0,o.default)(`${e}_D`),l.default.createNamespace(e)}ppException(e,t=null){let a="";return a+=`                                              EXCEPTION OCCURED!! in ${this.namespace.red.bold} @ ${t}`,a+="\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n".red.bold,a+="MESSAGE:\n".yellow.bold,a+=`${e.message}\n`.yellow.bold,a+="\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n".red.bold,a+="CODE:\n".yellow.bold,a+=`${e.code}\n`.yellow.bold,a+="\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n".red.bold,a+="STACK:\n".yellow.bold,a+=`${e.stack}\n`.yellow.bold,a+="\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n".red.bold,console.log((0,c.default)(a,{padding:1,borderStyle:"double"})),console.log(e),a}ppe(e,t){return this.ppException(e,t)}}},6364:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(263)),i={},r={api:"A",info:"I",error:"E",warn:"W",debug:"D"};t.default=class{static _create(e){i[e]?(i[e][`${e}_A`].enabled=s.default.enabled(`${e}_A`),i[e][`${e}_D`].enabled=s.default.enabled(`${e}_D`),i[e][`${e}_I`].enabled=s.default.enabled(`${e}_I`),i[e][`${e}_W`].enabled=s.default.enabled(`${e}_W`),i[e][`${e}_E`].enabled=s.default.enabled(`${e}_E`)):(i[e]={},i[e][`${e}_A`]={level:"api",enabled:s.default.enabled(`${e}_A`)},i[e][`${e}_W`]={level:"warn",enabled:s.default.enabled(`${e}_W`)},i[e][`${e}_I`]={level:"info",enabled:s.default.enabled(`${e}_I`)},i[e][`${e}_E`]={level:"error",enabled:s.default.enabled(`${e}_E`)},i[e][`${e}_D`]={level:"debug",enabled:s.default.enabled(`${e}_D`)})}static createNamespace(e){e in i||this._create(e)}static getNamespaces(){return i}static refreshNamespace(e){this._create(e)}static enable(e,t){const a=`${e}_${r[t]},${s.default.disable()}`;s.default.enable(`${a}`),this.refreshNamespace(e)}static disable(e,t){const a=`${e}_${r[t]}`;let n=`${s.default.disable()}`;n=n.replace(a,""),s.default.enable(n),this.refreshNamespace(e)}static enableAll(e){for(const t in r)s.default.enable(`${e}_${r[t]}`),this.refreshNamespace(e)}static disableAll(){s.default.disable()}}},5578:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e=0,t="",a={}){this.code=e,this.message=t,this.data=a}}},2196:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(5833));let i=null;t.default=class{constructor(){if(i)return i;this.evt=new s.default,i=this}}},1141:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(8938));t.default=class{constructor({flushAt:e=100,flushInterval:t=1e4}={}){this.batch=[],this.flushAt=e,this.flushInterval=t}capture(e){this.batch.push(e),this.batch.length>=this.flushAt&&this.flushBackground(),this.flushInterval&&(this.timeoutRef=setTimeout((()=>{this.flushBackground()}),this.flushInterval))}flushBackground(){this.timeoutRef&&(clearTimeout(this.timeoutRef),this.timeoutRef=null),this.flush().catch((()=>{}))}async flush(){const e=this.batch.splice(0,this.batch.length);e.length&&await s.default.post("https://nocodb.com/api/v1/telemetry",e)}}},8138:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCircularReplacer=void 0;t.getCircularReplacer=()=>{const e=new WeakSet;return(t,a)=>{if("object"==typeof a&&null!==a){if(e.has(a))return;e.add(a)}return a}}},9052:(e,t)=>{"use strict";function a(e,t,a){let n,s,i=void 0===a?2166136261:a;for(n=0,s=e.length;n<s;n++)i^=e.charCodeAt(n),i+=(i<<1)+(i<<4)+(i<<7)+(i<<8)+(i<<24);return t?("0000000"+(i>>>0).toString(16)).substr(-8):i>>>0}function n(e){const t=a(e,!0);return t+a(t+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.partialExtract=t.deepMerge=t.getParamsHash=t.hash64=t.ROOT_ALIAS=t.getAliasGenerator=void 0,t.getAliasGenerator=function(e="__nc_"){let t=0;return()=>`${e}${t++}`},t.ROOT_ALIAS="__nc_root",t.hash64=n;t.getParamsHash=e=>{let t="";for(const[a,n]of Object.entries(e).sort())["limit","offset"].includes(a)||(t+=`${a}:${n}`);return n(t)};const s=e=>e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e);t.deepMerge=(e,...a)=>{if(!a.length)return e;const n=a.shift();return void 0===n?e:(s(e)&&s(n)&&Object.keys(n).forEach((a=>{s(n[a])?(e[a]||(e[a]={}),(0,t.deepMerge)(e[a],n[a])):e[a]=n[a]})),(0,t.deepMerge)(e,...a))};t.partialExtract=(e,a)=>{if("object"!=typeof e||null===e)return e;const n={};for(const s of a)if(Array.isArray(s)){const[a,...i]=s;i.length?n[a]=Object.assign(n[a]||{},(0,t.partialExtract)(e[a],i)):n[a]=e[a]}else n[s]=e[s];return n}},9372:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitiseEmailContent=void 0;const a=e=>null==e?void 0:e.split("").map((e=>`&#${e.charCodeAt(0)};`)).join("");t.sanitiseEmailContent=e=>{var t;return null===(t=null==e?void 0:e.replace(/[<>&;?#,'"$]+/g,a))||void 0===t?void 0:t.replace(/\.|\/\/:/g,"<span>$&</span>")}},9191:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decryptPropIfRequired=t.encryptPropIfRequired=t.isEncryptionRequired=t.getCredentialEncryptSecret=void 0;const s=n(a(2103));t.getCredentialEncryptSecret=()=>process.env.NC_CONNECTION_ENCRYPT_KEY;t.isEncryptionRequired=(e=(0,t.getCredentialEncryptSecret)())=>!!e;t.encryptPropIfRequired=({data:e,prop:a="config",secret:n=(0,t.getCredentialEncryptSecret)()})=>{if(e&&null!==e[a]&&void 0!==e[a])return n?s.default.AES.encrypt(JSON.stringify(e[a]),n).toString():JSON.stringify(e[a])};t.decryptPropIfRequired=({data:e,prop:a="config",secret:n=(0,t.getCredentialEncryptSecret)()})=>{if(!e||null===e[a]||void 0===e[a])return;let i=e[a];if(n)try{i=s.default.AES.decrypt(e[a],n).toString(s.default.enc.Utf8)}catch(e){throw new Error("Config decryption failed")}return"string"==typeof i?JSON.parse(i):i}},9261:(e,t)=>{"use strict";var a,n,s,i,r,c;Object.defineProperty(t,"__esModule",{value:!0}),t.RootScopeTables=t.RootScopes=t.DB_TYPES=t.COMPARISON_SUB_OPS=t.IS_WITHIN_COMPARISON_SUB_OPS=t.COMPARISON_OPS=t.GROUPBY_COMPARISON_OPS=t.CacheDelDirection=t.CacheGetType=t.CacheScope=t.sakilaTableNames=t.orderedMetaTables=t.MetaTableOldV2=t.MetaTable=void 0,function(e){e.PROJECT="nc_bases_v2",e.SOURCES="nc_source_v2",e.MODELS="nc_models_v2",e.COLUMNS="nc_columns_v2",e.COLUMN_VALIDATIONS="nc_columns_validations_v2",e.COL_PROPS="nc_col_props_v2",e.COL_RELATIONS="nc_col_relations_v2",e.COL_SELECT_OPTIONS="nc_col_select_options_v2",e.COL_LOOKUP="nc_col_lookup_v2",e.COL_ROLLUP="nc_col_rollup_v2",e.COL_FORMULA="nc_col_formula_v2",e.COL_QRCODE="nc_col_qrcode_v2",e.COL_BARCODE="nc_col_barcode_v2",e.FILTER_EXP="nc_filter_exp_v2",e.SORT="nc_sort_v2",e.SHARED_VIEWS="nc_shared_views_v2",e.ACL="nc_acl_v2",e.FORM_VIEW="nc_form_view_v2",e.FORM_VIEW_COLUMNS="nc_form_view_columns_v2",e.GALLERY_VIEW="nc_gallery_view_v2",e.GALLERY_VIEW_COLUMNS="nc_gallery_view_columns_v2",e.CALENDAR_VIEW="nc_calendar_view_v2",e.CALENDAR_VIEW_COLUMNS="nc_calendar_view_columns_v2",e.CALENDAR_VIEW_RANGE="nc_calendar_view_range_v2",e.GRID_VIEW="nc_grid_view_v2",e.GRID_VIEW_COLUMNS="nc_grid_view_columns_v2",e.KANBAN_VIEW="nc_kanban_view_v2",e.KANBAN_VIEW_COLUMNS="nc_kanban_view_columns_v2",e.USERS="nc_users_v2",e.ORGS_OLD="nc_orgs_v2",e.TEAMS="nc_teams_v2",e.TEAM_USERS="nc_team_users_v2",e.VIEWS="nc_views_v2",e.AUDIT="nc_audit_v2",e.HOOKS="nc_hooks_v2",e.HOOK_LOGS="nc_hook_logs_v2",e.PLUGIN="nc_plugins_v2",e.PROJECT_USERS="nc_base_users_v2",e.MODEL_ROLE_VISIBILITY="nc_disabled_models_for_role_v2",e.API_TOKENS="nc_api_tokens",e.SYNC_SOURCE="nc_sync_source_v2",e.SYNC_LOGS="nc_sync_logs_v2",e.MAP_VIEW="nc_map_view_v2",e.MAP_VIEW_COLUMNS="nc_map_view_columns_v2",e.STORE="nc_store",e.NOTIFICATION="notification",e.USER_REFRESH_TOKENS="nc_user_refresh_tokens",e.EXTENSIONS="nc_extensions",e.COMMENTS="nc_comments",e.USER_COMMENTS_NOTIFICATIONS_PREFERENCE="nc_user_comment_notifications_preference",e.COMMENTS_REACTIONS="nc_comment_reactions",e.JOBS="nc_jobs",e.INTEGRATIONS="nc_integrations_v2",e.INTEGRATIONS_STORE="nc_integrations_store_v2",e.FILE_REFERENCES="nc_file_references",e.COL_BUTTON="nc_col_button_v2"}(a||(t.MetaTable=a={})),function(e){e.PROJECT="nc_projects_v2",e.PROJECT_USERS="nc_project_users_v2",e.BASES="nc_bases_v2"}(n||(t.MetaTableOldV2=n={})),t.orderedMetaTables=[a.MODEL_ROLE_VISIBILITY,a.PLUGIN,a.AUDIT,a.TEAM_USERS,a.TEAMS,a.ORGS_OLD,a.PROJECT_USERS,a.USERS,a.MAP_VIEW,a.MAP_VIEW_COLUMNS,a.KANBAN_VIEW_COLUMNS,a.KANBAN_VIEW,a.CALENDAR_VIEW,a.CALENDAR_VIEW_COLUMNS,a.CALENDAR_VIEW_RANGE,a.GRID_VIEW_COLUMNS,a.GRID_VIEW,a.GALLERY_VIEW_COLUMNS,a.GALLERY_VIEW,a.FORM_VIEW_COLUMNS,a.FORM_VIEW,a.SHARED_VIEWS,a.SORT,a.FILTER_EXP,a.HOOK_LOGS,a.HOOKS,a.VIEWS,a.COL_FORMULA,a.COL_ROLLUP,a.COL_LOOKUP,a.COL_SELECT_OPTIONS,a.COL_RELATIONS,a.COLUMN_VALIDATIONS,a.COLUMNS,a.MODELS,a.SOURCES,a.PROJECT],t.sakilaTableNames=["actor","address","category","city","country","customer","film","film_actor","film_category","film_text","inventory","language","payment","rental","staff","store","actor_info","customer_list","film_list","nicer_but_slower_film_list","sales_by_film_category","sales_by_store","staff_list"],function(e){e.PROJECT="base",e.SOURCE="source",e.MODEL="model",e.COLUMN="column",e.COL_PROP="colProp",e.COL_RELATION="colRelation",e.COL_SELECT_OPTION="colSelectOption",e.COL_LOOKUP="colLookup",e.COL_ROLLUP="colRollup",e.COL_FORMULA="colFormula",e.COL_QRCODE="colQRCode",e.COL_BARCODE="colBarcode",e.FILTER_EXP="filterExp",e.SORT="sort",e.SHARED_VIEW="sharedView",e.ACL="acl",e.FORM_VIEW="formView",e.FORM_VIEW_COLUMN="formViewColumn",e.GALLERY_VIEW="galleryView",e.GALLERY_VIEW_COLUMN="galleryViewColumn",e.GRID_VIEW="gridView",e.GRID_VIEW_COLUMN="gridViewColumn",e.KANBAN_VIEW="kanbanView",e.CALENDAR_VIEW="calendarView",e.CALENDAR_VIEW_COLUMN="calendarViewColumn",e.CALENDAR_VIEW_RANGE="calendarViewRange",e.MAP_VIEW="mapView",e.MAP_VIEW_COLUMN="mapViewColumn",e.KANBAN_VIEW_COLUMN="kanbanViewColumn",e.USER="user",e.ORGS_OLD="orgs",e.TEAM="team",e.TEAM_USER="teamUser",e.VIEW="view",e.AUDIT="audit",e.HOOK="hook",e.PLUGIN="plugin",e.BASE_USER="baseUser",e.MODEL_ROLE_VISIBILITY="modelRoleVisibility",e.API_TOKEN="apiToken",e.INSTANCE_META="instanceMeta",e.USER_BASE="userBase",e.DASHBOARD_PROJECT_DB_PROJECT_LINKING="dashboardProjectDBProjectLinking",e.SINGLE_QUERY="singleQuery",e.JOBS="nc_jobs",e.JOBS_POLLING="nc_jobs_polling",e.PRESIGNED_URL="presignedUrl",e.STORE="store",e.PROJECT_ALIAS="baseAlias",e.MODEL_ALIAS="modelAlias",e.VIEW_ALIAS="viewAlias",e.SSO_CLIENT="ssoClient",e.EXTENSION="uiExtension",e.INTEGRATION="integration",e.COL_BUTTON="colButton",e.CMD_PALETTE="cmdPalette",e.PRODUCT_FEED="productFeed"}(s||(t.CacheScope=s={})),function(e){e.TYPE_ARRAY="TYPE_ARRAY",e.TYPE_OBJECT="TYPE_OBJECT",e.TYPE_STRING="TYPE_STRING"}(i||(t.CacheGetType=i={})),function(e){e.PARENT_TO_CHILD="PARENT_TO_CHILD",e.CHILD_TO_PARENT="CHILD_TO_PARENT"}(r||(t.CacheDelDirection=r={})),t.GROUPBY_COMPARISON_OPS=["gb_eq","gb_null"],t.COMPARISON_OPS=["eq","neq","not","like","nlike","empty","notempty","null","notnull","checked","notchecked","blank","notblank","allof","anyof","nallof","nanyof","gt","lt","gte","lte","ge","le","in","isnot","is","isWithin","btw","nbtw"],t.IS_WITHIN_COMPARISON_SUB_OPS=["pastWeek","pastMonth","pastYear","nextWeek","nextMonth","nextYear","pastNumberOfDays","nextNumberOfDays"],t.COMPARISON_SUB_OPS=["today","tomorrow","yesterday","oneWeekAgo","oneWeekFromNow","oneMonthAgo","oneMonthFromNow","daysAgo","daysFromNow","exactDate",...t.IS_WITHIN_COMPARISON_SUB_OPS],t.DB_TYPES=["mysql2","sqlite3","mysql","mssql","snowflake","oracledb","pg","databricks"],function(e){e.ROOT="root",e.ORG="org",e.WORKSPACE="workspace",e.BASE="base",e.BYPASS="bypass"}(c||(t.RootScopes=c={})),t.RootScopeTables={[c.ROOT]:[a.USERS,a.USER_REFRESH_TOKENS,a.API_TOKENS,a.PLUGIN,a.STORE,a.NOTIFICATION,a.JOBS,a.FILE_REFERENCES,a.AUDIT],[c.BASE]:[a.PROJECT],[c.WORKSPACE]:[a.INTEGRATIONS]}},445:function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var s=Object.getOwnPropertyDescriptor(t,a);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,s)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),s=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.isEE=t.T=void 0,s(a(9052),t),s(a(2163),t),s(a(9372),t),s(a(8138),t),s(a(6789),t);var i=a(8945);Object.defineProperty(t,"T",{enumerable:!0,get:function(){return i.Tele}}),s(a(2397),t),s(a(9191),t),t.isEE=!1},7903:(e,t)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.DriverClient=t.knownQueryParams=t.avoidSSL=t.defaultConnectionOptions=t.defaultConnectionConfig=t.defaultClientPortMapping=t.driverClientMapping=void 0,t.driverClientMapping={mysql:"mysql2",mariadb:"mysql2",postgres:"pg",postgresql:"pg",sqlite:"sqlite3",mssql:"mssql"},t.defaultClientPortMapping={mysql:3306,mysql2:3306,postgres:5432,pg:5432,mssql:1433},t.defaultConnectionConfig={dateStrings:!0},t.defaultConnectionOptions={pool:{min:0,max:10}},t.avoidSSL=["localhost","127.0.0.1","host.docker.internal","172.17.0.1"],t.knownQueryParams=[{parameter:"database",aliases:["d","db"]},{parameter:"password",aliases:["p"]},{parameter:"user",aliases:["u"]},{parameter:"title",aliases:["t"]},{parameter:"keyFilePath",aliases:[]},{parameter:"certFilePath",aliases:[]},{parameter:"caFilePath",aliases:[]},{parameter:"ssl",aliases:[]},{parameter:"options",aliases:["opt","opts"]}],function(e){e.MYSQL="mysql2",e.MYSQL_LEGACY="mysql",e.MSSQL="mssql",e.PG="pg",e.SQLITE="sqlite3",e.SNOWFLAKE="snowflake",e.DATABRICKS="databricks"}(a||(t.DriverClient=a={}))},4775:function(e,t,a){"use strict";var n=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(a[n[s]]=e[n[s]])}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.metaUrlToDbConfig=t.xcUrlToDbConfig=t.jdbcToXcUrl=t.jdbcToXcConfig=t.getToolDir=t.prepareEnv=void 0;const i=s(a(9896)),r=a(7016),c=a(9023),o=s(a(4587)),l=a(7903),u=a(7196);function d(e){e.replace(/^jdbc:/,"");const t=(0,o.default)(e),a={};for(const[e,n]of Object.entries(t)){const t=l.knownQueryParams.find((t=>t.parameter===e||t.aliases.includes(e)));t?a[t.parameter]=n:a[e]=n}(null==a?void 0:a.port)||(a.port=l.defaultClientPortMapping[l.driverClientMapping[a.driver]||a.driver]);const{driver:s,host:i,port:r,database:c,user:u,password:d}=a,m=n(a,["driver","host","port","database","user","password"]),p=[];for(const[e,t]of Object.entries(m))p.push(`${e}=${encodeURIComponent(t+"")}`);return`${l.driverClientMapping[s]||s}://${i}${r?`:${r}`:""}?${u?`u=${encodeURIComponent(u)}&`:""}${d?`p=${encodeURIComponent(d)}&`:""}${c?`d=${encodeURIComponent(c)}&`:""}${p.join("&")}`}t.prepareEnv=async function({databaseUrlFile:e=process.env.NC_DATABASE_URL_FILE||process.env.DATABASE_URL_FILE,databaseUrl:t=process.env.NC_DATABASE_URL||process.env.DATABASE_URL}={}){if(e){const t=await(0,c.promisify)(i.default.readFile)(e,"utf-8");process.env.NC_DB=d(t)}else t&&(process.env.NC_DB=d(t))},t.getToolDir=function(){return process.env.NC_TOOL_DIR||process.cwd()},t.jdbcToXcConfig=function(e){e.replace(/^jdbc:/,"");const t=(0,o.default)(e),a={};for(const[e,n]of Object.entries(t)){const t=l.knownQueryParams.find((t=>t.parameter===e||t.aliases.includes(e)));t?a[t.parameter]=n:a[e]=n}(null==a?void 0:a.port)||(a.port=l.defaultClientPortMapping[l.driverClientMapping[a.driver]||a.driver]);const{driver:s}=a,i=n(a,["driver"]),r=l.driverClientMapping[s]||s;return"pg"!==r||(null==i?void 0:i.ssl)||l.avoidSSL.includes(i.host)||(i.ssl=!0),{client:r,connection:Object.assign({},i)}},t.jdbcToXcUrl=d,t.xcUrlToDbConfig=function(e,t="",a){const n=new r.URL(e);let s;if(n.protocol.startsWith("sqlite3"))s={client:"sqlite3",connection:{client:"sqlite3",connection:{filename:n.searchParams.get("d")||n.searchParams.get("database")},database:n.searchParams.get("d")||n.searchParams.get("database")}};else{const e={};for(const[t,a]of n.searchParams.entries()){const n=l.knownQueryParams.find((e=>e.parameter===t||e.aliases.includes(t)));n?e[n.parameter]=a:e[t]=a}s={client:n.protocol.replace(":",""),connection:Object.assign(Object.assign({},e),{host:n.hostname,port:+n.port}),acquireConnectionTimeout:6e5},process.env.NODE_TLS_REJECT_UNAUTHORIZED&&(s.connection.ssl=!0),n.searchParams.get("keyFilePath")&&n.searchParams.get("certFilePath")&&n.searchParams.get("caFilePath")&&(s.connection.ssl={keyFilePath:n.searchParams.get("keyFilePath"),certFilePath:n.searchParams.get("certFilePath"),caFilePath:n.searchParams.get("caFilePath")})}return Object.assign(s,{meta:{tn:"nc_evolutions",allSchemas:!!n.searchParams.get("allSchemas")||!(n.searchParams.get("d")||n.searchParams.get("database")),api:{prefix:n.searchParams.get("apiPrefix")||"",swagger:!0,type:a||n.searchParams.get("api")||n.searchParams.get("a")||"rest"},dbAlias:n.searchParams.get("dbAlias")||`db${t}`,metaTables:"db",migrations:{disabled:!1,name:"nc_evolutions"}}}),s},t.metaUrlToDbConfig=async function(e){var t,a;const n=new r.URL(e);let s;if(n.protocol.startsWith("sqlite3")){const e=n.searchParams.get("d")||n.searchParams.get("database");s=Object.assign({client:u.DriverClient.SQLITE,connection:{filename:e}},":memory:"===e?{pool:{min:1,max:1,idleTimeoutMillis:36e7}}:{})}else{const e={};for(const[t,a]of n.searchParams.entries()){const n=l.knownQueryParams.find((e=>e.parameter===t||e.aliases.includes(t)));n?e[n.parameter]=a:e[t]=a}s=Object.assign(Object.assign({client:n.protocol.replace(":",""),connection:Object.assign(Object.assign(Object.assign({},l.defaultConnectionConfig),e),{host:n.hostname,port:+n.port}),acquireConnectionTimeout:6e5},l.defaultConnectionOptions),n.searchParams.has("search_path")?{searchPath:n.searchParams.get("search_path").split(",")}:{}),process.env.NODE_TLS_REJECT_UNAUTHORIZED&&(s.connection.ssl=!0)}return n.searchParams.forEach(((e,t)=>{let a=e;"true"===a?a=!0:"false"===a?a=!1:/^\d+$/.test(a)&&(a=+a),["password","p","database","d","user","u","search_path"].includes(t)||t.split(".").reduce(((e,t,n,s)=>e[t]=n===s.length-1?a:e[t]||{}),s)})),(null===(t=null==s?void 0:s.connection)||void 0===t?void 0:t.ssl)&&"object"==typeof(null===(a=null==s?void 0:s.connection)||void 0===a?void 0:a.ssl)&&(s.connection.ssl.caFilePath&&!s.connection.ssl.ca&&(s.connection.ssl.ca=(await(0,c.promisify)(i.default.readFile)(s.connection.ssl.caFilePath)).toString(),delete s.connection.ssl.caFilePath),s.connection.ssl.keyFilePath&&!s.connection.ssl.key&&(s.connection.ssl.key=(await(0,c.promisify)(i.default.readFile)(s.connection.ssl.keyFilePath)).toString(),delete s.connection.ssl.keyFilePath),s.connection.ssl.certFilePath&&!s.connection.ssl.cert&&(s.connection.ssl.cert=(await(0,c.promisify)(i.default.readFile)(s.connection.ssl.certFilePath)).toString(),delete s.connection.ssl.certFilePath)),s}},7196:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DriverClient=void 0;const n=a(7903);Object.defineProperty(t,"DriverClient",{enumerable:!0,get:function(){return n.DriverClient}})},6789:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nocoExecute=void 0;const n=new(a(3563).Logger)("nocoExecute"),s=e=>Array.isArray(e)?e.flatMap((e=>s(e))):e,i=async(e,t,a={},r=null)=>{var c;if(Array.isArray(t))return Promise.all(t.map(((t,n)=>i(e,t,a[n]=a[n]||{},r))));const o={},l=(e,t,a={},n={})=>{var s,i,r,c,o;if(e.length){const u=e[0];return void 0===t[u]||null===t[u]?"function"==typeof a[u]?t[e[0]]=a[u](n):"object"==typeof a[u]?t[e[0]]=Promise.resolve(a[u]):(null===(i=null===(s=null==t?void 0:t.__proto__)||void 0===s?void 0:s.__columnAliases)||void 0===i?void 0:i[e[0]])?t[e[0]]=l(null===(o=null===(c=null===(r=null==t?void 0:t.__proto__)||void 0===r?void 0:r.__columnAliases)||void 0===c?void 0:c[e[0]])||void 0===o?void 0:o.path,t,{},n):"object"==typeof t&&(t[e[0]]=Promise.resolve(a[u])):"function"==typeof t[u]&&(t.__proto__=Object.assign(Object.assign({},t.__proto__),{[u]:t[u](n)})),(t[e[0]]instanceof Promise?t[e[0]]:Promise.resolve(t[e[0]])).then((t=>Array.isArray(t)?Promise.all(t.map((t=>l(e.slice(1),t,{},n)))):null!=t?l(e.slice(1),t,{},n):Promise.resolve(null)))}return Promise.resolve(t)};function u(e,i){var r,c,u,d,m,p;if(null===(c=null===(r=null==t?void 0:t.__proto__)||void 0===r?void 0:r.__columnAliases)||void 0===c?void 0:c[e])o[e]=l(null===(m=null===(d=null===(u=null==t?void 0:t.__proto__)||void 0===u?void 0:u.__columnAliases)||void 0===d?void 0:d[e])||void 0===m?void 0:m.path,a,t,null===(p=null==i?void 0:i.nested)||void 0===p?void 0:p[e]).then((e=>Promise.resolve(Array.isArray(e)?s(e):e)));else{if(t)if("function"==typeof t[e])o[e]=t[e](i);else if("object"==typeof t[e])o[e]=Promise.resolve(t[e]);else try{o[e]=Promise.resolve(t[e])}catch(e){n.error(e)}a[e]=o[e]}}const d=e&&"object"==typeof e?Object.keys(e).filter((t=>e[t])):Object.keys(t),m={},p=[];for(const t of d)u(t,null===(c=null==r?void 0:r.nested)||void 0===c?void 0:c[t]),e[t]&&"object"==typeof e[t]&&(o[t]=o[t].then((n=>{var s;return Array.isArray(n)?a[t]=Promise.all(n.map(((n,s)=>{var c,o;return i(e[t],n,null===(c=null==a?void 0:a[t])||void 0===c?void 0:c[s],null===(o=null==r?void 0:r.nested)||void 0===o?void 0:o[t])}))):n?a[t]=i(e[t],n,a[t],null===(s=null==r?void 0:r.nested)||void 0===s?void 0:s[t]):n}))),o[t]&&p.push((async()=>{m[t]=await o[t]})());return await Promise.all(p),m};t.nocoExecute=i},2397:function(e,t,a){"use strict";var n,s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.packageInfo=t.packageVersion=void 0;const i=s(a(9896)),r=s(a(6928));let c={};t.packageInfo=c;try{t.packageInfo=c=JSON.parse(i.default.readFileSync(r.default.join(process.cwd(),"node_modules","nocodb","package.json"),"utf8"))}catch(e){try{t.packageInfo=c=JSON.parse(i.default.readFileSync(r.default.join(r.default.dirname(null===(n=process.pkg)||void 0===n?void 0:n.defaultEntrypoint),"node_modules","nocodb","package.json"),"utf8"))}catch(e){try{t.packageInfo=c=JSON.parse(i.default.readFileSync(r.default.join(process.cwd(),"package.json"),"utf8"))}catch(e){}}}const o=null==c?void 0:c.version;t.packageVersion=o},2163:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitiseUserObj=void 0;const a=new Set(["password","salt","invite_token","invite_token_expires","reset_password_expires","reset_password_token","email_verification_token","created_at","updated_at"]);t.sanitiseUserObj=function(e){return Object.entries(e).reduce(((e,[t,n])=>(a.has(t)||(e[t]=n),e)),{})}},8945:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Tele=void 0;const s=n(a(857)),i=n(a(5833)),r=a(1072),c=n(a(8938)),o=n(a(9731)),l=a(2397),u=n(a(1141)),d=a(445),m=!!process.env.NC_DISABLE_TELE,p=!!process.env.NC_REDIS_URL,h=!!process.env.NC_BINARY_BUILD,g=!!(process.env.LITESTREAM_S3_BUCKET&&process.env.LITESTREAM_S3_SECRET_ACCESS_KEY&&process.env.LITESTREAM_S3_ACCESS_KEY_ID),f=()=>{try{const e=Math.round(process.uptime()/3600);b.emit("evt",{evt_type:"alive",count:global.NC_COUNT,upTime:e,cache:p,litestream:g,executable:h})}catch(e){}};setInterval(f,288e5);class b{static emit(e,t){try{this._init(),b.emitter.emit(e,t)}catch(e){}}static init(e){b.config=e,b._init()}static page(e){this.emit("page",e)}static event(e){this.emit("ph_event",e)}static _init(){try{if(!b.emitter){b.emitter=new i.default,b.machineId=(0,r.machineIdSync)();let e="",t="";t=process.env.NC_SERVER_UUID,e=l.packageVersion;const a={package_id:e,os_type:s.default.type(),os_platform:s.default.platform(),os_release:s.default.release(),node_version:process.version,docker:(0,o.default)(),xc_version:t,env:process.env.NODE_ENV||"production",oneClick:!!process.env.NC_ONE_CLICK};a.machine_id=`${(0,r.machineIdSync)()},,`,b.emitter.on("evt_app_started",(async e=>{try{if(await E(a),m)return;e&&void 0!==e.count&&(global.NC_COUNT=e.count),await c.default.post("https://telemetry.nocodb.com/api/v1/telemetry",Object.assign(Object.assign({},a),{evt_type:"started",payload:{count:global.NC_COUNT}}))}catch(e){}finally{f()}})),b.emitter.on("evt",(async e=>{try{const t=await b.getInstanceMeta()||{};if(await E(a),e.check&&(a.machine_id=`${(0,r.machineIdSync)()},,`),m&&(!e.evt_type||!e.evt_type.startsWith("a:sync-request:")))return;"project:invite"===e.evt_type&&(global.NC_COUNT=e.count||global.NC_COUNT),"user:first_signup"===e.evt_type&&(global.NC_COUNT=+global.NC_COUNT||1),await c.default.post("https://telemetry.nocodb.com/api/v1/telemetry",Object.assign(Object.assign({},a),{evt_type:e.evt_type,payload:Object.assign(Object.assign({},t),e||{})}))}catch(e){}})),b.emitter.on("evt_api_created",(async e=>{try{await E(a);const t=Object.assign(Object.assign({},a),{table_count:e.tablesCount||0,relation_count:e.relationsCount||0,view_count:e.viewsCount||0,api_count:e.apiCount||0,function_count:e.functionsCount||0,procedure_count:e.proceduresCount||0,mysql:"mysql2"===e.dbType?1:0,pg:"pg"===e.dbType?1:0,mssql:"mssql"===e.dbType?1:0,sqlite3:"sqlite3"===e.dbType?1:0,oracledb:"oracledb"===e.dbType?1:0,rest:"rest"===e.type?1:0,graphql:"graphql"===e.type?1:0,grpc:"grpc"===e.type?1:0,time_taken:e.timeTaken});if(m)return;await c.default.post("https://telemetry.nocodb.com/api/v1/telemetry/apis_created",t)}catch(e){}})),b.emitter.on("evt_subscribe",(async e=>{try{if(m)return;await c.default.post("https://telemetry.nocodb.com/api/v1/newsletter/sdhjh34u3yuy34bj343jhj4iwolaAdsdj3434uiut4nn",{email:e})}catch(e){}})),b.emitter.on("page",(async e=>{try{if(m)return;const t=await b.getInstanceMeta();await this.client.capture({distinctId:e.id||`${this.machineId}:public`,event:"$pageview",properties:Object.assign(Object.assign(Object.assign({},a),t),{$current_url:e.path})})}catch(e){}})),b.emitter.on("ph_event",(async e=>{try{if(m&&(!e.evt_type||!e.evt_type.startsWith("a:sync-request:")))return;const t=await this.getInstanceMeta();let n=e.id;n||(n=e.event&&e.event.startsWith("a:api:")?this.machineId:`${this.machineId}:public`),await this.client.capture({distinctId:n,event:e.event,properties:Object.assign(Object.assign(Object.assign({},a),t),e.data||{})})}catch(e){}}))}}catch(e){}try{this.client||(this.client=new u.default)}catch(e){}}static async getInstanceMeta(){try{return b.config&&b.config.instance&&await b.config.instance()||{}}catch(e){return{}}}static get id(){return this.machineId||(0,r.machineIdSync)()}static async payload(){if("test"===process.env.NODE_ENV||"development"===process.env.NODE_ENV||d.isEE)return null;const e={package_id:l.packageVersion,node_version:process.version,xc_version:process.env.NC_SERVER_UUID,env:process.env.NODE_ENV||"production",oneClick:!!process.env.NC_ONE_CLICK};try{e.os_type=s.default.type(),e.os_platform=s.default.platform(),e.os_release=s.default.release(),e.docker=(0,o.default)(),e.machine_id=`${this.id},,`,e.payload=Object.assign(Object.assign({},await b.getInstanceMeta()||{}),{count:global.NC_COUNT,upTime:Math.round(process.uptime()/3600),cache:p,litestream:g,executable:h})}catch(e){}return e}}async function E(e){let t=5;for(;t--&&!e.machine_id;)await new Promise((e=>setTimeout((()=>e(null)),500)))}if(t.Tele=b,process.env.NC_PUBLIC_URL&&setInterval((()=>{(0,c.default)({method:"get",url:process.env.NC_PUBLIC_URL}).then((()=>{})).catch((()=>{}))}),72e5),process.env.NC_ONE_CLICK)try{b.emit("evt",{evt_type:"ONE_CLICK"})}catch(e){}},2678:(e,t,a)=>{"use strict";var n,s,i;a.r(t),a.d(t,{APIContext:()=>mt,AllAggregations:()=>Qt,AllowedColumnTypesForQrAndBarcodes:()=>Je,Api:()=>p,AppEvents:()=>Ze,AttachmentAggregations:()=>Yt,AttachmentValidationType:()=>Ht,AuditOperationSubTypes:()=>Oe,AuditOperationTypes:()=>Te,BooleanAggregations:()=>Jt,ClickhouseTables:()=>et,ClientType:()=>ht,CloudOrgUserRoles:()=>Qe,CommonAggregations:()=>Vt,ContentType:()=>c,CustomAPI:()=>Dt,DateAggregations:()=>Kt,DateValidationType:()=>jt,ExportTypes:()=>_e,FieldNameFromUITypes:()=>qe,FormulaDataTypes:()=>le,FormulaError:()=>he,FormulaErrorType:()=>oe,GenericValidationType:()=>Ut,HttpClient:()=>m,IntegrationCategoryType:()=>bt,IntegrationsType:()=>r,JSEPNode:()=>ue,ModelTypes:()=>Re,MssqlUi:()=>O,MysqlUi:()=>y,NcDataErrorCodes:()=>Ie,NcErrorType:()=>Le,NumberValidationType:()=>Pt,NumericalAggregations:()=>Wt,OracleUi:()=>N,OrderedOrgRoles:()=>lt,OrderedProjectRoles:()=>ut,OrderedWorkspaceRoles:()=>ot,OrgUserRoles:()=>Ke,PgUi:()=>T,PlanLimitTypes:()=>dt,PluginCategory:()=>Ae,ProjectRoles:()=>Xe,ProjectStatus:()=>we,ProjectTypes:()=>Ee,RelationTypes:()=>ye,RoleColors:()=>st,RoleDescriptions:()=>it,RoleIcons:()=>rt,RoleLabels:()=>nt,SSLUsage:()=>gt,SelectValidationType:()=>Gt,SnowflakeUi:()=>S,SourceRestriction:()=>pt,SqlUiFactory:()=>L,SqliteUi:()=>R,StringValidationType:()=>Mt,SyncDataType:()=>ft,TemplateGenerator:()=>$t,TimeValidationType:()=>kt,TiptapMarksTypes:()=>ve,TiptapNodesTypes:()=>Se,UITypes:()=>Be,UITypesName:()=>$e,ViewTypes:()=>be,WorkspacePlan:()=>at,WorkspaceRolesToProjectRoles:()=>ct,WorkspaceStatus:()=>tt,WorkspaceUserRoles:()=>ze,XcActionType:()=>s,XcNotificationType:()=>i,XcType:()=>n,YearValidationType:()=>Ft,auditOperationSubTypeLabels:()=>Ne,auditOperationTypeLabels:()=>Ce,convertToTargetFormat:()=>Z,dateFormats:()=>V,dateMonthFormats:()=>B,extractRolesObj:()=>Ot,filterOutSystemColumns:()=>Et,formulas:()=>pe,getAvailableAggregations:()=>Xt,getAvailableRollupForUiType:()=>At,getDateFormat:()=>K,getDateTimeFormat:()=>Q,getEquivalentUIType:()=>Ge,getRenderAsTextFunForUiType:()=>Rt,getSystemColumns:()=>_t,getSystemColumnsIds:()=>yt,getTestDatabaseName:()=>Lt,getUITypesForFormulaDataType:()=>Ye,handleTZ:()=>ee,isCreatedOrLastModifiedByCol:()=>je,isCreatedOrLastModifiedTimeCol:()=>Pe,isDateMonthFormat:()=>Y,isHiddenCol:()=>ke,isLinksOrLTAR:()=>Fe,isNumericCol:()=>Ue,isSelectTypeCol:()=>He,isSelfReferencingTableColumn:()=>Ct,isSystemColumn:()=>Tt,isValidTimeFormat:()=>ne,isVirtualCol:()=>Me,jsepCurlyHook:()=>ie,jsepTreeToFormula:()=>me,mergeSwaggerSchema:()=>xt,numericUITypes:()=>xe,oppositeValidationTypeMap:()=>Bt,parseStringDate:()=>X,parseStringDateTime:()=>z,partialUpdateAllowedTypes:()=>Ve,populateUniqueFileName:()=>St,readonlyMetaAllowedTypes:()=>We,roundUpToPrecision:()=>vt,stringifyRolesObj:()=>Nt,substituteColumnAliasWithIdInFormula:()=>ce,substituteColumnIdWithAliasInFormula:()=>de,timeAgo:()=>ae,timeFormats:()=>W,validateAndExtractSSLProp:()=>zt,validateDateFormat:()=>te,validateDateWithUnknownFormat:()=>J,validateFormulaAndExtractTreeWithType:()=>fe,validatePassword:()=>qt}),function(e){e.ID="ID",e.ForeignKey="ForeignKey",e.SingleLineText="SingleLineText",e.LongText="LongText",e.Attachment="Attachment",e.Checkbox="Checkbox",e.MultiSelect="MultiSelect",e.SingleSelect="SingleSelect",e.Collaborator="Collaborator",e.Date="Date",e.Year="Year",e.Time="Time",e.PhoneNumber="PhoneNumber",e.Email="Email",e.URL="URL",e.Number="Number",e.Decimal="Decimal",e.Currency="Currency",e.Percent="Percent",e.Duration="Duration",e.Rating="Rating",e.Formula="Formula",e.Rollup="Rollup",e.Count="Count",e.Lookup="Lookup",e.DateTime="DateTime",e.CreateTime="CreateTime",e.LastModifiedTime="LastModifiedTime",e.AutoNumber="AutoNumber",e.Barcode="Barcode",e.Button="Button",e.Password="Password"}(n||(n={})),function(e){e.SUBMIT="SUBMIT",e.TEST="TEST",e.CLEAR="CLEAR",e.CANCEL="CANCEL"}(s||(s={})),function(e){e.EMAIL="Email",e.URL="URL",e.DISCORD="Discord",e.TELEGRAM="Telegram",e.SLACK="Slack",e.WHATSAPP="Whatsapp",e.TWILIO="Twilio"}(i||(i={}));var r,c,o=a(8938),l=a.n(o),u=function(e,t,a,n){return new(a||(a=Promise))((function(s,i){function r(e){try{o(n.next(e))}catch(e){i(e)}}function c(e){try{o(n.throw(e))}catch(e){i(e)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,c)}o((n=n.apply(e,t||[])).next())}))},d=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(a[n[s]]=e[n[s]])}return a};!function(e){e.Database="database"}(r||(r={})),function(e){e.Json="application/json",e.FormData="multipart/form-data",e.UrlEncoded="application/x-www-form-urlencoded",e.Text="text/plain"}(c||(c={}));class m{constructor(e={}){var{securityWorker:t,secure:a,format:n}=e,s=d(e,["securityWorker","secure","format"]);this.securityData=null,this.setSecurityData=e=>{this.securityData=e},this.request=e=>u(this,void 0,void 0,(function*(){var{secure:t,path:a,type:n,query:s,format:i,wrapped:r,body:o}=e,l=d(e,["secure","path","type","query","format","wrapped","body"]);const u=("boolean"==typeof t?t:this.secure)&&this.securityWorker&&(yield this.securityWorker(this.securityData))||{},m=this.mergeRequestParams(l,u),p=i||this.format||void 0;return n===c.FormData&&o&&null!==o&&"object"==typeof o&&(o=this.createFormData(o)),n===c.Text&&o&&null!==o&&"string"!=typeof o&&(o=JSON.stringify(o)),this.instance.request(Object.assign(Object.assign({},m),{headers:Object.assign(Object.assign({},m.headers||{}),n&&n!==c.FormData?{"Content-Type":n}:{}),params:s,responseType:p,data:o,url:a})).then((e=>r?e:e.data))})),this.instance=l().create(Object.assign(Object.assign({},s),{baseURL:s.baseURL||"http://localhost:8080"})),this.secure=a,this.format=n,this.securityWorker=t}mergeRequestParams(e,t){const a=e.method||t&&t.method;return Object.assign(Object.assign(Object.assign(Object.assign({},this.instance.defaults),e),t||{}),{headers:Object.assign(Object.assign(Object.assign({},a&&this.instance.defaults.headers[a.toLowerCase()]||{}),e.headers||{}),t&&t.headers||{})})}stringifyFormItem(e){return"object"==typeof e&&null!==e?JSON.stringify(e):`${e}`}createFormData(e){return Object.keys(e||{}).reduce(((t,a)=>{const n=e[a],s=n instanceof Array?n:[n];for(const e of s){const n=e instanceof Blob||e instanceof File;t.append(a,n?e:this.stringifyFormItem(e))}return t}),new FormData)}}class p extends m{constructor(){super(...arguments),this.userProfile={update:(e,t={})=>this.request(Object.assign({path:"/api/v1/user/profile",method:"PATCH",body:e,type:c.Json},t))},this.auth={signup:(e,t={})=>this.request(Object.assign({path:"/api/v1/auth/user/signup",method:"POST",body:e,type:c.Json,format:"json"},t)),signout:(e={})=>this.request(Object.assign({path:"/api/v1/auth/user/signout",method:"POST",format:"json"},e)),signin:(e,t={})=>this.request(Object.assign({path:"/api/v1/auth/user/signin",method:"POST",body:e,type:c.Json,format:"json"},t)),me:(e,t={})=>this.request(Object.assign({path:"/api/v1/auth/user/me",method:"GET",query:e,format:"json"},t)),passwordForgot:(e,t={})=>this.request(Object.assign({path:"/api/v1/auth/password/forgot",method:"POST",body:e,type:c.Json,format:"json"},t)),passwordChange:(e,t={})=>this.request(Object.assign({path:"/api/v1/auth/password/change",method:"POST",body:e,type:c.Json,format:"json"},t)),passwordResetTokenValidate:(e,t={})=>this.request(Object.assign({path:`/api/v1/auth/token/validate/${e}`,method:"POST",format:"json"},t)),emailValidate:(e,t={})=>this.request(Object.assign({path:`/api/v1/auth/email/validate/${e}`,method:"POST",format:"json"},t)),passwordReset:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/auth/password/reset/${e}`,method:"POST",body:t,type:c.Json,format:"json"},a)),tokenRefresh:(e={})=>this.request(Object.assign({path:"/api/v1/auth/token/refresh",method:"POST",format:"json"},e)),baseUserList:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/users`,method:"GET",format:"json"},t)),baseUserAdd:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/users`,method:"POST",body:t,type:c.Json,format:"json"},a)),baseUserUpdate:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/users/${t}`,method:"PATCH",body:a,type:c.Json,format:"json"},n)),baseUserRemove:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/users/${t}`,method:"DELETE",format:"json"},a)),baseUserResendInvite:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/users/${t}/resend-invite`,method:"POST",format:"json"},a))},this.orgTokens={list:(e={})=>this.request(Object.assign({path:"/api/v1/tokens",method:"GET",format:"json"},e)),create:(e,t={})=>this.request(Object.assign({path:"/api/v1/tokens",method:"POST",body:e,type:c.Json,format:"json"},t)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/tokens/${e}`,method:"DELETE",format:"json"},t))},this.orgLicense={get:(e={})=>this.request(Object.assign({path:"/api/v1/license",method:"GET",format:"json"},e)),set:(e,t={})=>this.request(Object.assign({path:"/api/v1/license",method:"POST",body:e,type:c.Json,format:"json"},t))},this.orgAppSettings={get:(e={})=>this.request(Object.assign({path:"/api/v1/app-settings",method:"GET",format:"json"},e)),set:(e,t={})=>this.request(Object.assign({path:"/api/v1/app-settings",method:"POST",body:e,type:c.Json,format:"json"},t))},this.orgUsers={list:(e={})=>this.request(Object.assign({path:"/api/v1/users",method:"GET",format:"json"},e)),add:(e,t={})=>this.request(Object.assign({path:"/api/v1/users",method:"POST",body:e,type:c.Json,format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/users/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/users/${e}`,method:"DELETE",format:"json"},t)),getByUsername:(e,t={})=>this.request(Object.assign({path:`/api/v1/users/${e}`,method:"GET",format:"json"},t)),resendInvite:(e,t={})=>this.request(Object.assign({path:`/api/v1/users/${e}/resend-invite`,method:"POST",format:"json"},t)),profileCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/users/${e}/profile`,method:"POST",body:t,type:c.Json},a)),profileGet:(e,t={})=>this.request(Object.assign({path:`/api/v1/users/${e}/profile`,method:"GET"},t)),profileUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/users/${e}/profile`,method:"PATCH",body:t,type:c.Json},a)),followerCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/users/${e}/follower`,method:"POST",body:t,type:c.Json},a)),followerList:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/users/${e}/follower`,method:"GET",body:t,type:c.Json},a)),followerDelete:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/users/${e}/follower`,method:"DELETE",body:t,type:c.Json},a)),followingList:(e,t={})=>this.request(Object.assign({path:`/api/v1/users/${e}/following`,method:"GET"},t)),isFollowing:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/users/${e}/isFollowing/${t}`,method:"GET"},a)),generatePasswordResetToken:(e,t={})=>this.request(Object.assign({path:`/api/v1/users/${e}/generate-reset-url`,method:"POST",format:"json"},t))},this.base={metaGet:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/info`,method:"GET",format:"json"},t)),modelVisibilityList:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/visibility-rules`,method:"GET",query:t,format:"json"},a)),modelVisibilitySet:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/visibility-rules`,method:"POST",body:t,type:c.Json,format:"json"},a)),list:(e={})=>this.request(Object.assign({path:"/api/v1/db/meta/projects/",method:"GET",format:"json"},e)),create:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/projects/",method:"POST",body:e,type:c.Json,format:"json"},t)),sourceDuplicate:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/duplicate/${e}/${a}`,method:"POST",body:t,type:c.Json,format:"json"},n)),duplicate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/duplicate/${e}`,method:"POST",body:t,type:c.Json,format:"json"},a)),read:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}`,method:"GET",format:"json"},t)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}`,method:"DELETE",format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),userMetaUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/user`,method:"PATCH",body:t,type:c.Json},a)),sharedBaseGet:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/shared`,method:"GET",format:"json"},t)),sharedBaseDisable:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/shared`,method:"DELETE",format:"json"},t)),sharedBaseCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/shared`,method:"POST",body:t,type:c.Json,format:"json"},a)),sharedBaseUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/shared`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),cost:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/cost`,method:"GET",format:"json"},t)),metaDiffSync:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/meta-diff`,method:"POST",format:"json"},t)),metaDiffGet:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/meta-diff`,method:"GET",format:"json"},t)),hasEmptyOrNullFilters:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/has-empty-or-null-filters`,method:"GET",format:"json"},t)),auditList:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/audits`,method:"GET",query:t,format:"json"},a))},this.source={read:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/bases/${t}`,method:"GET",format:"json"},a)),delete:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/bases/${t}`,method:"DELETE",format:"json"},a)),update:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/bases/${t}`,method:"PATCH",body:a,type:c.Json,format:"json"},n)),list:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/bases/`,method:"GET",format:"json"},t)),create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/bases/`,method:"POST",body:t,type:c.Json,format:"json"},a)),shareErd:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/bases/${t}/share/erd`,method:"POST",format:"json"},a)),disableShareErd:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/bases/${t}/share/erd`,method:"DELETE"},a)),tableList:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/${t}/tables`,method:"GET",query:a},n)),tableCreate:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/${t}/tables`,method:"POST",body:a,type:c.Json,format:"json"},n)),metaDiffSync:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/meta-diff/${t}`,method:"POST",format:"json"},a)),metaDiffGet:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/meta-diff/${t}`,method:"GET",format:"json"},a))},this.dbTable={create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/tables`,method:"POST",body:t,type:c.Json,format:"json"},a)),list:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/tables`,method:"GET",query:t},a)),read:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}`,method:"GET",format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}`,method:"DELETE",format:"json"},t)),duplicate:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/duplicate/${e}/table/${t}`,method:"POST",body:a,type:c.Json,format:"json"},n)),duplicateColumn:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/duplicate/${e}/column/${t}`,method:"POST",body:a,type:c.Json,format:"json"},n)),reorder:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/reorder`,method:"POST",body:t,type:c.Json,format:"json"},a))},this.dbTableColumn={create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/columns`,method:"POST",body:t,type:c.Json},a)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/columns/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/columns/${e}`,method:"DELETE"},t)),get:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/columns/${e}`,method:"GET"},t)),primaryColumnSet:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/columns/${e}/primary`,method:"POST",format:"json"},t)),hash:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/columns/hash`,method:"GET",format:"json"},t)),bulk:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/columns/bulk`,method:"POST",body:t,type:c.Json,format:"json"},a))},this.dbView={list:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/views`,method:"GET",format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}`,method:"DELETE",format:"json"},t)),showAllColumn:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/show-all`,method:"POST",query:t,format:"json"},a)),hideAllColumn:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/hide-all`,method:"POST",query:t,format:"json"},a)),gridCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/grids`,method:"POST",body:t,type:c.Json,format:"json"},a)),formCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/forms`,method:"POST",body:t,type:c.Json,format:"json"},a)),formUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/forms/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),formRead:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/forms/${e}`,method:"GET",format:"json"},t)),formColumnUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/form-columns/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),gridUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/grids/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),gridColumnsList:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/grids/${e}/grid-columns`,method:"GET",format:"json"},t)),gridColumnUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/grid-columns/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),galleryCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/galleries`,method:"POST",body:t,type:c.Json,format:"json"},a)),galleryUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/galleries/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),galleryRead:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/galleries/${e}`,method:"GET",format:"json"},t)),kanbanCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/kanbans`,method:"POST",body:t,type:c.Json,format:"json"},a)),kanbanUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/kanbans/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),kanbanRead:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/kanbans/${e}`,method:"GET",format:"json"},t)),mapCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/maps`,method:"POST",body:t,type:c.Json,format:"json"},a)),mapUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/maps/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),mapRead:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/maps/${e}`,method:"GET",format:"json"},t)),calendarCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/calendars`,method:"POST",body:t,type:c.Json,format:"json"},a)),calendarUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/calendars/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),calendarRead:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/calendars/${e}`,method:"GET",format:"json"},t))},this.dbViewShare={list:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/share`,method:"GET",format:"json"},t)),create:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/share`,method:"POST",format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/share`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/share`,method:"DELETE",format:"json"},t))},this.dbViewColumn={list:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/columns`,method:"GET",format:"json"},t)),create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/columns`,method:"POST",body:t,type:c.Json,format:"json"},a)),update:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/columns/${t}`,method:"PATCH",body:a,type:c.Json,format:"json"},n))},this.dbTableSort={list:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/sorts`,method:"GET",format:"json"},t)),create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/sorts`,method:"POST",body:t,type:c.Json,format:"json"},a)),get:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/sorts/${e}`,method:"GET",format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/sorts/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/sorts/${e}`,method:"DELETE",format:"json"},t))},this.dbTableFilter={read:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/filters`,method:"GET",query:t,format:"json"},a)),create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/views/${e}/filters`,method:"POST",body:t,type:c.Json,format:"json"},a)),get:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/filters/${e}`,method:"GET",format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/filters/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/filters/${e}`,method:"DELETE",format:"json"},t)),childrenRead:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/filters/${e}/children`,method:"GET",format:"json"},t))},this.dbTableWebhookFilter={read:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/hooks/${e}/filters`,method:"GET",format:"json"},t)),create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/hooks/${e}/filters`,method:"POST",body:t,type:c.Json,format:"json"},a))},this.dbTableWebhookLogs={list:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/hooks/${e}/logs`,method:"GET",query:t,format:"json"},a))},this.dbTableRow={list:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}`,method:"GET",query:n,format:"json"},s)),create:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}`,method:"POST",body:n,type:c.Json,format:"json"},s)),findOne:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/find-one`,method:"GET",query:n,format:"json"},s)),groupBy:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/groupby`,method:"GET",query:n,format:"json"},s)),groupedDataList:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/group/${n}`,method:"GET",query:s,format:"json"},i)),read:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/${n}`,method:"GET",query:s,format:"json"},i)),update:(e,t,a,n,s,i,r={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/${n}`,method:"PATCH",query:i,body:s,type:c.Json,format:"json"},r)),delete:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/${n}`,method:"DELETE",query:s,format:"json"},i)),exist:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/${n}/exist`,method:"GET",format:"json"},s)),bulkCreate:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/bulk/${e}/${t}/${a}`,method:"POST",body:n,type:c.Json,format:"json"},s)),bulkUpdate:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/bulk/${e}/${t}/${a}`,method:"PATCH",body:n,type:c.Json,format:"json"},s)),bulkDelete:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/bulk/${e}/${t}/${a}`,method:"DELETE",body:n,type:c.Json,format:"json"},s)),bulkUpdateAll:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/bulk/${e}/${t}/${a}/all`,method:"PATCH",query:s,body:n,type:c.Json,format:"json"},i)),bulkDeleteAll:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/bulk/${e}/${t}/${a}/all`,method:"DELETE",query:s,body:n,type:c.Json,format:"json"},i)),csvExport:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/export/${n}`,method:"GET",wrapped:!0},s)),nestedList:(e,t,a,n,s,i,r,c={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/${n}/${s}/${i}`,method:"GET",query:r,format:"json"},c)),nestedAdd:(e,t,a,n,s,i,r,c,o={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/${n}/${s}/${i}/${r}`,method:"POST",query:c,format:"json"},o)),nestedRemove:(e,t,a,n,s,i,r,c={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/${n}/${s}/${i}/${r}`,method:"DELETE",format:"json"},c)),nestedChildrenExcludedList:(e,t,a,n,s,i,r,c={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/${n}/${s}/${i}/exclude`,method:"GET",query:r,format:"json"},c))},this.dbViewRow={groupedDataList:(e,t,a,n,s,i,r={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/group/${s}`,method:"GET",query:i,format:"json"},r)),list:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}`,method:"GET",query:s,format:"json"},i)),create:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}`,method:"POST",body:s,type:c.Json,format:"json"},i)),findOne:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/find-one`,method:"GET",query:s,format:"json"},i)),groupBy:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/groupby`,method:"GET",query:s,format:"json"},i)),count:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/count`,method:"GET",query:s,format:"json"},i)),read:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/${s}`,method:"GET",format:"json"},i)),update:(e,t,a,n,s,i,r={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/${s}`,method:"PATCH",body:i,type:c.Json,format:"json"},r)),delete:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/${s}`,method:"DELETE",format:"json"},i)),exist:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/${s}/exist`,method:"GET",format:"json"},i)),export:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/data/${e}/${t}/${a}/views/${n}/export/${s}`,method:"GET",wrapped:!0},i))},this.dbCalendarViewRow={list:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/calendar-data/${e}/${t}/${a}/views/${n}`,method:"GET",query:s},i)),publicDataCalendarRowList:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/public/calendar-view/${e}`,method:"GET",query:t},a))},this.api={responsesApi:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v1/db/calendar-data/${e}/${t}/${a}/views/${n}`,method:"RESPONSES"},s)),responsesApi2:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/public/calendar-view/${e}`,method:"RESPONSES"},t))},this.dbCalendarViewRowCount={dbCalendarViewRowCount:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/calendar-data/${e}/${t}/${a}/views/${n}/countByDate/`,method:"GET",query:s,format:"json"},i))},this.public={dataCalendarRowCount:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/public/calendar-view/${e}/countByDate`,method:"GET",query:t,format:"json"},a)),dataTableBulkDataList:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/public/shared-view/${e}/bulk/dataList`,method:"POST",query:a,body:t,type:c.Json,format:"json"},n)),dataTableBulkGroup:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/public/shared-view/${e}/bulk/group`,method:"POST",query:a,body:t,type:c.Json,format:"json"},n)),dataTableAggregate:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/public/shared-view/${e}/aggregate`,method:"GET",query:t,format:"json"},a)),dataAttachmentDownload:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v2/public/shared-view/${e}/downloadAttachment/${t}/${a}`,method:"GET",query:n,format:"json"},s)),groupedDataList:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-view/${e}/group/${t}`,method:"GET",query:a,format:"json"},n)),dataList:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-view/${e}/rows`,method:"GET",query:t,format:"json"},a)),dataCreate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-view/${e}/rows`,method:"POST",body:t,type:c.FormData,format:"json"},a)),dataGroupBy:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-view/${e}/groupby`,method:"GET",query:t,format:"json"},a)),dataNestedList:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-view/${e}/rows/${t}/${a}/${n}`,method:"GET",query:s,format:"json"},i)),csvExport:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-view/${e}/rows/export/${t}`,method:"GET",wrapped:!0},a)),dataRelationList:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-view/${e}/nested/${t}`,method:"GET",query:a,format:"json"},n)),sharedBaseGet:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-base/${e}/meta`,method:"GET",format:"json"},t)),sharedViewMetaGet:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-view/${e}/meta`,method:"GET",format:"json"},t)),sharedErdMetaGet:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/public/shared-erd/${e}/meta`,method:"GET"},t))},this.dbDataTableBulkList={dbDataTableBulkList:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/bulk/dataList`,method:"POST",query:t,body:a,type:c.Json,format:"json"},n))},this.dbDataTableBulkGroupList={dbDataTableBulkGroupList:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/bulk/group`,method:"POST",query:t,body:a,type:c.Json,format:"json"},n))},this.utils={auditList:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/audits",method:"GET",query:e,format:"json"},t)),commentList:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/comments",method:"GET",query:e,format:"json"},t)),commentRow:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/comments",method:"POST",body:e,type:c.Json,format:"json"},t)),commentUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/comment/${e}/`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),commentDelete:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/comment/${e}/`,method:"DELETE",body:t,format:"json"},a)),commentCount:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/comments/count",method:"GET",query:e,format:"json"},t)),projectAuditList:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/projects/audits",method:"GET",query:e,format:"json"},t)),auditRowUpdate:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/audits/rows/${e}/update`,method:"POST",body:t,type:c.Json,format:"json"},a)),testConnection:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/connection/test",method:"POST",body:e,type:c.Json,format:"json"},t)),urlToConfig:(e,t={})=>this.request(Object.assign({path:"/api/v1/url_to_config",method:"POST",body:e,type:c.Json,format:"json"},t)),appInfo:(e={})=>this.request(Object.assign({path:"/api/v1/db/meta/nocodb/info",method:"GET",format:"json"},e)),axiosRequestMake:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/axiosRequestMake",method:"POST",body:e,type:c.Json,format:"json"},t)),appVersion:(e={})=>this.request(Object.assign({path:"/api/v1/version",method:"GET",format:"json"},e)),appHealth:(e={})=>this.request(Object.assign({path:"/api/v1/health",method:"GET",format:"json"},e)),feed:(e,t={})=>this.request(Object.assign({path:"/api/v2/feed",method:"GET",query:e,format:"json"},t)),aggregatedMetaInfo:(e={})=>this.request(Object.assign({path:"/api/v1/aggregated-meta-info",method:"GET",format:"json"},e)),cacheGet:(e={})=>this.request(Object.assign({path:"/api/v1/db/meta/cache",method:"GET"},e)),cacheDelete:(e={})=>this.request(Object.assign({path:"/api/v1/db/meta/cache",method:"DELETE",format:"json"},e)),commandPalette:(e,t={})=>this.request(Object.assign({path:"/api/v1/command_palette",method:"POST",body:e,type:c.Json,format:"json"},t))},this.dbTableWebhook={list:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/hooks`,method:"GET",format:"json"},t)),create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/hooks`,method:"POST",body:t,type:c.Json,format:"json"},a)),test:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/hooks/test`,method:"POST",body:t,type:c.Json,format:"json"},a)),samplePayloadGet:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v1/db/meta/tables/${e}/hooks/samplePayload/${t}/${a}`,method:"GET",format:"json"},n)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/hooks/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/hooks/${e}`,method:"DELETE",format:"json"},t)),trigger:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/meta/hooks/${e}/trigger/${t}`,method:"POST"},a))},this.plugin={list:(e={})=>this.request(Object.assign({path:"/api/v1/db/meta/plugins",method:"GET",format:"json"},e)),webhookList:(e={})=>this.request(Object.assign({path:"/api/v1/db/meta/plugins/webhook",method:"GET",format:"json"},e)),status:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/plugins/${e}/status`,method:"GET",format:"json"},t)),test:(e,t={})=>this.request(Object.assign({path:"/api/v1/db/meta/plugins/test",method:"POST",body:e,type:c.Json,format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/plugins/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),read:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/plugins/${e}`,method:"GET",format:"json"},t))},this.apiToken={list:(e,t={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/api-tokens`,method:"GET",format:"json"},t)),create:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/api-tokens`,method:"POST",body:t,type:c.Json,format:"json"},a)),delete:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/db/meta/projects/${e}/api-tokens/${t}`,method:"DELETE",format:"json"},a))},this.storage={upload:(e,t,a={})=>this.request(Object.assign({path:"/api/v1/db/storage/upload",method:"POST",query:e,body:t,type:c.FormData},a)),uploadByUrl:(e,t,a={})=>this.request(Object.assign({path:"/api/v1/db/storage/upload-by-url",method:"POST",query:e,body:t,type:c.Json},a))},this.notification={poll:(e={})=>this.request(Object.assign({path:"/api/v1/notifications/poll",method:"GET",format:"json"},e)),list:(e,t={})=>this.request(Object.assign({path:"/api/v1/notifications",method:"GET",query:e,format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v1/notifications/${e}`,method:"PATCH",body:t,type:c.Json},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v1/notifications/${e}`,method:"DELETE"},t)),markAllAsRead:(e={})=>this.request(Object.assign({path:"/api/v1/notifications/mark-all-read",method:"POST"},e))},this.dbDataTableAggregate={dbDataTableAggregate:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/aggregate`,method:"GET",query:t,format:"json"},a))},this.dbDataTableRow={list:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/records`,method:"GET",query:t,format:"json"},a)),create:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/records`,method:"POST",query:a,body:t,type:c.Json,format:"json"},n)),update:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/records`,method:"PATCH",query:a,body:t,type:c.Json,format:"json"},n)),delete:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/records`,method:"DELETE",query:a,body:t,type:c.Json,format:"json"},n)),read:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/records/${t}`,method:"GET",query:a,format:"json"},n)),count:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/records/count`,method:"GET",query:t,format:"json"},a)),nestedList:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/links/${t}/records/${a}`,method:"GET",query:n,format:"json"},s)),nestedLink:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/links/${t}/records/${a}`,method:"POST",query:s,body:n,type:c.Json,format:"json"},i)),nestedUnlink:(e,t,a,n,s,i={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/links/${t}/records/${a}`,method:"DELETE",query:s,body:n,type:c.Json,format:"json"},i)),attachmentDownload:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v2/downloadAttachment/${e}/${t}/${a}`,method:"GET",query:n,format:"json"},s)),nestedListCopyPasteOrDeleteAll:(e,t,a,n,s={})=>this.request(Object.assign({path:`/api/v2/tables/${e}/links/${t}/records`,method:"POST",query:n,body:a,type:c.Json,format:"json"},s))},this.extensions={list:(e,t={})=>this.request(Object.assign({path:`/api/v2/extensions/${e}`,method:"GET",format:"json"},t)),create:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/extensions/${e}`,method:"POST",body:t,type:c.Json,format:"json"},a)),read:(e,t={})=>this.request(Object.assign({path:`/api/v2/extensions/${e}`,method:"GET",format:"json"},t)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/extensions/${e}`,method:"PATCH",body:t,type:c.Json,format:"json"},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v2/extensions/${e}`,method:"DELETE",format:"json"},t))},this.jobs={listen:(e,t={})=>this.request(Object.assign({path:"/jobs/listen",method:"POST",body:e,type:c.Json},t)),list:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/jobs/${e}`,method:"POST",body:t,type:c.Json},a))},this.export={data:(e,t,a,n={})=>this.request(Object.assign({path:`/api/v2/export/${e}/${t}`,method:"POST",body:a,type:c.Json},n))},this.integration={list:(e,t={})=>this.request(Object.assign({path:"/api/v2/meta/integrations",method:"GET",query:e,format:"json"},t)),create:(e,t={})=>this.request(Object.assign({path:"/api/v2/meta/integrations",method:"POST",body:e,type:c.Json,format:"json"},t)),read:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/meta/integrations/${e}`,method:"GET",query:t,format:"json"},a)),update:(e,t,a={})=>this.request(Object.assign({path:`/api/v2/meta/integrations/${e}`,method:"PATCH",body:t,type:c.Json},a)),delete:(e,t={})=>this.request(Object.assign({path:`/api/v2/meta/integrations/${e}`,method:"DELETE"},t))}}}const h=require("jsep");var g=a.n(h);const f=require("dayjs");var b=a.n(f);const E=["int","smallint","mediumint","bigint","bit","boolean","float","decimal","double","serial","tinyint","date","datetime","timestamp","time","year","char","varchar","nchar","text","tinytext","mediumtext","longtext","binary","varbinary","blob","tinyblob","mediumblob","longblob","enum","set","geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","json"];class y{static getNewTableColumns(){return[{column_name:"id",title:"Id",dt:"int",dtx:"integer",ct:"int(11)",nrqd:!1,rqd:!0,ck:!1,pk:!0,un:!0,ai:!0,cdf:null,clen:null,np:11,ns:0,dtxp:"11",dtxs:"",altered:1,uidt:"ID",uip:"",uicn:""},{column_name:"title",title:"Title",dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""},{column_name:"created_at",title:"CreatedAt",dt:"timestamp",dtx:"specificType",ct:"timestamp",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.CreatedTime,uip:"",uicn:"",system:!0},{column_name:"updated_at",title:"UpdatedAt",dt:"timestamp",dtx:"specificType",ct:"timestamp",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.LastModifiedTime,uip:"",uicn:"",system:!0},{column_name:"created_by",title:"nc_created_by",dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:Be.CreatedBy,uip:"",uicn:"",system:!0},{column_name:"updated_by",title:"nc_updated_by",dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:Be.LastModifiedBy,uip:"",uicn:"",system:!0}]}static getNewColumn(e){return{column_name:"title"+e,dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""}}static getDefaultLengthForDatatype(e){switch(e){case"int":return 11;case"tinyint":return 1;case"smallint":return 5;case"mediumint":return 9;case"bigint":case"serial":return 20;case"bit":return 64;case"boolean":case"date":case"datetime":case"timestamp":case"time":case"year":case"text":case"tinytext":case"mediumtext":case"longtext":case"blob":case"tinyblob":case"mediumblob":case"longblob":case"enum":case"set":case"geometry":case"point":case"linestring":case"polygon":case"multipoint":case"multilinestring":case"multipolygon":case"json":return"";case"float":return 12;case"decimal":return 10;case"double":return 22;case"char":case"varchar":case"nchar":case"binary":return 255;case"varbinary":return 65500}}static getDefaultLengthIsDisabled(e){switch(e){case"int":case"tinyint":case"smallint":case"mediumint":case"bigint":case"float":case"decimal":case"double":case"serial":case"datetime":case"timestamp":case"char":case"varchar":case"nchar":case"binary":case"varbinary":case"enum":case"set":case"geometry":case"point":case"linestring":case"polygon":case"multipoint":case"multilinestring":case"multipolygon":case"json":case"bit":return!1;case"boolean":case"date":case"time":case"year":case"text":case"tinytext":case"mediumtext":case"longtext":case"blob":case"tinyblob":case"mediumblob":case"longblob":return!0}}static getDefaultValueForDatatype(e){switch(e){case"int":case"smallint":case"mediumint":case"float":case"decimal":case"double":return"eg : 10";case"tinyint":case"bit":case"boolean":case"binary":return"eg : 1";case"bigint":case"serial":return"eg : 100";case"date":return"eg : 2020-09-09";case"datetime":case"timestamp":return"eg : now()\n\nCURRENT_TIMESTAMP\n\nCURRENT_TIMESTAMP on update CURRENT_TIMESTAMP\n\n1992-10-12 00:00:00";case"time":return"eg : 00:00:00";case"year":return"eg : 2020";case"char":case"enum":case"set":return"eg : a";case"varchar":case"nchar":case"text":case"tinytext":case"mediumtext":case"longtext":case"varbinary":case"blob":case"tinyblob":case"mediumblob":case"longblob":return"eg : hey";case"geometry":return"geometry can't have default value";case"point":return"point can't have default value";case"linestring":return"linestring can't have default value";case"polygon":return"polygon can't have default value";case"multipoint":return"multipoint can't have default value";case"multilinestring":return"multilinestring can't have default value";case"multipolygon":return"multipolygon can't have default value";case"json":return"JSON can't have default value"}}static getDefaultScaleForDatatype(e){switch(e){case"int":case"tinyint":case"smallint":case"mediumint":case"bigint":case"bit":case"boolean":case"serial":case"date":case"datetime":case"timestamp":case"time":case"year":case"char":case"varchar":case"nchar":case"text":case"tinytext":case"mediumtext":case"longtext":case"binary":case"varbinary":case"blob":case"tinyblob":case"mediumblob":case"longblob":case"enum":case"set":case"geometry":case"point":case"linestring":case"polygon":case"multipoint":case"multilinestring":case"multipolygon":case"json":return" ";case"float":case"decimal":case"double":return"2"}}static colPropAIDisabled(e,t){if("int"===e.dt||"tinyint"===e.dt||"bigint"===e.dt||"smallint"===e.dt){for(let a=0;a<t.length;++a)if(t[a].cn!==e.cn&&t[a].ai)return!0;return!1}return!0}static colPropUNDisabled(e){return!("int"===e.dt||"tinyint"===e.dt||"smallint"===e.dt||"mediumint"===e.dt||"bigint"===e.dt)}static onCheckboxChangeAI(e){"int"!==e.dt&&"bigint"!==e.dt&&"smallint"!==e.dt&&"tinyint"!==e.dt||(e.altered=e.altered||2)}static onCheckboxChangeAU(e){console.log(e),e.altered=e.altered||2}static showScale(e){return"float"===e.dt||"decimal"===e.dt||"double"===e.dt||"real"===e.dt}static removeUnsigned(e){for(let t=0;t<e.length;++t)1===e[t].altered&&"int"!==e[t].dt&&"bigint"!==e[t].dt&&"tinyint"!==e[t].dt&&"smallint"!==e[t].dt&&"mediumint"!==e[t].dt&&(e[t].un=!1,console.log(">> resetting unsigned value",e[t].cn)),console.log(e[t].cn)}static columnEditable(e){return"_evolutions"!==e.tn||"nc_evolutions"!==e.tn}static colPropAuDisabled(e){return!0}static getUIType(e){switch(this.getAbstractType(e)){case"integer":return"Number";case"boolean":return"Checkbox";case"float":return"Decimal";case"date":return"Date";case"datetime":return"DateTime";case"time":return"Time";case"year":return"Year";case"string":return"SingleLineText";case"text":case"json":return"LongText";case"blob":return"Attachment";case"enum":return"SingleSelect";case"set":return"MultiSelect"}}static getAbstractType(e){var t;switch(null===(t=e.dt)||void 0===t?void 0:t.toLowerCase()){case"int":case"smallint":case"mediumint":case"bigint":case"bit":return"integer";case"boolean":return"boolean";case"float":case"decimal":case"double":case"serial":return"float";case"tinyint":return"1"==e.dtxp?"boolean":"integer";case"date":return"date";case"datetime":case"timestamp":return"datetime";case"time":return"time";case"year":return"year";case"char":case"varchar":case"nchar":case"binary":case"geometry":case"point":case"linestring":case"polygon":case"multipoint":case"multilinestring":case"multipolygon":return"string";case"text":case"tinytext":case"mediumtext":case"longtext":case"varbinary":return"text";case"blob":case"tinyblob":case"mediumblob":case"longblob":return"blob";case"enum":return"enum";case"set":return"set";case"json":return"json"}}static getDataTypeForUiType(e,t){var a,n,s,i;const r={};switch(e.uidt){case"ID":{const e="AI"===t,a="AG"===t;r.dt=a?"varchar":"int",r.pk=!0,r.un=e,r.ai=e,r.rqd=!0,r.meta=a?{ag:"nc"}:void 0}break;case"ForeignKey":case"Collaborator":case"Formula":case"Rollup":case"Lookup":case"Barcode":case"Button":default:r.dt="varchar";break;case"SingleLineText":case"LongText":case"Attachment":case"GeoData":r.dt="text";break;case"Checkbox":r.dt="tinyint",r.dtxp=1,r.cdf="0";break;case"MultiSelect":r.dt="set",((null===(a=e.colOptions)||void 0===a?void 0:a.options.length)>64||(null===(i=null===(s=null===(n=e.dtxp)||void 0===n?void 0:n.toString)||void 0===s?void 0:s.call(n))||void 0===i?void 0:i.split(",").length)>64)&&(r.dt="text");break;case"SingleSelect":r.dt="enum";break;case"Date":r.dt="date";break;case"Year":r.dt="year";break;case"Time":r.dt="time";break;case"PhoneNumber":r.dt="varchar",r.validate={func:["isMobilePhone"],args:[""],msg:["Validation failed : isMobilePhone ({cn})"]};break;case"Email":r.dt="varchar",r.validate={func:["isEmail"],args:[""],msg:["Validation failed : isEmail ({cn})"]};break;case"URL":r.dt="text",r.validate={func:["isURL"],args:[""],msg:["Validation failed : isURL ({cn})"]};break;case"Number":r.dt="bigint";break;case"Decimal":case"Duration":r.dt="decimal";break;case"Currency":r.dt="decimal",r.validate={func:["isCurrency"],args:[""],msg:["Validation failed : isCurrency"]};break;case"Percent":r.dt="double";break;case"Rating":r.dt="int",r.cdf="0";break;case"Count":case"AutoNumber":r.dt="int";break;case"DateTime":r.dt="datetime";break;case"CreatedTime":case"LastModifiedTime":r.dt="timestamp";break;case"JSON":r.dt="json"}return r}static getDataTypeListForUiType(e,t){switch(e.uidt){case"ID":return"AG"===t?["varchar","char","nchar"]:"AI"===t?["int","smallint","mediumint","bigint","bit","serial"]:E;case"ForeignKey":default:return E;case"SingleLineText":case"LongText":case"Collaborator":case"GeoData":return["text","mediumtext","longtext","varchar","char","nchar","tinytext"];case"Attachment":return["json","char","varchar","nchar","text","tinytext","mediumtext","longtext"];case"JSON":return["json","text","tinytext","mediumtext","longtext"];case"Checkbox":return["int","smallint","mediumint","bigint","bit","boolean","serial","tinyint"];case"MultiSelect":return["set","text","tinytext","mediumtext","longtext"];case"SingleSelect":return["enum","text","tinytext","mediumtext","longtext"];case"Year":return["year"];case"Time":return["time"];case"PhoneNumber":case"Email":case"Rollup":case"Lookup":case"Barcode":return["varchar"];case"URL":return["text","tinytext","mediumtext","longtext","varchar"];case"Number":return["int","smallint","mediumint","bigint","bit","float","decimal","double","serial"];case"Decimal":return["float","decimal","double","serial"];case"Currency":case"Percent":case"Duration":case"Rating":return["decimal","float","double","serial","int","smallint","mediumint","bigint","bit"];case"Formula":case"Button":return["char","varchar","nchar","text","tinytext","mediumtext","longtext"];case"Count":return["int","smallint","mediumint","bigint","serial"];case"Date":return["date","datetime","timestamp","varchar"];case"DateTime":case"CreatedTime":case"LastModifiedTime":return["datetime","timestamp","varchar"];case"AutoNumber":return["int","smallint","mediumint","bigint"];case"Geometry":return["geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon"]}}static getUnsupportedFnList(){return["COUNTA","COUNT","DATESTR"]}static getCurrentDateDefault(e){return(!e.dt||"timestamp"!==e.dt.toLowerCase()&&"datetime"!==e.dt.toLowerCase())&&(e.dt||e.uidt!==Be.DateTime)?null:"CURRENT_TIMESTAMP"}static isEqual(e,t){if(e===t)return!0;const a=this.getAbstractType({dt:e}),n=this.getAbstractType({dt:t});return!(!a||a!==n||!["integer","float"].includes(a))}}const _=["int","integer","bigint","bigserial","char","int2","int4","int8","int4range","int8range","serial","serial2","serial8","character","bit","bool","boolean","date","double precision","event_trigger","fdw_handler","float4","float8","uuid","smallint","smallserial","character varying","text","real","time","time without time zone","timestamp","timestamp without time zone","timestamptz","timestamp with time zone","timetz","time with time zone","daterange","json","jsonb","gtsvector","index_am_handler","anyenum","anynonarray","anyrange","box","bpchar","bytea","cid","cidr","circle","cstring","inet","internal","interval","language_handler","line","lsec","macaddr","money","name","numeric","numrange","oid","opaque","path","pg_ddl_command","pg_lsn","pg_node_tree","point","polygon","record","refcursor","regclass","regconfig","regdictionary","regnamespace","regoper","regoperator","regproc","regpreocedure","regrole","regtype","reltime","smgr","tid","tinterval","trigger","tsm_handler","tsquery","tsrange","tstzrange","tsvector","txid_snapshot","unknown","void","xid","xml"];class T{static getNewTableColumns(){return[{column_name:"id",title:"Id",dt:"int4",dtx:"integer",ct:"int(11)",nrqd:!1,rqd:!0,ck:!1,pk:!0,un:!1,ai:!0,cdf:null,clen:null,np:11,ns:0,dtxp:"11",dtxs:"",altered:1,uidt:"ID",uip:"",uicn:""},{column_name:"title",title:"Title",dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""},{column_name:"created_at",title:"CreatedAt",dt:"timestamp",dtx:"specificType",ct:"timestamp",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.CreatedTime,uip:"",uicn:"",system:!0},{column_name:"updated_at",title:"UpdatedAt",dt:"timestamp",dtx:"specificType",ct:"timestamp",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.LastModifiedTime,uip:"",uicn:"",system:!0},{column_name:"created_by",title:"nc_created_by",dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:Be.CreatedBy,uip:"",uicn:"",system:!0},{column_name:"updated_by",title:"nc_updated_by",dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:Be.LastModifiedBy,uip:"",uicn:"",system:!0}]}static getNewColumn(e){return{column_name:"title"+e,dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""}}static getDefaultLengthForDatatype(e){switch(e){case"int":case"tinyint":case"smallint":case"mediumint":case"bigint":case"bit":case"boolean":case"float":case"decimal":case"double":case"serial":case"date":case"datetime":case"timestamp":case"time":case"year":case"char":case"varchar":case"nchar":case"text":case"tinytext":case"mediumtext":case"longtext":case"binary":case"varbinary":case"blob":case"tinyblob":case"mediumblob":case"longblob":case"enum":case"set":case"geometry":case"point":case"linestring":case"polygon":case"multipoint":case"multilinestring":case"multipolygon":case"json":return""}}static getDefaultLengthIsDisabled(e){switch(e){case"anyenum":case"anynonarray":case"anyrange":case"bigint":case"bigserial":case"bit":case"bool":case"box":case"bpchar":case"bytea":case"char":case"character":case"cid":case"cidr":case"circle":case"cstring":case"date":case"daterange":case"double precision":case"event_trigger":case"fdw_handler":case"float4":case"float8":case"gtsvector":case"index_am_handler":case"inet":case"int":case"int2":case"int4":case"int8":case"int4range":case"int8range":case"integer":case"internal":case"interval":case"jsonb":case"language_handler":case"line":case"lsec":case"macaddr":case"money":case"name":case"numeric":case"numrange":case"oid":case"opaque":case"path":case"pg_ddl_command":case"pg_lsn":case"pg_node_tree":case"real":case"record":case"refcursor":case"regclass":case"regconfig":case"regdictionary":case"regnamespace":case"regoper":case"regoperator":case"regproc":case"regpreocedure":case"regrole":case"regtype":case"reltime":case"serial":case"serial2":case"serial8":case"smallint":case"smallserial":case"smgr":case"text":case"tid":case"time":case"time without time zone":case"timestamp":case"timestamp without time zone":case"timestamptz":case"timestamp with time zone":case"timetz":case"time with time zone":case"tinterval":case"trigger":case"tsm_handler":case"tsquery":case"tsrange":case"tstzrange":case"tsvector":case"txid_snapshot":case"unknown":case"void":case"xid":case"xml":case"character varying":case"tinyint":case"mediumint":case"float":case"decimal":case"double":case"boolean":case"datetime":case"uuid":case"year":case"varchar":case"nchar":case"tinytext":case"mediumtext":case"longtext":case"binary":case"varbinary":case"blob":case"tinyblob":case"mediumblob":case"longblob":case"enum":case"set":case"geometry":case"point":case"linestring":case"polygon":case"multipoint":case"multilinestring":case"multipolygon":case"json":return!0}}static getDefaultValueForDatatype(e){switch(e){case"anyenum":case"anynonarray":case"anyrange":case"bigint":case"bigserial":case"bit":case"bool":case"box":case"bpchar":case"bytea":case"char":case"cid":case"cidr":case"circle":case"cstring":case"daterange":case"event_trigger":case"fdw_handler":case"gtsvector":case"index_am_handler":case"inet":case"int":case"int2":case"int4":case"int8":case"int4range":case"int8range":case"integer":case"internal":case"interval":case"json":case"jsonb":case"language_handler":case"line":case"lsec":case"macaddr":case"money":case"name":case"numeric":case"numrange":case"oid":case"opaque":case"path":case"pg_ddl_command":case"pg_lsn":case"pg_node_tree":case"point":case"polygon":case"record":case"refcursor":case"regclass":case"regconfig":case"regdictionary":case"regnamespace":case"regoper":case"regoperator":case"regproc":case"regpreocedure":case"regrole":case"regtype":case"reltime":case"serial":case"serial2":case"serial8":case"smallint":case"smallserial":case"smgr":case"tid":case"tinterval":case"trigger":case"tsm_handler":case"tsquery":case"tsrange":case"tstzrange":case"tsvector":case"txid_snapshot":case"unknown":case"void":case"xid":case"xml":case"tinyint":case"mediumint":case"float":case"decimal":case"datetime":case"uuid":case"year":case"varchar":case"nchar":case"tinytext":case"mediumtext":case"longtext":case"binary":case"varbinary":case"blob":case"tinyblob":case"mediumblob":case"longblob":case"enum":case"set":case"geometry":case"linestring":case"multipoint":case"multilinestring":case"multipolygon":return"eg: ";case"character":return"eg: 'sample'";case"date":return"eg: '2020-09-09'";case"double precision":case"float4":case"float8":case"real":case"double":return"eg: 1.2";case"text":case"character varying":return"eg: 'sample text'";case"time":case"time without time zone":return"eg: now()\n\n'04:05:06.789'";case"timestamp":case"timestamp without time zone":case"timestamp with time zone":return"eg: now()\n\n'2016-06-22 19:10:25-07'";case"timestamptz":return"eg: timezone('America/New_York','2016-06-01 00:00')\n\nnow()\n\n'2016-06-22 19:10:25-07'";case"timetz":case"time with time zone":return"eg: now()";case"boolean":return"eg: true\n\nfalse"}}static getDefaultScaleForDatatype(e){switch(e){case"int":case"tinyint":case"smallint":case"mediumint":case"bigint":case"bit":case"boolean":case"serial":case"date":case"datetime":case"timestamp":case"time":case"year":case"char":case"varchar":case"nchar":case"text":case"tinytext":case"mediumtext":case"longtext":case"binary":case"varbinary":case"blob":case"tinyblob":case"mediumblob":case"longblob":case"enum":case"set":case"geometry":case"point":case"linestring":case"polygon":case"multipoint":case"multilinestring":case"multipolygon":case"json":return" ";case"float":case"decimal":case"double":return"2"}}static colPropAIDisabled(e,t){if("int4"===e.dt||"integer"===e.dt||"bigint"===e.dt||"smallint"===e.dt){for(let a=0;a<t.length;++a)if(t[a].cn!==e.cn&&t[a].ai)return!0;return!1}return!0}static colPropUNDisabled(e){return!0}static onCheckboxChangeAI(e){console.log(e),"int"!==e.dt&&"bigint"!==e.dt&&"smallint"!==e.dt&&"tinyint"!==e.dt||(e.altered=e.altered||2)}static onCheckboxChangeAU(e){console.log(e),e.altered=e.altered||2,e.au&&(e.cdf="now()")}static showScale(e){return!1}static removeUnsigned(e){for(let t=0;t<e.length;++t)1===e[t].altered&&"int"!==e[t].dt&&"bigint"!==e[t].dt&&"tinyint"!==e[t].dt&&"smallint"!==e[t].dt&&"mediumint"!==e[t].dt&&(e[t].un=!1,console.log(">> resetting unsigned value",e[t].cn)),console.log(e[t].cn)}static columnEditable(e){return"_evolutions"!==e.tn||"nc_evolutions"!==e.tn}static colPropAuDisabled(e){if(1!==e.altered)return!0;switch(e.dt){case"time":case"time without time zone":case"timestamp":case"timestamp without time zone":case"timestamptz":case"timestamp with time zone":case"timetz":case"time with time zone":return!1;default:return!0}}static getAbstractType(e){var t;switch(null===(t=e.dt)||void 0===t?void 0:t.toLowerCase()){case"anyenum":case"enum":return"enum";case"anynonarray":case"anyrange":case"box":case"bpchar":case"bytea":case"char":case"character":case"cid":case"cidr":case"circle":case"cstring":case"daterange":case"event_trigger":case"fdw_handler":case"gtsvector":case"index_am_handler":case"inet":case"int4range":case"int8range":case"internal":case"interval":case"language_handler":case"line":case"lsec":case"macaddr":case"money":case"name":case"numeric":case"numrange":case"oid":case"opaque":case"path":case"pg_ddl_command":case"pg_lsn":case"pg_node_tree":case"point":case"polygon":case"record":case"refcursor":case"regclass":case"regconfig":case"regdictionary":case"regnamespace":case"regoper":case"regoperator":case"regproc":case"regpreocedure":case"regrole":case"regtype":case"reltime":case"smgr":case"tid":case"tinterval":case"trigger":case"tsm_handler":case"tsquery":case"tsrange":case"tstzrange":case"tsvector":case"txid_snapshot":case"unknown":case"void":case"xid":case"character varying":case"xml":case"uuid":case"year":case"varchar":case"nchar":case"binary":case"varbinary":case"geometry":case"linestring":case"multipoint":case"multilinestring":case"multipolygon":return"string";case"bit":case"int":case"int2":case"int4":case"int8":case"integer":case"bigint":case"bigserial":case"serial":case"serial2":case"serial8":case"smallint":case"smallserial":case"tinyint":case"mediumint":return"integer";case"bool":case"boolean":return"boolean";case"date":return"date";case"double precision":case"float4":case"float8":case"real":case"float":case"decimal":case"double":return"float";case"text":case"tinytext":case"mediumtext":case"longtext":return"text";case"time":case"time without time zone":case"timetz":case"time with time zone":return"time";case"timestamp":case"timestamp without time zone":case"timestamptz":case"timestamp with time zone":case"datetime":return"datetime";case"blob":case"tinyblob":case"mediumblob":case"longblob":return"blob";case"set":return"set";case"json":case"jsonb":return"json"}}static getUIType(e){switch(this.getAbstractType(e)){case"integer":return"Number";case"boolean":return"Checkbox";case"float":return"Decimal";case"date":return"Date";case"datetime":return"CreatedTime";case"time":return"Time";case"year":return"Year";case"string":return"SingleLineText";case"text":case"json":return"LongText";case"blob":return"Attachment";case"enum":return"SingleSelect";case"set":return"MultiSelect"}}static getDataTypeForUiType(e,t){const a={};switch(e.uidt){case"ID":{const e="AI"===t,n="AG"===t;a.dt=n?"character varying":"int4",a.pk=!0,a.un=e,a.ai=e,a.rqd=!0,a.meta=n?{ag:"nc"}:void 0}break;case"ForeignKey":case"Collaborator":case"Formula":case"Rollup":case"Lookup":case"Barcode":case"Button":default:a.dt="character varying";break;case"SingleLineText":case"LongText":case"Attachment":case"GeoData":case"MultiSelect":case"SingleSelect":a.dt="text";break;case"Checkbox":a.dt="bool",a.cdf="false";break;case"Date":a.dt="date";break;case"Year":case"AutoNumber":a.dt="int";break;case"Time":a.dt="time";break;case"PhoneNumber":a.dt="character varying",a.validate={func:["isMobilePhone"],args:[""],msg:["Validation failed : isMobilePhone"]};break;case"Email":a.dt="character varying",a.validate={func:["isEmail"],args:[""],msg:["Validation failed : isEmail"]};break;case"URL":a.dt="text",a.validate={func:["isURL"],args:[""],msg:["Validation failed : isURL"]};break;case"Number":a.dt="bigint";break;case"Decimal":case"Duration":a.dt="decimal";break;case"Currency":a.dt="decimal",a.validate={func:["isCurrency"],args:[""],msg:["Validation failed : isCurrency"]};break;case"Percent":a.dt="double precision";break;case"Rating":a.dt="smallint",a.cdf="0";break;case"Count":a.dt="int8";break;case"DateTime":case"CreatedTime":case"LastModifiedTime":a.dt="timestamp";break;case"JSON":a.dt="json"}return a}static getDataTypeListForUiType(e,t){switch(e.uidt){case"ID":return"AG"===t?["char","character","character varying"]:"AI"===t?["int","integer","bigint","bigserial","int2","int4","int8","serial","serial2","serial8","smallint","smallserial"]:_;case"ForeignKey":default:return _;case"SingleLineText":case"LongText":case"Collaborator":case"GeoData":return["text","character varying","char","character"];case"Attachment":return["json","text","char","character","character varying"];case"JSON":return["json","jsonb","text"];case"Checkbox":return["bit","bool","int2","int4","int8","boolean","smallint","int","integer","bigint","bigserial","char","int4range","int8range","serial","serial2","serial8"];case"MultiSelect":case"SingleSelect":return["text"];case"Year":return["int"];case"Time":return["time","time without time zone","timestamp","timestamp without time zone","timestamptz","timestamp with time zone","timetz","time with time zone"];case"PhoneNumber":case"Email":case"Rollup":case"Lookup":case"User":case"CreatedBy":case"LastModifiedBy":case"Barcode":return["character varying"];case"URL":case"Formula":case"Button":return["text","character varying"];case"Number":case"Percent":case"Duration":case"Rating":return["int","integer","bigint","bigserial","int2","int4","int8","serial","serial2","serial8","double precision","float4","float8","smallint","smallserial","numeric"];case"Decimal":return["double precision","float4","float8","numeric"];case"Currency":return["int","integer","bigint","bigserial","int2","int4","int8","serial","serial2","serial8","double precision","money","float4","float8","numeric"];case"Count":case"AutoNumber":return["int","integer","bigint","bigserial","int2","int4","int8","serial","serial2","serial8","smallint","smallserial"];case"Date":return["date","timestamp","timestamp without time zone","timestamptz","timestamp with time zone"];case"DateTime":case"CreatedTime":case"LastModifiedTime":return["timestamp","timestamp without time zone","timestamptz","timestamp with time zone"];case"Geometry":return["polygon","point","circle","box","line","lseg","path","circle"]}}static getUnsupportedFnList(){return[]}static getCurrentDateDefault(e){return e.uidt===Be.DateTime||e.uidt===Be.Date?"NOW()":null}static isEqual(e,t){if((null==e?void 0:e.toLowerCase())===(null==t?void 0:t.toLowerCase()))return!0;const a=this.getAbstractType({dt:e}),n=this.getAbstractType({dt:t});return!(!a||a!==n||!["integer","float"].includes(a))}}const C=["bigint","binary","bit","char","date","datetime","datetime2","datetimeoffset","decimal","float","geography","geometry","heirarchyid","image","int","money","nchar","ntext","numeric","nvarchar","real","json","smalldatetime","smallint","smallmoney","sql_variant","sysname","text","time","timestamp","tinyint","uniqueidentifier","varbinary","xml","varchar"];class O{static getNewTableColumns(){return[{column_name:"id",title:"Id",dt:"int",dtx:"integer",ct:"int(11)",nrqd:!1,rqd:!0,ck:!1,pk:!0,un:!1,ai:!0,cdf:null,clen:null,np:null,ns:0,dtxp:"",dtxs:"",altered:1,uidt:"ID",uip:"",uicn:""},{column_name:"title",title:"Title",dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""},{column_name:"created_at",title:"CreatedAt",dt:"datetime",dtx:"specificType",ct:"datetime",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.CreatedTime,uip:"",uicn:"",system:!0},{column_name:"updated_at",title:"UpdatedAt",dt:"datetime",dtx:"specificType",ct:"datetime",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,au:!0,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.LastModifiedTime,uip:"",uicn:"",system:!0},{column_name:"created_by",title:"nc_created_by",dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:Be.CreatedBy,uip:"",uicn:"",system:!0},{column_name:"updated_by",title:"nc_updated_by",dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:Be.LastModifiedBy,uip:"",uicn:"",system:!0}]}static getNewColumn(e){return{column_name:"title"+e,dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""}}static getDefaultLengthForDatatype(e){switch(e){case"decimal":return 10;case"varchar":return 255;default:return""}}static getDefaultLengthIsDisabled(e){switch(e){case"nvarchar":case"numeric":case"decimal":case"varchar":return!1;default:return!0}}static getDefaultValueForDatatype(e){switch(e){case"bigint":case"binary":case"bit":case"char":case"date":case"datetime":case"datetime2":case"datetimeoffset":case"decimal":case"float":case"geography":case"geometry":case"heirarchyid":case"image":case"int":case"money":case"nchar":case"ntext":case"numeric":case"nvarchar":case"real":case"json":case"smalldatetime":case"smallint":case"smallmoney":case"sql_variant":case"sysname":case"text":case"time":case"timestamp":case"tinyint":case"uniqueidentifier":case"varbinary":case"xml":case"varchar":return"eg: ";default:return""}}static getDefaultScaleForDatatype(e){switch(e){case"decimal":case"numeric":return"2";default:return""}}static colPropAIDisabled(e,t){if("int4"===e.dt||"integer"===e.dt||"bigint"===e.dt||"smallint"===e.dt){for(let a=0;a<t.length;++a)if(t[a].cn!==e.cn&&t[a].ai)return!0;return!1}return!0}static colPropUNDisabled(e){return!0}static onCheckboxChangeAI(e){console.log(e),"int"!==e.dt&&"bigint"!==e.dt&&"smallint"!==e.dt&&"tinyint"!==e.dt||(e.altered=e.altered||2)}static showScale(e){return"decimal"===e.dt||"numeric"===e.dt}static removeUnsigned(e){for(let t=0;t<e.length;++t)1===e[t].altered&&"int"!==e[t].dt&&"bigint"!==e[t].dt&&"tinyint"!==e[t].dt&&"smallint"!==e[t].dt&&"mediumint"!==e[t].dt&&(e[t].un=!1,console.log(">> resetting unsigned value",e[t].cn)),console.log(e[t].cn)}static columnEditable(e){return"_evolutions"!==e.tn||"nc_evolutions"!==e.tn}static onCheckboxChangeAU(e){console.log(e),e.altered=e.altered||2,e.au&&(e.cdf="GETDATE()")}static colPropAuDisabled(e){if(1!==e.altered)return!0;switch(e.dt){case"date":case"datetime":case"datetime2":case"datetimeoffset":case"time":case"timestamp":return!1;default:return!0}}static getAbstractType(e){var t;switch(null===(t=e.dt)||void 0===t?void 0:t.toLowerCase()){case"bigint":case"smallint":case"bit":case"tinyint":case"int":return"integer";case"binary":case"char":case"geography":case"geometry":case"heirarchyid":case"image":case"money":case"nchar":case"nvarchar":case"smallmoney":case"sql_variant":case"sysname":case"uniqueidentifier":case"varbinary":case"xml":case"varchar":return"string";case"date":return"date";case"datetime":case"datetime2":case"smalldatetime":case"datetimeoffset":return"datetime";case"decimal":case"float":case"numeric":case"real":return"float";case"ntext":case"text":return"text";case"json":return"json";case"time":return"time";case"timestamp":return"timestamp"}return"string"}static getUIType(e){switch(this.getAbstractType(e)){case"integer":return"Number";case"boolean":return"Checkbox";case"float":return"Decimal";case"date":return"Date";case"datetime":return"CreatedTime";case"time":return"Time";case"year":return"Year";case"string":return"SingleLineText";case"text":case"json":return"LongText";case"blob":return"Attachment";case"enum":return"SingleSelect";case"set":return"MultiSelect"}}static getDataTypeForUiType(e,t){const a={};switch(e.uidt){case"ID":{const e="AI"===t,n="AG"===t;a.dt=n?"varchar":"int",a.pk=!0,a.un=e,a.ai=e,a.rqd=!0,a.meta=n?{ag:"nc"}:void 0}break;case"ForeignKey":case"Collaborator":case"GeoData":case"Formula":case"Rollup":case"Lookup":case"Barcode":case"Button":default:a.dt="varchar";break;case"SingleLineText":case"LongText":case"Attachment":case"MultiSelect":case"SingleSelect":a.dt="text";break;case"Checkbox":a.dt="tinyint",a.dtxp=1,a.cdf="0";break;case"Date":a.dt="date";break;case"Year":case"Number":case"Count":case"AutoNumber":a.dt="int";break;case"Time":a.dt="time";break;case"PhoneNumber":a.dt="varchar",a.validate={func:["isMobilePhone"],args:[""],msg:["Validation failed : isMobilePhone"]};break;case"Email":a.dt="varchar",a.validate={func:["isEmail"],args:[""],msg:["Validation failed : isEmail"]};break;case"URL":a.dt="text",a.validate={func:["isURL"],args:[""],msg:["Validation failed : isURL"]};break;case"Decimal":case"Duration":a.dt="decimal";break;case"Currency":a.dt="decimal",a.validate={func:["isCurrency"],args:[""],msg:["Validation failed : isCurrency"]};break;case"Percent":a.dt="double";break;case"Rating":a.dt="int",a.cdf="0";break;case"DateTime":a.dt="datetimeoffset";break;case"CreatedTime":case"LastModifiedTime":a.dt="datetime"}return a}static getDataTypeListForUiType(e,t){switch(e.uidt){case"ID":return"AG"===t?["char","ntext","text","varchar","nvarchar"]:"AI"===t?["int","bigint","bit","smallint","tinyint"]:C;case"ForeignKey":default:return C;case"SingleLineText":case"LongText":case"Attachment":case"Collaborator":case"GeoData":return["text","varchar","nvarchar","char","ntext"];case"JSON":case"MultiSelect":case"SingleSelect":return["text","ntext"];case"Checkbox":return["bigint","bit","int","tinyint"];case"Year":return["int"];case"Time":return["time"];case"PhoneNumber":case"Email":case"Rollup":case"Lookup":case"Barcode":return["varchar"];case"URL":return["text","varchar"];case"Number":case"Percent":case"Duration":case"Rating":return["int","bigint","bit","decimal","float","numeric","real","smallint","tinyint"];case"Decimal":return["decimal","float"];case"Currency":return["int","bigint","bit","decimal","float","numeric","real","smallint","tinyint","money"];case"Formula":case"Button":return["text","ntext","varchar","nvarchar"];case"Count":case"AutoNumber":return["int","bigint","smallint","tinyint"];case"Date":return["date"];case"DateTime":case"CreatedTime":case"LastModifiedTime":return["datetimeoffset","datetime2"];case"Geometry":return["geometry"]}}static getUnsupportedFnList(){return["XOR","REGEX_MATCH","REGEX_EXTRACT","REGEX_REPLACE","VALUE","COUNTA","COUNT","ROUNDDOWN","ROUNDUP","DATESTR"]}static getCurrentDateDefault(e){return null}static isEqual(e,t){if(e===t)return!0;const a=this.getAbstractType({dt:e}),n=this.getAbstractType({dt:t});return!(!a||a!==n||!["integer","float"].includes(a))}}class N{static getNewTableColumns(){return[{column_name:"id",title:"Id",dt:"integer",dtx:"integer",ct:"int(11)",nrqd:!1,rqd:!0,ck:!1,pk:!0,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"ID",uip:"",uicn:""},{column_name:"title",title:"Title",dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""}]}static getNewColumn(e){return{column_name:"title"+e,dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""}}static getDefaultLengthForDatatype(e){return""}static getDefaultLengthIsDisabled(e){switch(e){case"integer":return!0;case"bfile":case"binary rowid":case"binary double":case"binary_float":case"blob":case"canoical":case"cfile":case"char":case"clob":case"content pointer":case"contigous array":case"date":case"decimal":case"double precision":case"float":case"interval day to second":case"interval year to month":case"lob pointer":case"long":case"long raw":case"named collection":case"named object":case"nchar":case"nclob":case"number":case"nvarchar2":case"octet":case"oid":case"pointer":case"raw":case"real":case"ref":case"ref cursor":case"rowid":case"signed binary integer":case"smallint":case"table":case"time":case"time with tz":case"timestamp":case"timestamp with local time zone":case"timestamp with local tz":case"timestamp with timezone":case"timestamp with tz":case"unsigned binary integer":case"urowid":case"varchar":case"varchar2":case"varray":case"varying array":return!1}}static getDefaultValueForDatatype(e){return""}static getDefaultScaleForDatatype(e){switch(e){case"integer":case"bfile":case"binary rowid":case"binary double":case"binary_float":case"blob":case"canoical":case"cfile":case"char":case"clob":case"content pointer":case"contigous array":case"date":case"decimal":case"double precision":case"float":case"interval day to second":case"interval year to month":case"lob pointer":case"long":case"long raw":case"named collection":case"named object":case"nchar":case"nclob":case"number":case"nvarchar2":case"octet":case"oid":case"pointer":case"raw":case"real":case"ref":case"ref cursor":case"rowid":case"signed binary integer":case"smallint":case"table":case"time":case"time with tz":case"timestamp":case"timestamp with local time zone":case"timestamp with local tz":case"timestamp with timezone":case"timestamp with tz":case"unsigned binary integer":case"urowid":case"varchar":case"varchar2":case"varray":case"varying array":return" "}}static colPropAIDisabled(e,t){if("int4"===e.dt||"integer"===e.dt||"bigint"===e.dt||"smallint"===e.dt){for(let a=0;a<t.length;++a)if(t[a].cn!==e.cn&&t[a].ai)return!0;return!1}return!0}static colPropUNDisabled(e){return!0}static onCheckboxChangeAI(e){console.log(e),"int"!==e.dt&&"bigint"!==e.dt&&"smallint"!==e.dt&&"tinyint"!==e.dt||(e.altered=e.altered||2)}static showScale(e){return!1}static removeUnsigned(e){for(let t=0;t<e.length;++t)1===e[t].altered&&"int"!==e[t].dt&&"bigint"!==e[t].dt&&"tinyint"!==e[t].dt&&"smallint"!==e[t].dt&&"mediumint"!==e[t].dt&&(e[t].un=!1,console.log(">> resetting unsigned value",e[t].cn)),console.log(e[t].cn)}static columnEditable(e){return"_evolutions"!==e.tn||"nc_evolutions"!==e.tn}static extractFunctionName(e){const t=e.match(/^\s*CREATE\s+(?:OR\s+REPLACE\s*)?\s*FUNCTION\s+(?:[\w\d_]+\.)?([\w_\d]+)/i);return t&&t[1]}static extractProcedureName(e){const t=e.match(/^\s*CREATE\s+(?:OR\s+REPLACE\s*)?\s*PROCEDURE\s+(?:[\w\d_]+\.)?([\w_\d]+)/i);return t&&t[1]}static splitQueries(e){return e.match(/\b("[^"]*;[^"]*"|'[^']*;[^']*'|[^;])*;/g)}static onCheckboxChangeAU(e){console.log(e),e.altered=e.altered||2}sanitiseQuery(e){let t=e.query.trim().split(";");if(t[0].startsWith("Select"))t=t[0]+` LIMIT 0,${e.limit?e.limit:100};`;else if(t[0].startsWith("select"))t=t[0]+` LIMIT 0,${e.limit?e.limit:100};`;else{if(!t[0].startsWith("SELECT"))return e.query;t=t[0]+` LIMIT 0,${e.limit?e.limit:100};`}return t}getColumnsFromJson(e,t){const a=[];try{if("object"==typeof e&&!Array.isArray(e)){const n=Object.keys(e);for(let s=0;s<n.length;++s)switch(typeof e[n[s]]){case"number":Number.isInteger(e[n[s]])?a.push({dp:null,tn:t,column_name:n[s],cno:n[s],dt:"int",np:10,ns:0,clen:null,cop:1,pk:!1,nrqd:!1,rqd:!1,un:!1,ct:"int(11) unsigned",ai:!1,unique:!1,cdf:null,cc:"",csn:null,dtx:"specificType",dtxp:"11",dtxs:0,altered:1}):a.push({dp:null,tn:t,column_name:n[s],cno:n[s],dt:"float",np:10,ns:2,clen:null,cop:1,pk:!1,nrqd:!1,rqd:!1,un:!1,ct:"int(11) unsigned",ai:!1,unique:!1,cdf:null,cc:"",csn:null,dtx:"specificType",dtxp:"11",dtxs:2,altered:1});break;case"string":e[n[s]].length<=255?a.push({dp:null,tn:t,column_name:n[s],cno:n[s],dt:"varchar",np:45,ns:0,clen:null,cop:1,pk:!1,nrqd:!1,rqd:!1,un:!1,ct:"int(11) unsigned",ai:!1,unique:!1,cdf:null,cc:"",csn:null,dtx:"specificType",dtxp:"45",dtxs:0,altered:1}):a.push({dp:null,tn:t,column_name:n[s],cno:n[s],dt:"text",np:null,ns:0,clen:null,cop:1,pk:!1,nrqd:!1,rqd:!1,un:!1,ct:"int(11) unsigned",ai:!1,unique:!1,cdf:null,cc:"",csn:null,dtx:"specificType",dtxp:null,dtxs:0,altered:1});break;case"boolean":a.push({dp:null,tn:t,column_name:n[s],cno:n[s],dt:"boolean",np:3,ns:0,clen:null,cop:1,pk:!1,nrqd:!1,rqd:!1,un:!1,ct:"int(11) unsigned",ai:!1,unique:!1,cdf:null,cc:"",csn:null,dtx:"specificType",dtxp:"1",dtxs:0,altered:1});break;case"object":a.push({dp:null,tn:t,column_name:n[s],cno:n[s],dt:"json",np:3,ns:0,clen:null,cop:1,pk:!1,nrqd:!1,rqd:!1,un:!1,ct:"int(11) unsigned",ai:!1,unique:!1,cdf:null,cc:"",csn:null,dtx:"specificType",dtxp:null,dtxs:0,altered:1})}}}catch(e){console.log("Error in getColumnsFromJson",e)}return a}static colPropAuDisabled(e){return!0}static getAbstractType(e){var t;switch(null===(t=e.dt)||void 0===t?void 0:t.toLowerCase()){case"integer":case"long":case"smallint":return"integer";case"bfile":case"binary rowid":case"binary double":case"binary_float":case"canoical":case"cfile":case"char":case"clob":case"content pointer":case"contigous array":case"interval day to second":case"interval year to month":case"lob pointer":case"long raw":case"named collection":case"named object":case"nchar":case"nclob":case"nvarchar2":case"octet":case"oid":case"pointer":case"raw":case"ref":case"ref cursor":case"rowid":case"signed binary integer":case"table":case"unsigned binary integer":case"urowid":case"varchar":case"varchar2":case"varray":case"varying array":return"string";case"blob":return"blob";case"date":return"date";case"decimal":case"double precision":case"float":case"real":case"number":return"float";case"time":case"time with tz":return"time";case"timestamp":case"timestamp with local time zone":case"timestamp with local tz":case"timestamp with timezone":case"timestamp with tz":return"datetime"}}static getUIType(e){switch(this.getAbstractType(e)){case"integer":return"Number";case"boolean":return"Checkbox";case"float":return"Decimal";case"date":return"Date";case"datetime":return"CreatedTime";case"time":return"Time";case"year":return"Year";case"string":return"SingleLineText";case"text":case"json":return"LongText";case"blob":return"Attachment";case"enum":return"SingleSelect";case"set":return"MultiSelect"}}static getDataTypeForUiType(e,t){const a={};switch(e.uidt){case"ID":{const e="AI"===t,n="AG"===t;a.dt=n?"varchar":"integer",a.pk=!0,a.un=e,a.ai=e,a.rqd=!0,a.meta=n?{ag:"nc"}:void 0}break;case"ForeignKey":case"GeoData":case"Collaborator":case"Date":case"Formula":case"Rollup":case"Lookup":case"Barcode":case"Button":default:a.dt="varchar";break;case"SingleLineText":case"LongText":case"Attachment":a.dt="clob";break;case"Checkbox":a.dt="tinyint",a.dtxp=1,a.cdf="0";break;case"MultiSelect":case"SingleSelect":a.dt="varchar2";break;case"Year":a.dt="year";break;case"Time":a.dt="time";break;case"PhoneNumber":a.dt="varchar",a.validate={func:["isMobilePhone"],args:[""],msg:["Validation failed : isMobilePhone"]};break;case"Email":a.dt="varchar",a.validate={func:["isEmail"],args:[""],msg:["Validation failed : isEmail"]};break;case"URL":a.dt="clob",a.validate={func:["isURL"],args:[""],msg:["Validation failed : isURL"]};break;case"Number":case"Duration":case"Count":case"AutoNumber":a.dt="integer";break;case"Decimal":a.dt="decimal";break;case"Currency":a.dt="decimal",a.validate={func:["isCurrency"],args:[""],msg:["Validation failed : isCurrency"]};break;case"Percent":a.dt="double";break;case"Rating":a.dt="integer",a.cdf="0";break;case"DateTime":case"CreatedTime":case"LastModifiedTime":a.dt="timestamp"}return a}static getUnsupportedFnList(){return["XOR","REGEX_MATCH","REGEX_EXTRACT","REGEX_REPLACE","VALUE","COUNTA","COUNT","ROUNDDOWN","ROUNDUP","DATESTR"]}static getCurrentDateDefault(e){return null}static isEqual(e,t){if(e===t)return!0;const a=this.getAbstractType({dt:e}),n=this.getAbstractType({dt:t});return!(!a||a!==n||!["integer","float"].includes(a))}}const A=["int","integer","tinyint","smallint","mediumint","bigint","int2","int8","character","blob sub_type text","blob","real","double","double precision","float","numeric","boolean","date","datetime","text","varchar","timestamp"];class R{static getNewTableColumns(){return[{column_name:"id",title:"Id",dt:"integer",dtx:"integer",ct:"int(11)",nrqd:!1,rqd:!0,ck:!1,pk:!0,un:!1,ai:!0,cdf:null,clen:null,np:null,ns:0,dtxp:"",dtxs:"",altered:1,uidt:"ID",uip:"",uicn:""},{column_name:"title",title:"Title",dt:"varchar",dtx:"specificType",ct:"varchar",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""},{column_name:"created_at",title:"CreatedAt",dt:"datetime",dtx:"specificType",ct:"datetime",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.CreatedTime,uip:"",uicn:"",system:!0},{column_name:"updated_at",title:"UpdatedAt",dt:"datetime",dtx:"specificType",ct:"datetime",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.LastModifiedTime,uip:"",uicn:"",system:!0},{column_name:"created_by",title:"nc_created_by",dt:"varchar",dtx:"specificType",ct:"varchar",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.CreatedBy,uip:"",uicn:"",system:!0},{column_name:"updated_by",title:"nc_updated_by",dt:"varchar",dtx:"specificType",ct:"varchar",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.LastModifiedBy,uip:"",uicn:"",system:!0}]}static getNewColumn(e){return{column_name:"title"+e,dt:"varchar",dtx:"specificType",ct:"varchar",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""}}static getDefaultLengthForDatatype(e){return""}static getDefaultLengthIsDisabled(e){switch(e){case"integer":case"blob":case"real":case"numeric":return!0;case"text":return!1}}static getDefaultValueForDatatype(e){switch(e){case"integer":case"numeric":case"real":return"eg : 10";case"text":return"eg : hey";case"blob":return"eg : 100"}}static getDefaultScaleForDatatype(e){switch(e){case"integer":case"text":case"numeric":case"real":case"blob":return" "}}static colPropAIDisabled(e,t){if("integer"===e.dt){for(let a=0;a<t.length;++a)if(t[a].cn!==e.cn&&t[a].ai)return!0;return!1}return!0}static colPropUNDisabled(e){return!0}static onCheckboxChangeAI(e){console.log(e),"int"!==e.dt&&"bigint"!==e.dt&&"smallint"!==e.dt&&"tinyint"!==e.dt||(e.altered=e.altered||2)}static showScale(e){return!1}static removeUnsigned(e){for(let t=0;t<e.length;++t)1===e[t].altered&&"int"!==e[t].dt&&"bigint"!==e[t].dt&&"tinyint"!==e[t].dt&&"smallint"!==e[t].dt&&"mediumint"!==e[t].dt&&(e[t].un=!1,console.log(">> resetting unsigned value",e[t].cn)),console.log(e[t].cn)}static columnEditable(e){return!0}static onCheckboxChangeAU(e){console.log(e),e.altered=e.altered||2}static colPropAuDisabled(e){if(1!==e.altered)return!0;switch(e.dt){case"date":case"datetime":case"timestamp":case"time":return!1;default:return!0}}static getAbstractType(e){var t;switch(null===(t=e.dt)||void 0===t?void 0:t.replace(/\(\d+\)$/).toLowerCase()){case"date":return"date";case"datetime":case"timestamp":return"datetime";case"integer":case"int":case"tinyint":case"smallint":case"mediumint":case"bigint":case"int2":case"int8":return"integer";case"text":return"text";case"boolean":return"boolean";case"real":case"double":case"double precision":case"float":case"decimal":case"numeric":return"float";case"blob sub_type text":case"blob":return"blob";case"character":case"varchar":return"string"}return"string"}static getUIType(e){switch(this.getAbstractType(e)){case"integer":return"Number";case"boolean":return"Checkbox";case"float":return"Decimal";case"date":return"Date";case"datetime":return"CreatedTime";case"time":return"Time";case"year":return"Year";case"string":return"SingleLineText";case"text":case"json":return"LongText";case"blob":return"Attachment";case"enum":return"SingleSelect";case"set":return"MultiSelect"}}static getDataTypeForUiType(e,t){const a={};switch(e.uidt){case"ID":{const e="AI"===t,n="AG"===t;a.dt=n?"varchar":"integer",a.pk=!0,a.un=e,a.ai=e,a.rqd=!0,a.meta=n?{ag:"nc"}:void 0}break;case"ForeignKey":case"SingleLineText":case"Collaborator":case"Formula":case"Rollup":case"Lookup":case"Barcode":case"Button":default:a.dt="varchar";break;case"LongText":case"Attachment":case"GeoData":case"MultiSelect":case"SingleSelect":case"JSON":a.dt="text";break;case"Checkbox":a.dt="boolean",a.cdf="0";break;case"Date":a.dt="date";break;case"Year":a.dt="year";break;case"Time":a.dt="time";break;case"PhoneNumber":a.dt="varchar",a.validate={func:["isMobilePhone"],args:[""],msg:["Validation failed : isMobilePhone"]};break;case"Email":a.dt="varchar",a.validate={func:["isEmail"],args:[""],msg:["Validation failed : isEmail"]};break;case"URL":a.dt="varchar",a.validate={func:["isURL"],args:[""],msg:["Validation failed : isURL"]};break;case"Number":case"Count":case"AutoNumber":a.dt="integer";break;case"Decimal":case"Duration":a.dt="decimal";break;case"Currency":a.dt="double precision",a.validate={func:["isCurrency"],args:[""],msg:["Validation failed : isCurrency"]};break;case"Percent":a.dt="double";break;case"Rating":a.dt="integer",a.cdf="0";break;case"DateTime":case"CreatedTime":case"LastModifiedTime":a.dt="datetime"}return a}static getDataTypeListForUiType(e,t){switch(e.uidt){case"ID":return"AG"===t?["character","text","varchar"]:"AI"===t?["int","integer","tinyint","smallint","mediumint","bigint","int2","int8"]:A;case"ForeignKey":case"Button":default:return A;case"SingleLineText":case"LongText":case"Attachment":case"Collaborator":case"GeoData":return["character","text","varchar"];case"Checkbox":return["int","integer","tinyint","smallint","mediumint","bigint","int2","int8","boolean"];case"MultiSelect":case"SingleSelect":case"Formula":case"Button":return["text","varchar"];case"Year":case"Time":case"Duration":case"Count":case"AutoNumber":return["int","integer","tinyint","smallint","mediumint","bigint","int2","int8"];case"PhoneNumber":case"Email":case"URL":return["varchar","text"];case"Number":case"Rating":return["int","integer","tinyint","smallint","mediumint","bigint","int2","int8","numeric","real","double","double precision","float"];case"Decimal":return["real","double","double precision","float","numeric"];case"Currency":case"Percent":return["real","double","double precision","float","int","integer","tinyint","smallint","mediumint","bigint","int2","int8","numeric"];case"Rollup":case"Lookup":case"Barcode":return["varchar"];case"Date":return["date","varchar"];case"DateTime":case"CreatedTime":case"LastModifiedTime":return["datetime","timestamp"];case"Geometry":case"JSON":return["text"]}}static getUnsupportedFnList(){return["XOR","REGEX_MATCH","REGEX_EXTRACT","REGEX_REPLACE","VALUE","COUNTA","COUNT","DATESTR","DAY","MONTH","HOUR"]}static getCurrentDateDefault(e){return null}static isEqual(e,t){if(e===t)return!0;const a=this.getAbstractType({dt:e}),n=this.getAbstractType({dt:t});return!(!a||a!==n||!["integer","float"].includes(a))}}const w=["NUMBER","DECIMAL","NUMERIC","INT","INTEGER","BIGINT","SMALLINT","TINYINT","BYTEINT","FLOAT","FLOAT4","FLOAT8","DOUBLE","DOUBLE PRECISION","REAL","VARCHAR","CHAR","CHARACTER","STRING","TEXT","BINARY","VARBINARY","BOOLEAN","DATE","DATETIME","TIME","TIMESTAMP","TIMESTAMP_LTZ","TIMESTAMP_NTZ","TIMESTAMP_TZ","VARIANT","OBJECT","ARRAY","GEOGRAPHY"];class S{static getNewTableColumns(){return[{column_name:"id",title:"Id",dt:"int",dtx:"integer",ct:"int(11)",nrqd:!1,rqd:!0,ck:!1,pk:!0,un:!1,ai:!0,cdf:null,clen:null,np:11,ns:0,dtxp:"11",dtxs:"",altered:1,uidt:"ID",uip:"",uicn:""},{column_name:"title",title:"Title",dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""},{column_name:"created_at",title:"CreatedAt",dt:"timestamp",dtx:"specificType",ct:"timestamp",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.CreatedTime,uip:"",uicn:"",system:!0},{column_name:"updated_at",title:"UpdatedAt",dt:"timestamp",dtx:"specificType",ct:"timestamp",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.LastModifiedTime,uip:"",uicn:"",system:!0},{column_name:"created_by",title:"nc_created_by",dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:Be.CreatedBy,uip:"",uicn:"",system:!0},{column_name:"updated_by",title:"nc_updated_by",dt:"varchar",dtx:"specificType",ct:"varchar(45)",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"45",dtxs:"",altered:1,uidt:Be.LastModifiedBy,uip:"",uicn:"",system:!0}]}static getNewColumn(e){return{column_name:"title"+e,dt:"TEXT",dtx:"specificType",ct:null,nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""}}static getDefaultLengthForDatatype(e){switch(e){case"VARCHAR":case"CHAR":case"CHARACTER":case"STRING":return 255;case"NUMBER":case"DECIMAL":case"NUMERIC":case"INT":case"INTEGER":case"BIGINT":case"SMALLINT":case"TINYINT":case"BYTEINT":case"FLOAT":case"FLOAT4":case"FLOAT8":case"DOUBLE":case"DOUBLE PRECISION":case"REAL":return 38}}static getDefaultLengthIsDisabled(e){switch(e){case"VARCHAR":case"CHAR":case"CHARACTER":case"STRING":case"NUMBER":case"DECIMAL":case"NUMERIC":case"INT":case"INTEGER":case"BIGINT":case"SMALLINT":case"TINYINT":case"BYTEINT":case"FLOAT":case"FLOAT4":case"FLOAT8":case"DOUBLE":case"DOUBLE PRECISION":case"REAL":return!1;case"TEXT":case"BINARY":case"VARBINARY":case"BOOLEAN":case"DATE":case"DATETIME":case"TIME":case"TIMESTAMP":case"TIMESTAMP_LTZ":case"TIMESTAMP_NTZ":case"TIMESTAMP_TZ":case"VARIANT":case"OBJECT":case"ARRAY":case"GEOGRAPHY":return!0}}static getDefaultValueForDatatype(e){return"eg: "}static getDefaultScaleForDatatype(e){switch(e){case"NUMBER":case"DECIMAL":case"NUMERIC":case"INT":case"INTEGER":case"BIGINT":case"SMALLINT":case"TINYINT":case"BYTEINT":case"FLOAT":case"FLOAT4":case"FLOAT8":case"DOUBLE":case"DOUBLE PRECISION":case"REAL":case"VARCHAR":case"CHAR":case"CHARACTER":case"STRING":case"TEXT":case"BINARY":case"VARBINARY":case"BOOLEAN":case"DATE":case"DATETIME":case"TIME":case"TIMESTAMP":case"TIMESTAMP_LTZ":case"TIMESTAMP_NTZ":case"TIMESTAMP_TZ":case"VARIANT":case"OBJECT":case"ARRAY":case"GEOGRAPHY":return" "}}static colPropAIDisabled(e,t){if("NUMBER"===e.dt||"DECIMAL"===e.dt||"NUMERIC"===e.dt||"INT"===e.dt||"INTEGER"===e.dt||"BIGINT"===e.dt||"SMALLINT"===e.dt){for(let a=0;a<t.length;++a)if(t[a].cn!==e.cn&&t[a].ai)return!0;return!1}return!0}static colPropUNDisabled(e){return!0}static onCheckboxChangeAI(e){console.log(e),"NUMBER"!==e.dt&&"DECIMAL"!==e.dt&&"NUMERIC"!==e.dt&&"INT"!==e.dt&&"INTEGER"!==e.dt&&"BIGINT"!==e.dt&&"SMALLINT"!==e.dt||(e.altered=e.altered||2)}static onCheckboxChangeAU(e){console.log(e),e.altered=e.altered||2,e.au&&(e.cdf="current_timestamp()")}static showScale(e){return!1}static removeUnsigned(e){for(let t=0;t<e.length;++t)1===e[t].altered&&"INT"!==e[t].dt&&"BIGINT"!==e[t].dt&&"SMALLINT"!==e[t].dt&&"TINYINT"!==e[t].dt&&(e[t].un=!1,console.log(">> resetting unsigned value",e[t].cn)),console.log(e[t].cn)}static columnEditable(e){return"_evolutions"!==e.tn||"nc_evolutions"!==e.tn}static colPropAuDisabled(e){if(1!==e.altered)return!0;switch(e.dt.toUpperCase()){case"DATE":case"DATETIME":case"TIME":case"TIMESTAMP":case"TIMESTAMP_LTZ":case"TIMESTAMP_NTZ":case"TIMESTAMP_TZ":return!1;default:return!0}}static getAbstractType(e){var t;switch(null===(t=e.dt)||void 0===t?void 0:t.toUpperCase()){case"NUMBER":case"DECIMAL":case"NUMERIC":case"INT":case"INTEGER":case"BIGINT":case"SMALLINT":case"TINYINT":case"BYTEINT":return"integer";case"FLOAT":case"FLOAT4":case"FLOAT8":case"DOUBLE":case"DOUBLE PRECISION":case"REAL":return"float";case"VARCHAR":case"CHAR":case"CHARACTER":case"STRING":case"BINARY":case"VARBINARY":case"DATETIME":case"TIME":case"TIMESTAMP":case"TIMESTAMP_LTZ":case"TIMESTAMP_NTZ":case"TIMESTAMP_TZ":case"VARIANT":case"GEOGRAPHY":default:return"string";case"TEXT":return e.dtxp<1024?"string":"text";case"BOOLEAN":return"boolean";case"DATE":return"date";case"OBJECT":return"json";case"ARRAY":return"enum"}}static getUIType(e){switch(this.getAbstractType(e)){case"NUMBER":case"DECIMAL":case"NUMERIC":case"INT":case"INTEGER":case"BIGINT":case"SMALLINT":case"TINYINT":case"BYTEINT":return"Number";case"FLOAT":case"FLOAT4":case"FLOAT8":case"DOUBLE":case"DOUBLE PRECISION":case"REAL":return"Decimal";case"VARCHAR":case"CHAR":case"CHARACTER":case"STRING":return"SingleLineText";case"TEXT":return"LongText";case"BOOLEAN":return"Checkbox";case"DATE":return"Date";case"DATETIME":return"DateTime"}}static getDataTypeForUiType(e,t){const a={};switch(e.uidt){case"ID":{const e="AI"===t,n="AG"===t;a.dt=n?"VARCHAR":"int4",a.pk=!0,a.un=e,a.ai=e,a.rqd=!0,a.meta=n?{ag:"nc"}:void 0}break;case"ForeignKey":case"Collaborator":case"Time":case"Formula":case"Rollup":case"Lookup":case"Barcode":case"Button":default:a.dt="VARCHAR";break;case"SingleLineText":case"LongText":case"Attachment":case"GeoData":case"MultiSelect":case"SingleSelect":case"JSON":a.dt="TEXT";break;case"Checkbox":a.dt="BOOLEAN",a.cdf="0";break;case"Date":a.dt="DATE";break;case"Year":case"Count":case"AutoNumber":a.dt="INT";break;case"PhoneNumber":a.dt="VARCHAR",a.validate={func:["isMobilePhone"],args:[""],msg:["Validation failed : isMobilePhone"]};break;case"Email":a.dt="VARCHAR",a.validate={func:["isEmail"],args:[""],msg:["Validation failed : isEmail"]};break;case"URL":a.dt="TEXT",a.validate={func:["isURL"],args:[""],msg:["Validation failed : isURL"]};break;case"Number":a.dt="BIGINT";break;case"Decimal":case"Duration":a.dt="DECIMAL";break;case"Currency":a.dt="DECIMAL",a.validate={func:["isCurrency"],args:[""],msg:["Validation failed : isCurrency"]};break;case"Percent":a.dt="DOUBLE PRECISION";break;case"Rating":a.dt="SMALLINT",a.cdf="0";break;case"DateTime":case"CreatedTime":case"LastModifiedTime":a.dt="TIMESTAMP"}return a}static getDataTypeListForUiType(e,t){switch(e.uidt){case"ID":return"AG"===t?["VARCHAR"]:"AI"===t?["NUMBER"]:w;case"ForeignKey":default:return w;case"SingleLineText":case"LongText":case"Collaborator":case"GeoData":return["TEXT","VARCHAR","CHARACTER","CHAR"];case"Attachment":return["TEXT","CHAR","CHARACTER","VARCHAR"];case"JSON":case"MultiSelect":case"SingleSelect":case"Geometry":return["TEXT"];case"Checkbox":return["BIT","BOOLEAN","TINYINT","INT","BIGINT"];case"Year":return["INT"];case"Time":return["TIMESTAMP","VARCHAR"];case"PhoneNumber":case"Email":case"Rollup":case"Lookup":case"User":case"CreatedBy":case"LastModifiedBy":case"Barcode":return["VARCHAR"];case"URL":case"Formula":case"Button":return["TEXT","VARCHAR"];case"Number":return["NUMBER","DECIMAL","NUMERIC","INT","INTEGER","BIGINT","SMALLINT","TINYINT","BYTEINT","FLOAT","FLOAT4","FLOAT8","DOUBLE","DOUBLE PRECISION","REAL"];case"Decimal":return["DOUBLE","DOUBLE PRECISION","FLOAT","FLOAT4","FLOAT8","NUMERIC"];case"Currency":case"Percent":case"Duration":case"Rating":return["NUMBER","DECIMAL","NUMERIC","INT","INTEGER","BIGINT","FLOAT","FLOAT4","FLOAT8","DOUBLE","DOUBLE PRECISION"];case"Count":case"AutoNumber":return["NUMBER","INT","INTEGER","BIGINT"];case"Date":return["DATE","TIMESTAMP"];case"DateTime":case"CreatedTime":case"LastModifiedTime":return["TIMESTAMP"]}}static getUnsupportedFnList(){return["XOR","REGEX_MATCH","REGEX_EXTRACT","REGEX_REPLACE","VALUE","COUNTA","COUNT","DATESTR"]}static getCurrentDateDefault(e){return null}static isEqual(e,t){if(e===t)return!0;const a=this.getAbstractType({dt:e}),n=this.getAbstractType({dt:t});return!(!a||a!==n||!["integer","float"].includes(a))}}
/**
 * @copyright Copyright (c) 2021, Xgene Cloud Ltd
 *
 * @author Naveen MR <oof1lab@gmail.com>
 * @author Pranav C Balan <pranavxc@gmail.com>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */const v=["BIGINT","BINARY","BOOLEAN","DATE","DECIMAL","DOUBLE","FLOAT","INT","INTERVAL","VOID","SMALLINT","STRING","TIMESTAMP","TIMESTAMP_NTZ","TINYINT"];class I{static getNewTableColumns(){return[{column_name:"id",title:"Id",dt:"int",dtx:"int",ct:"int",nrqd:!1,rqd:!0,ck:!1,pk:!0,un:!1,ai:!0,cdf:null,clen:null,np:null,ns:0,dtxp:"",dtxs:"",altered:1,uidt:"ID",uip:"",uicn:""},{column_name:"title",title:"Title",dt:"string",dtx:"specificType",ct:"string",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""},{column_name:"created_at",title:"CreatedAt",dt:"TIMESTAMP",dtx:"specificType",ct:"TIMESTAMP",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.CreatedTime,uip:"",uicn:"",system:!0},{column_name:"updated_at",title:"UpdatedAt",dt:"TIMESTAMP",dtx:"specificType",ct:"TIMESTAMP",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.LastModifiedTime,uip:"",uicn:"",system:!0},{column_name:"created_by",title:"nc_created_by",dt:"string",dtx:"specificType",ct:"string",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.CreatedBy,uip:"",uicn:"",system:!0},{column_name:"updated_by",title:"nc_updated_by",dt:"string",dtx:"specificType",ct:"string",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,clen:45,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:Be.LastModifiedBy,uip:"",uicn:"",system:!0}]}static getNewColumn(e){return{column_name:"title"+e,dt:"string",dtx:"specificType",ct:"string",nrqd:!0,rqd:!1,ck:!1,pk:!1,un:!1,ai:!1,cdf:null,clen:null,np:null,ns:null,dtxp:"",dtxs:"",altered:1,uidt:"SingleLineText",uip:"",uicn:""}}static getDefaultLengthForDatatype(e){return""}static getDefaultLengthIsDisabled(e){switch(e){case"decimal":return!0;case"text":return!1}}static getDefaultValueForDatatype(e){switch(e){case"integer":case"numeric":case"real":return"eg : 10";case"text":return"eg : hey";case"blob":return"eg : 100"}}static getDefaultScaleForDatatype(e){switch(e){case"integer":case"text":case"numeric":case"real":case"blob":return" "}}static colPropAIDisabled(e,t){if("integer"===e.dt){for(let a=0;a<t.length;++a)if(t[a].cn!==e.cn&&t[a].ai)return!0;return!1}return!0}static colPropUNDisabled(e){return!0}static onCheckboxChangeAI(e){console.log(e),"int"!==e.dt&&"bigint"!==e.dt&&"smallint"!==e.dt&&"tinyint"!==e.dt||(e.altered=e.altered||2)}static showScale(e){return!1}static removeUnsigned(e){for(let t=0;t<e.length;++t)1===e[t].altered&&"int"!==e[t].dt&&"bigint"!==e[t].dt&&"tinyint"!==e[t].dt&&"smallint"!==e[t].dt&&"mediumint"!==e[t].dt&&(e[t].un=!1,console.log(">> resetting unsigned value",e[t].cn)),console.log(e[t].cn)}static columnEditable(e){return!0}static onCheckboxChangeAU(e){console.log(e),e.altered=e.altered||2}static colPropAuDisabled(e){if(1!==e.altered)return!0;switch(e.dt){case"date":case"datetime":case"timestamp":case"time":return!1;default:return!0}}static getAbstractType(e){var t;switch(null===(t=e.dt)||void 0===t?void 0:t.replace(/\(\d+\)$/).toLowerCase()){case"bigint":case"tinyint":case"int":case"smallint":return"integer";case"decimal":case"double":case"float":return"float";case"boolean":return"boolean";case"timestamp":case"timestamp_ntz":return"datetime";case"date":return"date";case"string":return"string"}return"string"}static getUIType(e){switch(this.getAbstractType(e)){case"integer":return"Number";case"boolean":return"Checkbox";case"float":return"Decimal";case"date":return"Date";case"datetime":return"CreatedTime";case"time":return"Time";case"year":return"Year";case"string":return"SingleLineText";case"text":case"json":return"LongText";case"blob":return"Attachment";case"enum":return"SingleSelect";case"set":return"MultiSelect"}}static getDataTypeForUiType(e){const t={};switch(e.uidt){case"ID":t.dt="string",t.pk=!0,t.rqd=!0,t.meta={ag:"nc"};break;case"ForeignKey":case"SingleLineText":case"LongText":case"Attachment":case"GeoData":case"MultiSelect":case"SingleSelect":case"Collaborator":case"Time":case"Formula":case"Rollup":case"Lookup":case"Barcode":case"Button":case"JSON":default:t.dt="string";break;case"Checkbox":t.dt="boolean";break;case"Date":t.dt="date";break;case"Year":t.dt="number";break;case"PhoneNumber":t.dt="string",t.validate={func:["isMobilePhone"],args:[""],msg:["Validation failed : isMobilePhone"]};break;case"Email":t.dt="string",t.validate={func:["isEmail"],args:[""],msg:["Validation failed : isEmail"]};break;case"URL":t.dt="string",t.validate={func:["isURL"],args:[""],msg:["Validation failed : isURL"]};break;case"Number":case"Count":case"AutoNumber":t.dt="int";break;case"Decimal":case"Duration":t.dt="decimal";break;case"Currency":t.dt="double",t.validate={func:["isCurrency"],args:[""],msg:["Validation failed : isCurrency"]};break;case"Percent":t.dt="double";break;case"Rating":t.dt="int",t.cdf="0";break;case"DateTime":case"CreatedTime":case"LastModifiedTime":t.dt="datetime"}return t}static getDataTypeListForUiType(e,t){switch(e.uidt){case"ID":return"AG"===t?["character","text","varchar"]:"AI"===t?["int","integer","tinyint","smallint","mediumint","bigint","int2","int8"]:v;case"ForeignKey":default:return v;case"SingleLineText":case"LongText":case"Attachment":case"Collaborator":case"GeoData":case"MultiSelect":case"SingleSelect":case"Time":case"PhoneNumber":case"Email":case"URL":case"Formula":case"Button":case"Rollup":case"Lookup":case"Barcode":case"Geometry":case"JSON":return["string"];case"Checkbox":return["boolean"];case"Year":case"Number":case"Rating":case"Count":case"AutoNumber":return["int"];case"Decimal":return["decimal","float","double"];case"Currency":case"Percent":case"Duration":return["decimal"];case"Date":return["date"];case"DateTime":case"CreatedTime":case"LastModifiedTime":return["datetime"]}}static getUnsupportedFnList(){return["LOG","EXP","POWER","SQRT","XOR","REGEX_MATCH","REGEX_EXTRACT","REGEX_REPLACE","VALUE","COUNTA","COUNT","ROUNDDOWN","ROUNDUP","DATESTR","DAY","MONTH","HOUR"]}static getCurrentDateDefault(e){return null}static isEqual(e,t){if(e===t)return!0;const a=this.getAbstractType({dt:e}),n=this.getAbstractType({dt:t});return!(!a||a!==n||!["integer","float"].includes(a))}}class L{static create(e){if("mysql"===e.client||"mysql2"===e.client)return y;if("sqlite3"===e.client)return R;if("mssql"===e.client)return O;if("oracledb"===e.client)return N;if("pg"===e.client)return T;if("snowflake"===e.client)return S;if("databricks"===e.client)return I;throw new Error("Database not supported")}}const D=require("dayjs/plugin/relativeTime.js");var $=a.n(D);const q=require("dayjs/plugin/customParseFormat.js");var x=a.n(q);const U=require("dayjs/plugin/duration.js");var M=a.n(U);const P=require("dayjs/plugin/utc.js");var j=a.n(P);const k=require("dayjs/plugin/weekday.js");var F=a.n(k);const G=require("dayjs/plugin/timezone.js");var H=a.n(G);b().extend(j()),b().extend($()),b().extend(x()),b().extend(M()),b().extend(F()),b().extend(H());const B=["YYYY-MM","YYYY MM"],W=["HH:mm","HH:mm:ss","HH:mm:ss.SSS"],V=["YYYY-MM-DD","YYYY/MM/DD","DD-MM-YYYY","MM-DD-YYYY","DD/MM/YYYY","MM/DD/YYYY","DD MM YYYY","MM DD YYYY","YYYY MM DD"],Y=e=>B.includes(e);function J(e){for(const t of V){if(b()(e,t,!0).isValid())return!0;for(const a of W)if(b()(e,`${t} ${a}`,!0).isValid())return!0}return!1}function K(e){for(const t of V)if(b()(e,t,!0).isValid())return t;return"YYYY/MM/DD"}function Q(e){for(const t of V)for(const a of W){const n=`${t} ${a}`;if(b()(e,n,!0).isValid())return n}return"YYYY/MM/DD HH:mm"}function X(e,t){const a=b()(e);return e=a.isValid()?a.format("YYYY-MM-DD"):b()(e,t).format("YYYY-MM-DD")}function z(e,t=`${V[0]} ${W[0]}`,a=!0){const n=a?b()(e).local():b()(e);return e=n.isValid()?n.format(t):a?b()(e,t).local().format(t):b()(e,t).format(t)}function Z(e,t,a){return V.includes(t)&&V.includes(a)?b()(e,t).format(a):e}const ee=e=>{if(null!=e)return"string"!=typeof e?e:e.replace(/((?:-?(?:[1-9][0-9]*)?[0-9]{4})-(?:1[0-2]|0[1-9])-(?:3[01]|0[1-9]|[12][0-9])T(?:2[0-3]|[01][0-9]):(?:[0-5][0-9]):(?:[0-5][0-9])(?:\.[0-9]+)?(?:Z|[+-](?:2[0-3]|[01][0-9]):[0-5][0-9]))/g,((e,t)=>b()(t).format("YYYY-MM-DD HH:mm")))};function te(e){return V.includes(e)}const ae=e=>(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(e)&&(e+="+00:00"),b()(e).fromNow()),ne=(e,t)=>{const a={[W[0]]:/^([01]\d|2[0-3]):[0-5]\d$/,[W[1]]:/^([01]\d|2[0-3]):[0-5]\d:[0-5]\d$/,[W[2]]:/^([01]\d|2[0-3]):[0-5]\d:[0-5]\d\.\d{3}$/};return!!a[t]&&a[t].test(e)};var se=function(e,t,a,n){return new(a||(a=Promise))((function(s,i){function r(e){try{o(n.next(e))}catch(e){i(e)}}function c(e){try{o(n.throw(e))}catch(e){i(e)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,c)}o((n=n.apply(e,t||[])).next())}))};const ie={name:"curly",init(e){e.hooks.add("gobble-token",(function(t){if(123===this.code){const a=this.index;for(;this.index<this.expr.length;)if(++this.index,125===this.code){let n=this.expr.slice(a,++this.index);return n.startsWith("{{")&&this.expr.slice(a,this.index+1).endsWith("}")&&(n=this.expr.slice(a,++this.index)),t.node={type:e.IDENTIFIER,name:/^{{.*}}$/.test(n)?n.slice(2,-2):n.slice(1,-1),raw:n},t.node}this.throwError("Unclosed }")}}))}};function re(e){for(const t of V){if(b()(e,t,!0).isValid())return!0;for(const a of["HH:mm","HH:mm:ss","HH:mm:ss.SSS"])if(b()(e,`${t} ${a}`,!0).isValid())return!0}return!1}function ce(e,t){return se(this,void 0,void 0,(function*(){const a=e=>se(this,void 0,void 0,(function*(){if("CallExpression"===e.type)for(const t of e.arguments||[])yield a(t);else{if("Literal"===e.type)return;if("Identifier"===e.type){const a=e.name,n=t.find((e=>e.id===a||e.column_name===a||e.title===a));e.name="{"+n.id+"}"}else"BinaryExpression"===e.type&&(yield a(e.left),yield a(e.right))}}));g().plugins.register(ie);const n=g()(e);return yield a(n),me(n)}))}var oe,le,ue;function de(e,t,a){const n=(e,a)=>{var s;if("CallExpression"===e.type){let t=0;for(const i of e.arguments||[])n(i,null===(s=null==a?void 0:a.arguments)||void 0===s?void 0:s[t++])}else{if("Literal"===e.type)return;if("Identifier"===e.type){const n=null==e?void 0:e.name,s=t.find((e=>e.id===n||e.column_name===n||e.title===n));e.name=(null==s?void 0:s.title)||(null==a?void 0:a.name)||(null==e?void 0:e.name)}else"BinaryExpression"===e.type&&(n(e.left,null==a?void 0:a.left),n(e.right,null==a?void 0:a.right))}};g().plugins.register(ie);const s=g()(e),i=a&&g()(a);return n(s,i),me(s)}function me(e,t=!1){return"BinaryExpression"===e.type||"LogicalExpression"===e.type?"("+me(e.left)+" "+e.operator+" "+me(e.right)+")":"UnaryExpression"===e.type?e.operator+me(e.argument):"MemberExpression"===e.type?me(e.object)+"["+me(e.property)+"]":"Identifier"===e.type?t?e.name:"{"+e.name+"}":"Literal"===e.type?"string"==typeof e.value?String.raw`"${a=e.raw.slice(1,-1),a.replace(/([^\\]|^)\\(?!\\)/g,"$1\\\\").replace(/([^\\]|^)"/g,'$1\\"').replace(/([^\\]|^)'/g,"$1\\'")}"`:""+e.value:"CallExpression"===e.type?me(e.callee,!0)+"("+e.arguments.map((e=>me(e))).join(", ")+")":"ArrayExpression"===e.type?"["+e.elements.map((e=>me(e))).join(", ")+"]":"Compound"===e.type?e.body.map((e=>me(e))).join(" "):"ConditionalExpression"===e.type?me(e.test)+" ? "+me(e.consequent)+" : "+me(e.alternate):"";var a}!function(e){e.NOT_AVAILABLE="NOT_AVAILABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.MIN_ARG="MIN_ARG",e.MAX_ARG="MAX_ARG",e.TYPE_MISMATCH="TYPE_MISMATCH",e.INVALID_ARG="INVALID_ARG",e.INVALID_ARG_TYPE="INVALID_ARG_TYPE",e.INVALID_ARG_VALUE="INVALID_ARG_VALUE",e.INVALID_ARG_COUNT="INVALID_ARG_COUNT",e.CIRCULAR_REFERENCE="CIRCULAR_REFERENCE",e.INVALID_FUNCTION_NAME="INVALID_FUNCTION_NAME",e.INVALID_COLUMN="INVALID_COLUMN"}(oe||(oe={})),function(e){e.NUMERIC="numeric",e.STRING="string",e.DATE="date",e.LOGICAL="logical",e.COND_EXP="conditional_expression",e.NULL="null",e.BOOLEAN="boolean",e.UNKNOWN="unknown"}(le||(le={})),function(e){e.COMPOUND="Compound",e.IDENTIFIER="Identifier",e.MEMBER_EXP="MemberExpression",e.LITERAL="Literal",e.THIS_EXP="ThisExpression",e.CALL_EXP="CallExpression",e.UNARY_EXP="UnaryExpression",e.BINARY_EXP="BinaryExpression",e.ARRAY_EXP="ArrayExpression"}(ue||(ue={}));const pe={AVG:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#avg",validation:{args:{min:1,type:le.NUMERIC}},description:"Average of input parameters",syntax:"AVG(value1, [value2, ...])",examples:["AVG(10, 5) => 7.5","AVG({column1}, {column2})","AVG({column1}, {column2}, {column3})"],returnType:le.NUMERIC},ADD:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#add",validation:{args:{min:1,type:le.NUMERIC}},description:"Sum of input parameters",syntax:"ADD(value1, [value2, ...])",examples:["ADD(5, 5) => 10","ADD({column1}, {column2})","ADD({column1}, {column2}, {column3})"],returnType:le.NUMERIC},DATEADD:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/date-functions#dateadd",validation:{args:{rqd:3,type:le.DATE},custom:(e,t)=>{if(t.arguments[0].type===ue.LITERAL&&!re(t.arguments[0].value))throw new he(oe.TYPE_MISMATCH,{key:"msg.formula.firstParamDateAddHaveDate"},"First parameter of DATEADD should be a date");if(t.arguments[1].type===ue.LITERAL&&"number"!=typeof t.arguments[1].value)throw new he(oe.TYPE_MISMATCH,{key:"msg.formula.secondParamDateAddHaveNumber"},"Second parameter of DATEADD should be a number");if(t.arguments[2].type===ue.LITERAL&&!["day","week","month","year"].includes(t.arguments[2].value))throw new he(oe.TYPE_MISMATCH,{key:"msg.formula.thirdParamDateAddHaveDate"},"Third parameter of DATEADD should be one of 'day', 'week', 'month', 'year'")}},description:'Adds "count" units to Datetime.',syntax:'DATEADD(date | datetime, count, ["day" | "week" | "month" | "year"])',examples:['DATEADD({column1}, 2, "day")','DATEADD({column1}, -2, "day")','DATEADD({column1}, 2, "week")','DATEADD({column1}, -2, "week")','DATEADD({column1}, 2, "month")','DATEADD({column1}, -2, "month")','DATEADD({column1}, 2, "year")','DATEADD({column1}, -2, "year")'],returnType:le.DATE},DATESTR:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/date-functions#datestr",validation:{args:{rqd:1}},syntax:"DATESTR(date | datetime)",description:'Formats input field into a string in "YYYY-MM-DD" format',examples:["DATESTR({column1})"],returnType:le.STRING},DAY:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/date-functions#day",validation:{args:{rqd:1}},syntax:"DAY(date | datetime)",description:"Extract day from a date field (1-31)",examples:["DAY({column1})"],returnType:le.STRING},MONTH:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/date-functions#month",validation:{args:{rqd:1}},syntax:"MONTH(date | datetime)",description:"Extract month from a date field (1-12)",examples:["MONTH({column1})"],returnType:le.STRING},HOUR:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/date-functions#hour",validation:{args:{rqd:1}},syntax:"DAY(time | datetime)",description:"Extract hour from a time field (0-23)",examples:["HOUR({column1})"],returnType:le.STRING},DATETIME_DIFF:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/date-functions#datetime_diff",validation:{args:{min:2,max:3,type:le.DATE},custom:(e,t)=>{if(t.arguments[0].type===ue.LITERAL&&!re(t.arguments[0].value))throw new he(oe.TYPE_MISMATCH,{key:"msg.formula.firstParamDateDiffHaveDate"},"First parameter of DATETIME_DIFF should be a date");if(t.arguments[1].type===ue.LITERAL&&!re(t.arguments[1].value))throw new he(oe.TYPE_MISMATCH,{key:"msg.formula.secondParamDateDiffHaveDate"},"Second parameter of DATETIME_DIFF should be a date");if(t.arguments[2]&&t.arguments[2].type===ue.LITERAL&&!["milliseconds","ms","seconds","s","minutes","m","hours","h","days","d","weeks","w","months","M","quarters","Q","years","y"].includes(t.arguments[2].value))throw new he(oe.TYPE_MISMATCH,{key:"msg.formula.thirdParamDateDiffHaveDate"},"Third parameter of DATETIME_DIFF should be one of 'milliseconds', 'ms', 'seconds', 's', 'minutes', 'm', 'hours', 'h', 'days', 'd', 'weeks', 'w', 'months', 'M', 'quarters', 'Q', 'years', 'y'")}},description:"Calculate the difference of two given date / datetime fields in specified units.",syntax:'DATETIME_DIFF(date | datetime, date | datetime, ["milliseconds" | "ms" | "seconds" | "s" | "minutes" | "m" | "hours" | "h" | "days" | "d" | "weeks" | "w" | "months" | "M" | "quarters" | "Q" | "years" | "y"])',examples:["DATEDIFF({column1}, {column2})",'DATEDIFF({column1}, {column2}, "seconds")','DATEDIFF({column1}, {column2}, "s")','DATEDIFF({column1}, {column2}, "years")','DATEDIFF({column1}, {column2}, "y")','DATEDIFF({column1}, {column2}, "minutes")','DATEDIFF({column1}, {column2}, "m")','DATEDIFF({column1}, {column2}, "days")','DATEDIFF({column1}, {column2}, "d")'],returnType:le.NUMERIC},AND:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/conditional-expressions#and",validation:{args:{min:1}},description:"Result is TRUE if all conditions are met",syntax:"AND(expr1, [expr2, ...])",examples:["AND(5 > 2, 5 < 10) => 1","AND({column1} > 2, {column2} < 10)"],returnType:le.COND_EXP},OR:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/conditional-expressions#or",validation:{args:{min:1}},description:"Result is TRUE if at least one condition is met",syntax:"OR(expr1, [expr2, ...])",examples:["OR(5 > 2, 5 < 10) => 1","OR({column1} > 2, {column2} < 10)"],returnType:le.COND_EXP},CONCAT:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#concat",validation:{args:{min:1}},description:"Concatenate input parameters into a single string",syntax:"CONCAT(str1, [str2, ...])",examples:['CONCAT("AA", "BB", "CC") => "AABBCC"',"CONCAT({column1}, {column2}, {column3})"],returnType:le.STRING},TRIM:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#trim",validation:{args:{rqd:1,type:le.STRING}},description:"Remove trailing and leading whitespaces from input parameter",syntax:"TRIM(str)",examples:['TRIM("         HELLO WORLD  ") => "HELLO WORLD"',"TRIM({column1})"],returnType:le.STRING},UPPER:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#upper",validation:{args:{rqd:1,type:le.STRING}},description:"Converts the input parameter to an upper-case string.",syntax:"UPPER(str)",examples:['UPPER("nocodb") => "NOCODB"',"UPPER({column1})"],returnType:le.STRING},LOWER:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#lower",validation:{args:{rqd:1,type:le.STRING}},description:"Converts the input parameter to an lower-case string.",syntax:"LOWER(str)",examples:['LOWER("NOCODB") => "nocodb"',"LOWER({column1})"],returnType:le.STRING},LEN:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#len",validation:{args:{rqd:1,type:le.STRING}},description:"Calculate the character length of the input parameter.",syntax:"LEN(value)",examples:['LEN("NocoDB") => 6',"LEN({column1})"],returnType:le.NUMERIC},MIN:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#min",validation:{args:{min:1,type:le.NUMERIC}},description:"Find the minimum value among the input parameters.",syntax:"MIN(value1, [value2, ...])",examples:["MIN(1000, 2000) => 1000","MIN({column1}, {column2})"],returnType:le.NUMERIC},MAX:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#max",validation:{args:{min:1,type:le.NUMERIC}},description:"Find the maximum value among the input parameters.",syntax:"MAX(value1, [value2, ...])",examples:["MAX(1000, 2000) => 2000","MAX({column1}, {column2})"],returnType:le.NUMERIC},CEILING:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#ceiling",validation:{args:{rqd:1,type:le.NUMERIC}},description:"Rounds the input parameter to the next largest integer value.",syntax:"CEILING(value)",examples:["CEILING(1.01) => 2","CEILING({column1})"],returnType:le.NUMERIC},FLOOR:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#floor",validation:{args:{rqd:1,type:le.NUMERIC}},description:"Round down the input parameter to the nearest integer.",syntax:"FLOOR(value)",examples:["FLOOR(3.1415) => 3","FLOOR({column1})"],returnType:le.NUMERIC},ROUND:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#round",validation:{args:{min:1,max:2,type:le.NUMERIC}},description:"Rounds the number to a specified decimal places or the nearest integer if precision is not specified",syntax:"ROUND(value, precision), ROUND(value)",examples:["ROUND(3.1415) => 3","ROUND(3.1415, 2) => 3.14","ROUND({column1}, 3)"],returnType:le.NUMERIC},MOD:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#mod",validation:{args:{rqd:2,type:le.NUMERIC}},description:"Calculate the remainder resulting from integer division of input parameters.",syntax:"MOD(value1, value2)",examples:["MOD(1024, 1000) => 24","MOD({column}, 2)"],returnType:le.NUMERIC},REPEAT:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#repeat",validation:{args:{rqd:2},custom(e,t){var a,n;if(e[1]!==le.NUMERIC)throw new he(oe.INVALID_ARG,{key:"msg.formula.typeIsExpected",type:"Numeric",calleeName:null===(n=null===(a=t.callee)||void 0===a?void 0:a.name)||void 0===n?void 0:n.toUpperCase(),position:2},"The REPEAT function requires a numeric as the parameter at position 2")}},description:"Concatenate the specified number of copies of the input parameter string.",syntax:"REPEAT(str, count)",examples:['REPEAT("A", 5) => "AAAAA"',"REPEAT({column}, 5)"],returnType:le.STRING},LOG:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#log",validation:{args:{type:le.NUMERIC}},description:"Compute the logarithm of the input parameter to the specified base (default = e).",syntax:"LOG([base], value)",examples:["LOG(2, 1024) => 10","LOG(2, {column1})"],returnType:le.NUMERIC},EXP:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#exp",validation:{args:{type:le.NUMERIC}},description:"Compute the exponential value of the input parameter (e raised to the power specified)",syntax:"EXP(power)",examples:["EXP(1) => 2.718281828459045","EXP({column1})"],returnType:le.NUMERIC},POWER:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#power",validation:{args:{rqd:2,type:le.NUMERIC}},description:"Compute base raised to the exponent power.",syntax:"POWER(base, exponent)",examples:["POWER(2, 10) => 1024","POWER({column1}, 10)"],returnType:le.NUMERIC},SQRT:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#sqrt",validation:{args:{rqd:1,type:le.NUMERIC}},description:"Calculate the square root of the input parameter.",syntax:"SQRT(value)",examples:["SQRT(100) => 10","SQRT({column1})"],returnType:le.NUMERIC},ABS:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#abs",validation:{args:{rqd:1,type:le.NUMERIC}},description:"Obtain the absolute value of the input parameter.",syntax:"ABS(value)",examples:["ABS({column1})"],returnType:le.NUMERIC},NOW:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/date-functions#now",validation:{args:{rqd:0,type:le.DATE}},description:"Retrieve the current time and day.",syntax:"NOW()",examples:["NOW() => 2022-05-19 17:20:43"],returnType:le.DATE},REPLACE:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#replace",validation:{args:{rqd:3,type:le.STRING}},description:'Replace all occurrences of "searchStr" with "replaceStr" in the given string.',syntax:"REPLACE(str, searchStr, replaceStr)",examples:['REPLACE("AABBCC", "AA", "BB") => "BBBBCC"',"REPLACE({column1}, {column2}, {column3})"],returnType:le.STRING},SEARCH:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#search",validation:{args:{rqd:2,type:le.STRING}},description:'Retrieve the index of the specified "searchStr" if found; otherwise, returns 0.',syntax:"SEARCH(str, searchStr)",examples:['SEARCH("HELLO WORLD", "WORLD") => 7','SEARCH({column1}, "abc")'],returnType:le.NUMERIC},INT:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#int",validation:{args:{rqd:1,type:le.NUMERIC}},description:"Obtain the integer value of the input parameter",syntax:"INT(value)",examples:["INT(3.1415) => 3","INT({column1})"],returnType:le.NUMERIC},RIGHT:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#right",validation:{args:{rqd:2,type:[le.STRING,le.NUMERIC]}},description:"Retrieve the last n characters from the input string.",syntax:"RIGHT(str, n)",examples:['RIGHT("HELLO WORLD", 5) => WORLD',"RIGHT({column1}, 3)"],returnType:le.STRING},LEFT:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#left",validation:{args:{rqd:2,type:[le.STRING,le.NUMERIC]}},description:"Retrieve the first n characters from the input string.",syntax:"LEFT(str, n)",examples:["LEFT({column1}, 2)",'LEFT("ABCD", 2) => "AB"'],returnType:le.STRING},SUBSTR:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#substr",validation:{args:{min:2,max:3,type:[le.STRING,le.NUMERIC,le.NUMERIC]}},description:'Extracts a substring of length "n" from the input string, starting from the specified position.',syntax:"\tSUBTR(str, position, [n])",examples:['SUBSTR("HELLO WORLD", 7) => WORLD','SUBSTR("HELLO WORLD", 7, 3) => WOR',"SUBSTR({column1}, 7, 5)"],returnType:le.STRING},MID:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#mid",validation:{args:{rqd:3,type:[le.STRING,le.NUMERIC,le.NUMERIC]}},description:"Extracts a substring; an alias for SUBSTR.",syntax:"MID(str, position, [count])",examples:['MID("NocoDB", 3, 2) => "co"',"MID({column1}, 3, 2)"],returnType:le.STRING},IF:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/conditional-expressions#if",validation:{args:{min:2,max:3}},description:"Evaluate successCase if the expression is TRUE, else the failureCase.",syntax:"IF(expr, successCase, failureCase)",examples:['IF(5 > 1, "YES", "NO") => "YES"','IF({column} > 1, "YES", "NO")'],returnType:e=>{const t=new Set(e.slice(1).filter((e=>e!==le.NULL)));return t.size>1||t.has(le.STRING)?le.STRING:t.has(le.NUMERIC)?le.NUMERIC:t.has(le.BOOLEAN)?le.BOOLEAN:t.has(le.DATE)?le.DATE:e[1]}},SWITCH:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/conditional-expressions#switch",validation:{args:{min:3},custom:(e,t)=>{}},description:"Evaluate case value based on expression output; if no match is found, evaluate default case.",syntax:"SWITCH(expr, [pattern, value, ..., default])",examples:['SWITCH(1, 1, "One", 2, "Two", "N/A") => "One""','SWITCH(2, 1, "One", 2, "Two", "N/A") => "Two"','SWITCH(3, 1, "One", 2, "Two", "N/A") => "N/A"','SWITCH({column1}, 1, "One", 2, "Two", "N/A")'],returnType:e=>{const t=new Set(e.slice(2).filter(((e,t)=>t%2==0)));return t.size>1||t.has(le.STRING)?le.STRING:t.has(le.NUMERIC)?le.NUMERIC:t.has(le.BOOLEAN)?le.BOOLEAN:t.has(le.DATE)?le.DATE:e[1]}},URL:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#url",validation:{args:{min:1,max:2,type:[le.STRING,le.STRING]}},description:"Verify and convert to a hyperlink if the input is a valid URL.",syntax:"URL(string, [label])",examples:['URL("https://github.com/nocodb/nocodb")',"URL({column1})",'URL("https://github.com/nocodb/nocodb", "NocoDB")',"URL({column1}, {column1})"],returnType:le.STRING},URLENCODE:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#urlencode",validation:{args:{rqd:1,type:le.STRING}},description:"Percent-encode the input parameter for use in URLs",syntax:"URLENCODE(str)",examples:['URLENCODE("Hello, world") => "Hello%2C%20world"',"URLENCODE({column1})"],returnType:le.STRING},WEEKDAY:{docsUrl:"https://docs.nocodb.com/fields/field-types/formula/date-functions#weekday",validation:{args:{min:1,max:2,type:le.NUMERIC},custom(e,t){if(t.arguments[0].type===ue.LITERAL&&!re(t.arguments[0].value))throw new he(oe.TYPE_MISMATCH,{key:"msg.formula.firstParamWeekDayHaveDate"},"First parameter of WEEKDAY should be a date");if(t.arguments[1]&&t.arguments[1].type===ue.LITERAL){const e=t.arguments[1].value;if("string"!=typeof e||!["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].includes(e.toLowerCase()))throw new he(oe.TYPE_MISMATCH,{key:"msg.formula.secondParamWeekDayHaveDate"},"Second parameter of WEEKDAY should be day of week string")}}},description:"Retrieve the day of the week as an integer (0-6), starting from Monday by default.",syntax:"WEEKDAY(date, [startDayOfWeek])",examples:['WEEKDAY("2021-06-09")','WEEKDAY(NOW(), "sunday")'],returnType:le.NUMERIC},TRUE:{validation:{args:{max:0}},description:"Returns 1",syntax:"TRUE()",examples:["TRUE()"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/logical-functions#true"},FALSE:{validation:{args:{max:0}},description:"Returns 0",syntax:"FALSE()",examples:["FALSE()"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/logical-functions#false"},REGEX_MATCH:{validation:{args:{rqd:2,type:le.STRING}},description:"Verifies whether the input text matches a regular expression, returning 1 for a match and 0 otherwise.",syntax:"REGEX_MATCH(string, regex)",examples:['REGEX_MATCH({title}, "abc.*")'],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#regex_match"},REGEX_EXTRACT:{validation:{args:{rqd:2,type:le.STRING}},description:"Retrieve the first match of a regular expression in a string.",syntax:"REGEX_EXTRACT(string, regex)",examples:['REGEX_EXTRACT({title}, "abc.*")'],returnType:le.STRING,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#regex_extract"},REGEX_REPLACE:{validation:{args:{rqd:3,type:le.STRING}},description:"Replace all occurrences of a regular expression in a string with a specified replacement string.",syntax:"REGEX_MATCH(string, regex, replacement)",examples:['REGEX_EXTRACT({title}, "abc.*", "abcd")'],returnType:le.STRING,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/string-functions#regex_replace"},BLANK:{validation:{args:{rqd:0}},description:"Yields a null value.",syntax:"BLANK()",examples:["BLANK()"],returnType:le.NULL,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/logical-functions#blank"},XOR:{validation:{args:{min:1}},description:"Verifies whether an odd number of arguments are true, returning true if so, and false otherwise.",syntax:"XOR(expression, [exp2, ...])",examples:["XOR(TRUE(), FALSE(), TRUE())"],returnType:le.BOOLEAN,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/logical-functions#xor"},EVEN:{validation:{args:{rqd:1,type:le.NUMERIC}},description:"Rounds up the specified value to the nearest even integer that is greater than or equal to the specified value",syntax:"EVEN(value)",examples:["EVEN({column})"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#even"},ODD:{validation:{args:{rqd:1,type:le.NUMERIC}},description:"Rounds up the specified value to the nearest odd integer that is greater than or equal to the specified value",syntax:"ODD(value)",examples:["ODD({column})"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#odd"},RECORD_ID:{validation:{args:{rqd:0}},description:"Retrieve the record ID of the current record.",syntax:"RECORD_ID()",examples:["RECORD_ID()"],returnType:()=>le.STRING},COUNTA:{validation:{args:{min:1}},description:"Counts non-empty arguments",syntax:"COUNTA(value1, [value2, ...])",examples:["COUNTA({field1}, {field2})"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#counta"},COUNT:{validation:{args:{min:1}},description:"Counts numerical arguments",syntax:"COUNT(value1, [value2, ...])",examples:["COUNT({field1}, {field2})"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#count"},COUNTALL:{validation:{args:{min:1}},description:"Counts the number of arguments",syntax:"COUNTALL(value1, [value2, ...])",examples:["COUNTALL({field1}, {field2})"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#countall"},ROUNDDOWN:{validation:{args:{min:1,max:2,type:le.NUMERIC}},description:'Rounds down the value after the decimal point to the specified number of decimal places given by "precision" (default is 0).',syntax:"ROUNDDOWN(value, [precision])",examples:["ROUNDDOWN({field1})","ROUNDDOWN({field1}, 2)"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#rounddown"},ROUNDUP:{validation:{args:{min:1,max:2,type:le.NUMERIC}},description:'Rounds up the value after the decimal point to the specified number of decimal places given by "precision" (default is 0).',syntax:"ROUNDUP(value, [precision])",examples:["ROUNDUP({field1})","ROUNDUP({field1}, 2)"],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#roundup"},VALUE:{validation:{args:{rqd:1}},description:"Extracts the numeric value from a string, handling % or - appropriately, and returns the resulting numeric value.",syntax:"VALUE(value)",examples:["VALUE({field})",'VALUE("abc10000%")','VALUE("$10000")'],returnType:le.NUMERIC,docsUrl:"https://docs.nocodb.com/fields/field-types/formula/numeric-functions#value"}};class he extends Error{constructor(e,t,a="Formula Error"){super(a),this.type=e,this.extra=t}}function ge({col:e,columns:t,getMeta:a,clientOrSqlUi:n}){return se(this,void 0,void 0,(function*(){const s={},i="string"==typeof n?L.create({client:n}):n;switch(null==e?void 0:e.uidt){case Be.SingleLineText:case Be.LongText:case Be.MultiSelect:case Be.SingleSelect:case Be.PhoneNumber:case Be.Email:case Be.URL:case Be.User:case Be.CreatedBy:case Be.LastModifiedBy:s.dataType=le.STRING;break;case Be.Year:case Be.Number:case Be.Decimal:case Be.Rating:case Be.Count:case Be.AutoNumber:s.dataType=le.NUMERIC;break;case Be.Date:case Be.DateTime:case Be.CreatedTime:case Be.LastModifiedTime:s.dataType=le.DATE;break;case Be.Currency:case Be.Percent:case Be.Duration:case Be.Links:s.dataType=le.NUMERIC;break;case Be.Rollup:{const i=e.colOptions.rollup_function;if(["count","avg","sum","countDistinct","sumDistinct","avgDistinct"].includes(i))s.dataType=le.NUMERIC;else{const i=t.find((t=>t.id===e.colOptions.fk_relation_column_id)),r=(yield a(i.colOptions.fk_related_model_id)).columns,c=r.find((t=>t.id===e.colOptions.fk_rollup_column_id));Object.assign(s,yield ge({col:c,columns:r,getMeta:a,clientOrSqlUi:n}))}}break;case Be.Attachment:s.dataType=le.STRING;break;case Be.Checkbox:"boolean"===e.dt||"bool"===e.dt?s.dataType=le.BOOLEAN:s.dataType=le.NUMERIC;break;case Be.ID:case Be.ForeignKey:case Be.SpecificDBType:if(i){const t=i.getAbstractType(e);["integer","float","decimal"].includes(t)?s.dataType=le.NUMERIC:["boolean"].includes(t)?s.dataType=le.BOOLEAN:["date","datetime","time","year"].includes(t)?s.dataType=le.DATE:s.dataType=le.STRING}else s.dataType=le.UNKNOWN;break;case Be.Time:case Be.Lookup:case Be.Barcode:case Be.Button:case Be.Collaborator:case Be.QrCode:default:s.dataType=le.UNKNOWN}return s}))}function fe({formula:e,column:t,columns:a,clientOrSqlUi:n,getMeta:s}){return se(this,void 0,void 0,(function*(){const i="string"==typeof n?L.create({client:n}):n,r={},c={};for(const e of a)r[e.title]=e,c[e.id]=e;const o=e=>se(this,void 0,void 0,(function*(){var l,u,d,m,p,h,g,f;const b=Object.assign({},e);if(e.type===ue.CALL_EXP){const t=e.callee.name.toUpperCase();if(!pe[t])throw new he(oe.INVALID_FUNCTION_NAME,{},`Function ${t} is not available`);if(null==i?void 0:i.getUnsupportedFnList().includes(t))throw new he(oe.INVALID_FUNCTION_NAME,{},`Function ${t} is unavailable for your database`);const n=pe[t]&&pe[t].validation;if(n&&n.args){if(void 0!==n.args.rqd&&n.args.rqd!==e.arguments.length)throw new he(oe.INVALID_ARG,{key:"msg.formula.requiredArgumentsFormula",requiredArguments:n.args.rqd,calleeName:t},"Required arguments missing");if(void 0!==n.args.min&&n.args.min>e.arguments.length)throw new he(oe.MIN_ARG,{key:"msg.formula.minRequiredArgumentsFormula",minRequiredArguments:n.args.min,calleeName:t},"Minimum arguments required");if(void 0!==n.args.max&&n.args.max<e.arguments.length)throw new he(oe.INVALID_ARG,{key:"msg.formula.maxRequiredArgumentsFormula",maxRequiredArguments:n.args.max,calleeName:t},"Maximum arguments missing")}const s=b.arguments=yield Promise.all(e.arguments.map((e=>o(e)))),r=s.map((e=>e.dataType));if(null===(l=pe[t].validation)||void 0===l?void 0:l.custom)null===(u=pe[t].validation)||void 0===u||u.custom(r,e);else if(null===(m=null===(d=pe[t].validation)||void 0===d?void 0:d.args)||void 0===m?void 0:m.type)for(let e=0;e<s.length;e++){const n=s[e],i=Array.isArray(pe[t].validation.args.type)?pe[t].validation.args.type[e]:pe[t].validation.args.type;if(n.dataType!==i&&n.dataType!==le.NULL&&n.dataType!==le.UNKNOWN&&i!==le.STRING){if(n.type===ue.IDENTIFIER){const e=(null===(p=null==a?void 0:a.find((e=>e.id===n.name||e.title===n.name)))||void 0===p?void 0:p.title)||n.name;throw new he(oe.INVALID_ARG,{key:"msg.formula.columnWithTypeFoundButExpected",columnName:e,columnType:n.dataType,expectedType:i},`Field ${e} with ${n.dataType} type is found but ${i} type is expected`)}{let a="";const n=e+1;let s="";throw i===le.NUMERIC?(a="msg.formula.typeIsExpected",s="numeric"):i===le.BOOLEAN?(a="msg.formula.typeIsExpected",s="boolean"):i===le.DATE&&(a="msg.formula.typeIsExpected",s="date"),new he(oe.INVALID_ARG,{type:s,key:a,position:n,calleeName:t},`${null==t?void 0:t.toUpperCase()} requires a ${s||i} at position ${n}`)}}i===le.STRING&&i!==n.dataType&&(n.cast=le.STRING)}"function"==typeof pe[t].returnType?b.dataType=null===(g=(h=pe[t]).returnType)||void 0===g?void 0:g.call(h,r):pe[t].returnType&&(b.dataType=pe[t].returnType)}else if(e.type===ue.IDENTIFIER){const i=c[e.name]||r[e.name];if(!i)throw new he(oe.INVALID_COLUMN,{key:"msg.formula.columnNotAvailable",columnName:e.name},`Invalid column name/id ${JSON.stringify(e.name)} in formula`);if(b.name=i.id,(null==i?void 0:i.uidt)===Be.Formula){t&&function(e,t,a){const n=a.filter((t=>t.id!==(null==e?void 0:e.id)&&t.uidt===Be.Formula)).reduce(((e,t)=>{const n=[...new Set((t.colOptions.formula.match(/c_?\w{14,15}/g)||[]).filter((e=>a.filter((t=>t.id===e&&t.uidt===Be.Formula)).length)))];return n.length>0&&e.push({[t.id]:n}),e}),[]),s=a.find((e=>e.title===t.name&&e.uidt===Be.Formula));s&&(null==e?void 0:e.id)&&n.push({[null==e?void 0:e.id]:[s.id]});const i=n.length;if(i>0){const e=new Map,t=new Map;for(const[a,s]of Object.entries(n)){const a=Object.keys(s)[0],n=s[a];t.set(a,t.get(a)||0);for(const s of n)e.set(a,(e.get(a)||new Set).add(s)),t.set(s,(t.get(s)||0)+1)}const a=[];t.forEach(((e,t)=>{0===e&&a.push(t)}));let s=0;for(;0!==a.length;){const n=a.shift(),i=e.get(n)||new Set;i.size>0&&(s+=1),i.forEach((e=>{t.set(e,t.get(e)-1),0===t.get(e)&&a.push(e)}))}if(i!==s)throw new he(oe.CIRCULAR_REFERENCE,{key:"msg.formula.cantSaveCircularReference"},"Circular reference detected")}}(t,e,a);const r=(null===(f=i.colOptions)||void 0===f?void 0:f.parsed_tree)||(yield fe({formula:i.colOptions.formula.replaceAll("{{","{").replaceAll("}}","}"),columns:a,clientOrSqlUi:n,getMeta:s}));b.dataType=null==r?void 0:r.dataType}else Object.assign(b,yield ge({col:i,columns:a,getMeta:s,clientOrSqlUi:n}))}else if(e.type===ue.LITERAL)"number"==typeof e.value?b.dataType=le.NUMERIC:"string"==typeof e.value?b.dataType=le.STRING:"boolean"==typeof e.value?b.dataType=le.BOOLEAN:b.dataType=le.STRING;else if(e.type===ue.UNARY_EXP){if(!["-"].includes(e.operator)||e.argument.type!==ue.LITERAL||"number"!=typeof e.argument.value)throw new he(oe.NOT_SUPPORTED,{},`Unary expression '${e.operator}' is not supported`);b.dataType=le.NUMERIC}else if(e.type===ue.BINARY_EXP)b.left=yield o(e.left),b.right=yield o(e.right),["==","<",">","<=",">=","!="].includes(e.operator)?b.dataType=le.COND_EXP:"+"===e.operator?(b.dataType=le.NUMERIC,[b.left,b.right].some((e=>![le.NUMERIC,le.BOOLEAN,le.NULL,le.UNKNOWN].includes(e.dataType)))&&(b.dataType=le.STRING)):b.dataType=le.NUMERIC;else{if(e.type===ue.MEMBER_EXP)throw new he(oe.NOT_SUPPORTED,{},"Bracket notation is not supported");if(e.type===ue.ARRAY_EXP)throw new he(oe.NOT_SUPPORTED,{},"Array is not supported");if(e.type===ue.COMPOUND)throw new he(oe.NOT_SUPPORTED,{},"Compound statement is not supported")}return b}));g().plugins.register(ie);const l=g()(e);return yield o(l)}))}var be,Ee,ye,_e,Te;!function(e){e[e.FORM=1]="FORM",e[e.GALLERY=2]="GALLERY",e[e.GRID=3]="GRID",e[e.KANBAN=4]="KANBAN",e[e.MAP=5]="MAP",e[e.CALENDAR=6]="CALENDAR"}(be||(be={})),function(e){e.DATABASE="database",e.DOCUMENTATION="documentation",e.COWRITER="cowriter",e.DASHBOARD="dashboard"}(Ee||(Ee={})),function(e){e.HAS_MANY="hm",e.BELONGS_TO="bt",e.MANY_TO_MANY="mm",e.ONE_TO_ONE="oo"}(ye||(ye={})),function(e){e.EXCEL="excel",e.CSV="csv"}(_e||(_e={})),function(e){e.COMMENT="COMMENT",e.DATA="DATA",e.PROJECT="PROJECT",e.VIRTUAL_RELATION="VIRTUAL_RELATION",e.RELATION="RELATION",e.TABLE_VIEW="TABLE_VIEW",e.TABLE="TABLE",e.VIEW="VIEW",e.META="META",e.TABLE_COLUMN="TABLE_COLUMN",e.WEBHOOKS="WEBHOOKS",e.AUTHENTICATION="AUTHENTICATION",e.ORG_USER="ORG_USER"}(Te||(Te={}));const Ce={[Te.COMMENT]:"Comment",[Te.DATA]:"Data",[Te.PROJECT]:"Project",[Te.VIRTUAL_RELATION]:"Virtual Relation",[Te.RELATION]:"Relation",[Te.TABLE_VIEW]:"Table View",[Te.TABLE]:"Table",[Te.VIEW]:"View",[Te.META]:"Meta",[Te.WEBHOOKS]:"Webhooks",[Te.AUTHENTICATION]:"Authentication",[Te.TABLE_COLUMN]:"Table Column",[Te.ORG_USER]:"Org User"};var Oe;!function(e){e.INSERT="INSERT",e.CREATE="CREATE",e.UPDATE="UPDATE",e.DELETE="DELETE",e.BULK_INSERT="BULK_INSERT",e.BULK_UPDATE="BULK_UPDATE",e.BULK_DELETE="BULK_DELETE",e.LINK_RECORD="LINK_RECORD",e.UNLINK_RECORD="UNLINK_RECORD",e.RENAME="RENAME",e.IMPORT_FROM_ZIP="IMPORT_FROM_ZIP",e.EXPORT_TO_FS="EXPORT_TO_FS",e.EXPORT_TO_ZIP="EXPORT_TO_ZIP",e.SIGNIN="SIGNIN",e.SIGNUP="SIGNUP",e.PASSWORD_RESET="PASSWORD_RESET",e.PASSWORD_FORGOT="PASSWORD_FORGOT",e.PASSWORD_CHANGE="PASSWORD_CHANGE",e.EMAIL_VERIFICATION="EMAIL_VERIFICATION",e.ROLES_MANAGEMENT="ROLES_MANAGEMENT",e.INVITE="INVITE",e.RESEND_INVITE="RESEND_INVITE"}(Oe||(Oe={}));const Ne={[Oe.UPDATE]:"Update",[Oe.INSERT]:"Insert",[Oe.DELETE]:"Delete",[Oe.BULK_INSERT]:"Bulk Insert",[Oe.BULK_UPDATE]:"Bulk Update",[Oe.BULK_DELETE]:"Bulk Delete",[Oe.LINK_RECORD]:"Link Record",[Oe.UNLINK_RECORD]:"Unlink Record",[Oe.CREATE]:"Create",[Oe.RENAME]:"Rename",[Oe.IMPORT_FROM_ZIP]:"Import From Zip",[Oe.EXPORT_TO_FS]:"Export To FS",[Oe.EXPORT_TO_ZIP]:"Export To Zip",[Oe.SIGNIN]:"Signin",[Oe.SIGNUP]:"Signup",[Oe.PASSWORD_RESET]:"Password Reset",[Oe.PASSWORD_FORGOT]:"Password Forgot",[Oe.PASSWORD_CHANGE]:"Password Change",[Oe.EMAIL_VERIFICATION]:"Email Verification",[Oe.ROLES_MANAGEMENT]:"Roles Management",[Oe.INVITE]:"Invite",[Oe.RESEND_INVITE]:"Resend Invite"};var Ae,Re,we,Se,ve,Ie,Le,De;!function(e){e.STORAGE="Storage",e.EMAIL="Email"}(Ae||(Ae={})),function(e){e.TABLE="table",e.VIEW="view"}(Re||(Re={})),function(e){e.JOB="job"}(we||(we={})),function(e){e.doc="doc",e.sec="sec",e.paragraph="paragraph",e.text="text",e.heading="heading",e.bullet="bullet",e.ordered="ordered",e.task="task",e.quote="quote",e.divider="divider",e.codeBlock="codeBlock",e.image="image",e.callout="callout",e.tipCallout="tipCallout",e.table="table",e.tableRow="tableRow",e.tableCell="tableCell",e.embed="embed",e.collapsable="collapsable",e.collapsableContent="collapsable_content",e.collapsableHeader="collapsable_header",e.column="column",e.columnContent="columnContent",e.linkToPage="linkToPage",e.attachment="attachment"}(Se||(Se={})),function(e){e.strike="strike",e.bold="bold",e.italic="italic",e.link="link",e.code="code",e.underline="underline"}(ve||(ve={})),function(e){e.NC_ERR_MM_MODEL_NOT_FOUND="NC_ERR_MM_MODEL_NOT_FOUND"}(Ie||(Ie={})),function(e){e.AUTHENTICATION_REQUIRED="AUTHENTICATION_REQUIRED",e.API_TOKEN_NOT_ALLOWED="API_TOKEN_NOT_ALLOWED",e.WORKSPACE_NOT_FOUND="WORKSPACE_NOT_FOUND",e.BASE_NOT_FOUND="BASE_NOT_FOUND",e.SOURCE_NOT_FOUND="SOURCE_NOT_FOUND",e.TABLE_NOT_FOUND="TABLE_NOT_FOUND",e.VIEW_NOT_FOUND="VIEW_NOT_FOUND",e.FIELD_NOT_FOUND="FIELD_NOT_FOUND",e.RECORD_NOT_FOUND="RECORD_NOT_FOUND",e.GENERIC_NOT_FOUND="GENERIC_NOT_FOUND",e.HOOK_NOT_FOUND="HOOK_NOT_FOUND",e.REQUIRED_FIELD_MISSING="REQUIRED_FIELD_MISSING",e.ERROR_DUPLICATE_RECORD="ERROR_DUPLICATE_RECORD",e.USER_NOT_FOUND="USER_NOT_FOUND",e.INVALID_OFFSET_VALUE="INVALID_OFFSET_VALUE",e.INVALID_LIMIT_VALUE="INVALID_LIMIT_VALUE",e.INVALID_FILTER="INVALID_FILTER",e.INVALID_SHARED_VIEW_PASSWORD="INVALID_SHARED_VIEW_PASSWORD",e.INVALID_ATTACHMENT_JSON="INVALID_ATTACHMENT_JSON",e.NOT_IMPLEMENTED="NOT_IMPLEMENTED",e.INTERNAL_SERVER_ERROR="INTERNAL_SERVER_ERROR",e.DATABASE_ERROR="DATABASE_ERROR",e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.BAD_JSON="BAD_JSON",e.INVALID_PK_VALUE="INVALID_PK_VALUE",e.COLUMN_ASSOCIATED_WITH_LINK="COLUMN_ASSOCIATED_WITH_LINK",e.TABLE_ASSOCIATED_WITH_LINK="TABLE_ASSOCIATED_WITH_LINK",e.INTEGRATION_NOT_FOUND="INTEGRATION_NOT_FOUND",e.INTEGRATION_LINKED_WITH_BASES="INTEGRATION_LINKED_WITH_BASES",e.FORMULA_ERROR="FORMULA_ERROR",e.PERMISSION_DENIED="PERMISSION_DENIED"}(Le||(Le={})),function(e){e.ID="ID",e.LinkToAnotherRecord="LinkToAnotherRecord",e.ForeignKey="ForeignKey",e.Lookup="Lookup",e.SingleLineText="SingleLineText",e.LongText="LongText",e.Attachment="Attachment",e.Checkbox="Checkbox",e.MultiSelect="MultiSelect",e.SingleSelect="SingleSelect",e.Collaborator="Collaborator",e.Date="Date",e.Year="Year",e.Time="Time",e.PhoneNumber="PhoneNumber",e.GeoData="GeoData",e.Email="Email",e.URL="URL",e.Number="Number",e.Decimal="Decimal",e.Currency="Currency",e.Percent="Percent",e.Duration="Duration",e.Rating="Rating",e.Formula="Formula",e.Rollup="Rollup",e.Count="Count",e.DateTime="DateTime",e.CreatedTime="CreatedTime",e.LastModifiedTime="LastModifiedTime",e.AutoNumber="AutoNumber",e.Geometry="Geometry",e.JSON="JSON",e.SpecificDBType="SpecificDBType",e.Barcode="Barcode",e.QrCode="QrCode",e.Button="Button",e.Links="Links",e.User="User",e.CreatedBy="CreatedBy",e.LastModifiedBy="LastModifiedBy"}(De||(De={}));const $e={[De.ID]:"ID",[De.LinkToAnotherRecord]:"Link to another record",[De.ForeignKey]:"Foreign key",[De.Lookup]:"Lookup",[De.SingleLineText]:"Single line text",[De.LongText]:"Long text",RichText:"Rich text",[De.Attachment]:"Attachment",[De.Checkbox]:"Checkbox",[De.MultiSelect]:"Multi select",[De.SingleSelect]:"Single select",[De.Collaborator]:"Collaborator",[De.Date]:"Date",[De.Year]:"Year",[De.Time]:"Time",[De.PhoneNumber]:"Phone number",[De.GeoData]:"Geo data",[De.Email]:"Email",[De.URL]:"URL",[De.Number]:"Number",[De.Decimal]:"Decimal",[De.Currency]:"Currency",[De.Percent]:"Percent",[De.Duration]:"Duration",[De.Rating]:"Rating",[De.Formula]:"Formula",[De.Rollup]:"Rollup",[De.Count]:"Count",[De.DateTime]:"Date time",[De.CreatedTime]:"Created time",[De.LastModifiedTime]:"Last modified time",[De.AutoNumber]:"Auto number",[De.Geometry]:"Geometry",[De.JSON]:"JSON",[De.SpecificDBType]:"Specific DB type",[De.Barcode]:"Barcode",[De.QrCode]:"Qr code",[De.Button]:"Button",[De.Links]:"Links",[De.User]:"User",[De.CreatedBy]:"Created by",[De.LastModifiedBy]:"Last modified by"},qe={[De.ID]:"ID",[De.LinkToAnotherRecord]:"{TableName}",[De.ForeignKey]:"Foreign key",[De.Lookup]:"{FieldName} (from {TableName})",[De.SingleLineText]:"Text",[De.LongText]:"Notes",[De.Attachment]:"Attachment",[De.Checkbox]:"Done",[De.MultiSelect]:"Tags",[De.SingleSelect]:"Status",[De.Collaborator]:"User",[De.Date]:"Date",[De.Year]:"Year",[De.Time]:"Time",[De.PhoneNumber]:"Phone",[De.GeoData]:"Geo data",[De.Email]:"Email",[De.URL]:"URL",[De.Number]:"Number",[De.Decimal]:"Decimal",[De.Currency]:"Currency",[De.Percent]:"Percent",[De.Duration]:"Duration",[De.Rating]:"Rating",[De.Formula]:"Formula",[De.Rollup]:"{RollupFunction}({FieldName}) from {TableName}",[De.Count]:"Count",[De.DateTime]:"Date time",[De.CreatedTime]:"Created time",[De.LastModifiedTime]:"Last modified time",[De.AutoNumber]:"Auto number",[De.Geometry]:"Geometry",[De.JSON]:"JSON",[De.SpecificDBType]:"Specific DB type",[De.Barcode]:"Barcode",[De.QrCode]:"Qr code",[De.Button]:"Button",[De.Links]:"{TableName}",[De.User]:"User",[De.CreatedBy]:"Created by",[De.LastModifiedBy]:"Last modified by"},xe=[De.Duration,De.Currency,De.Percent,De.Number,De.Decimal,De.Rating,De.Rollup,De.Year,De.Links];function Ue(e){return xe.includes("object"==typeof e?null==e?void 0:e.uidt:e)}function Me(e){return[De.LinkToAnotherRecord,De.Formula,De.QrCode,De.Barcode,De.Rollup,De.Lookup,De.Links,De.CreatedTime,De.LastModifiedTime,De.CreatedBy,De.LastModifiedBy,De.Button].includes("object"==typeof e?null==e?void 0:e.uidt:e)}function Pe(e){return[De.CreatedTime,De.LastModifiedTime].includes("object"==typeof e?null==e?void 0:e.uidt:e)}function je(e){return[De.CreatedBy,De.LastModifiedBy].includes("object"==typeof e?null==e?void 0:e.uidt:e)}function ke(e,t){var a,n;return!!e.system&&(e.uidt===De.LinkToAnotherRecord?!((null===(a=e.colOptions)||void 0===a?void 0:a.type)!==ye.BELONGS_TO||!(null==t?void 0:t.mm))||(null===(n=e.colOptions)||void 0===n?void 0:n.type)===ye.HAS_MANY:[De.CreatedBy,De.LastModifiedBy].includes(e.uidt))}function Fe(e){return[De.LinkToAnotherRecord,De.Links].includes("object"==typeof e?null==e?void 0:e.uidt:e)}const Ge=({formulaColumn:e})=>{var t,a;switch(null===(a=null===(t=null==e?void 0:e.colOptions)||void 0===t?void 0:t.parsed_tree)||void 0===a?void 0:a.dataType){case le.NUMERIC:return De.Number;case le.DATE:return De.DateTime;case le.LOGICAL:case le.COND_EXP:case le.BOOLEAN:return De.Checkbox}},He=e=>[De.SingleSelect,De.MultiSelect,De.User].includes("object"==typeof e?null==e?void 0:e.uidt:e),Be=De,We=[De.Lookup,De.Rollup,De.Formula,De.Button,De.Barcode,De.QrCode],Ve=[De.Checkbox,De.Number,De.Decimal,De.Currency,De.Percent,De.Duration,De.Rating,De.DateTime,De.Date,De.Time,De.CreatedTime,De.LastModifiedTime,De.LinkToAnotherRecord,De.Links,De.PhoneNumber,De.Email,De.URL],Ye=e=>{switch(e){case le.NUMERIC:return[De.Decimal,De.Currency,De.Percent,De.Rating];case le.DATE:return[De.DateTime,De.Date,De.Time];case le.BOOLEAN:case le.COND_EXP:return[De.Checkbox];case le.STRING:return[De.Email,De.URL,De.PhoneNumber];default:return[]}},Je=[Be.Formula,Be.SingleLineText,Be.LongText,Be.PhoneNumber,Be.URL,Be.Email,Be.Decimal,Be.Number,Be.AutoNumber,Be.ID];var Ke,Qe,Xe,ze,Ze,et,tt,at;!function(e){e.SUPER_ADMIN="super",e.CREATOR="org-level-creator",e.VIEWER="org-level-viewer"}(Ke||(Ke={})),function(e){e.CREATOR="cloud-org-level-creator",e.VIEWER="cloud-org-level-viewer",e.OWNER="cloud-org-level-owner"}(Qe||(Qe={})),function(e){e.OWNER="owner",e.CREATOR="creator",e.EDITOR="editor",e.COMMENTER="commenter",e.VIEWER="viewer",e.NO_ACCESS="no-access"}(Xe||(Xe={})),function(e){e.OWNER="workspace-level-owner",e.CREATOR="workspace-level-creator",e.EDITOR="workspace-level-editor",e.COMMENTER="workspace-level-commenter",e.VIEWER="workspace-level-viewer",e.NO_ACCESS="workspace-level-no-access"}(ze||(ze={})),function(e){e.PROJECT_CREATE="base.create",e.PROJECT_INVITE="base.invite",e.PROJECT_USER_UPDATE="base.user.update",e.PROJECT_USER_RESEND_INVITE="base.user.resend.invite",e.PROJECT_DELETE="base.delete",e.PROJECT_UPDATE="base.update",e.PROJECT_CLONE="base.clone",e.WELCOME="app.welcome",e.WORKSPACE_CREATE="workspace.create",e.WORKSPACE_INVITE="workspace.invite",e.WORKSPACE_DELETE="workspace.delete",e.WORKSPACE_UPDATE="workspace.update",e.USER_SIGNUP="user.signup",e.USER_SIGNIN="user.signin",e.USER_UPDATE="user.update",e.USER_PASSWORD_RESET="user.password.reset",e.USER_PASSWORD_CHANGE="user.password.change",e.USER_PASSWORD_FORGOT="user.password.forgot",e.USER_DELETE="user.delete",e.USER_EMAIL_VERIFICATION="user.email.verification",e.TABLE_CREATE="table.create",e.TABLE_DELETE="table.delete",e.TABLE_UPDATE="table.update",e.VIEW_CREATE="view.create",e.VIEW_DELETE="view.delete",e.VIEW_UPDATE="view.update",e.SHARED_VIEW_CREATE="shared.view.create",e.SHARED_VIEW_DELETE="shared.view.delete",e.SHARED_VIEW_UPDATE="shared.view.update",e.FILTER_CREATE="filter.create",e.FILTER_DELETE="filter.delete",e.FILTER_UPDATE="filter.update",e.SORT_CREATE="sort.create",e.SORT_DELETE="sort.delete",e.SORT_UPDATE="sort.update",e.COLUMN_CREATE="column.create",e.COLUMN_DELETE="column.delete",e.COLUMN_UPDATE="column.update",e.DATA_CREATE="data.create",e.DATA_DELETE="data.delete",e.DATA_UPDATE="data.update",e.ORG_USER_INVITE="org.user.invite",e.ORG_USER_RESEND_INVITE="org.user.resend.invite",e.VIEW_COLUMN_CREATE="view.column.create",e.VIEW_COLUMN_UPDATE="view.column.update",e.API_TOKEN_CREATE="api.token.create",e.API_TOKEN_DELETE="api.token.delete",e.IMAGE_UPLOAD="image.upload",e.BASE_CREATE="source.create",e.BASE_DELETE="source.delete",e.BASE_UPDATE="source.update",e.FORM_COLUMN_UPDATE="form.column.update",e.FORM_CREATE="form.create",e.FORM_UPDATE="form.update",e.GALLERY_CREATE="gallery.create",e.GALLERY_UPDATE="gallery.update",e.KANBAN_CREATE="kanban.create",e.KANBAN_UPDATE="kanban.update",e.MAP_CREATE="map.create",e.MAP_UPDATE="map.update",e.META_DIFF_SYNC="meta.diff.sync",e.GRID_CREATE="grid.create",e.GRID_UPDATE="grid.update",e.GRID_COLUMN_UPDATE="grid.column.update",e.WEBHOOK_CREATE="webhook.create",e.WEBHOOK_UPDATE="webhook.update",e.WEBHOOK_DELETE="webhook.delete",e.WEBHOOK_TEST="webhook.test",e.WEBHOOK_TRIGGER="webhook.trigger",e.UI_ACL_UPDATE="ui.acl.update",e.ORG_API_TOKEN_CREATE="org.api.token.create",e.ORG_API_TOKEN_DELETE="org.api.token.delete",e.PLUGIN_TEST="plugin.test",e.PLUGIN_INSTALL="plugin.install",e.PLUGIN_UNINSTALL="plugin.uninstall",e.SYNC_SOURCE_CREATE="sync.source.create",e.SYNC_SOURCE_UPDATE="sync.source.update",e.SYNC_SOURCE_DELETE="sync.source.delete",e.RELATION_DELETE="relation.delete",e.RELATION_CREATE="relation.create",e.SHARED_BASE_GENERATE_LINK="shared.base.generate.link",e.SHARED_BASE_DELETE_LINK="shared.base.delete.link",e.ATTACHMENT_UPLOAD="attachment.upload",e.APIS_CREATED="apis.created",e.EXTENSION_CREATE="extension.create",e.EXTENSION_UPDATE="extension.update",e.EXTENSION_DELETE="extension.delete",e.COMMENT_CREATE="comment.create",e.COMMENT_DELETE="comment.delete",e.COMMENT_UPDATE="comment.update",e.INTEGRATION_DELETE="integration.delete",e.INTEGRATION_CREATE="integration.create",e.INTEGRATION_UPDATE="integration.update"}(Ze||(Ze={})),function(e){e.API_CALLS="usage_api_calls",e.API_COUNT="usage_api_count",e.NOTIFICATION="nc_notification",e.PAGE_SNAPSHOT="docs_page_snapshot",e.TELEMETRY="usage_telemetry",e.AUDIT="nc_audit"}(et||(et={})),function(e){e[e.CREATING=0]="CREATING",e[e.CREATED=1]="CREATED",e[e.DELETING=2]="DELETING",e[e.DELETED=3]="DELETED",e[e.FAILED=4]="FAILED"}(tt||(tt={})),function(e){e.FREE="free",e.TEAM="team",e.BUSINESS="business"}(at||(at={}));const nt={[ze.OWNER]:"owner",[ze.CREATOR]:"creator",[ze.EDITOR]:"editor",[ze.COMMENTER]:"commenter",[ze.VIEWER]:"viewer",[ze.NO_ACCESS]:"noaccess",[Xe.OWNER]:"owner",[Xe.CREATOR]:"creator",[Xe.EDITOR]:"editor",[Xe.COMMENTER]:"commenter",[Xe.VIEWER]:"viewer",[Xe.NO_ACCESS]:"noaccess",[Ke.SUPER_ADMIN]:"superAdmin",[Ke.CREATOR]:"creator",[Ke.VIEWER]:"viewer",[Qe.OWNER]:"owner",[Qe.CREATOR]:"creator",[Qe.VIEWER]:"viewer"},st={[ze.OWNER]:"purple",[ze.CREATOR]:"blue",[ze.EDITOR]:"green",[ze.COMMENTER]:"orange",[ze.VIEWER]:"yellow",[ze.NO_ACCESS]:"red",[Xe.OWNER]:"purple",[Xe.CREATOR]:"blue",[Xe.EDITOR]:"green",[Xe.COMMENTER]:"orange",[Xe.VIEWER]:"yellow",[Ke.SUPER_ADMIN]:"maroon",[Xe.NO_ACCESS]:"red",[Ke.CREATOR]:"blue",[Ke.VIEWER]:"yellow",[Qe.OWNER]:"purple",[Qe.CREATOR]:"blue",[Qe.VIEWER]:"yellow"},it={[ze.OWNER]:"Full access to workspace",[ze.CREATOR]:"Can create bases, sync tables, views, setup web-hooks and more",[ze.EDITOR]:"Can edit data in workspace bases",[ze.COMMENTER]:"Can view and comment data in workspace bases",[ze.VIEWER]:"Can view data in workspace bases",[ze.NO_ACCESS]:"Cannot access this workspace",[Xe.OWNER]:"Full access to base",[Xe.CREATOR]:"Can create tables, views, setup webhook, invite collaborators and more",[Xe.EDITOR]:"Can view, add & modify records, add comments on them",[Xe.COMMENTER]:"Can view records and add comment on them",[Xe.VIEWER]:"Can only view records",[Xe.NO_ACCESS]:"Cannot access this base",[Ke.SUPER_ADMIN]:"Full access to all",[Ke.CREATOR]:"Can create bases, sync tables, views, setup web-hooks and more",[Ke.VIEWER]:"Can only view bases"},rt={[ze.OWNER]:"role_owner",[ze.CREATOR]:"role_creator",[ze.EDITOR]:"role_editor",[ze.COMMENTER]:"role_commenter",[ze.VIEWER]:"role_viewer",[ze.NO_ACCESS]:"role_no_access",[Xe.OWNER]:"role_owner",[Xe.CREATOR]:"role_creator",[Xe.EDITOR]:"role_editor",[Xe.COMMENTER]:"role_commenter",[Xe.VIEWER]:"role_viewer",[Xe.NO_ACCESS]:"role_no_access",[Ke.SUPER_ADMIN]:"role_super",[Ke.CREATOR]:"role_creator",[Ke.VIEWER]:"role_viewer",[Qe.OWNER]:"role_owner",[Qe.CREATOR]:"role_creator",[Qe.VIEWER]:"role_viewer"},ct={[ze.OWNER]:Xe.OWNER,[ze.CREATOR]:Xe.CREATOR,[ze.EDITOR]:Xe.EDITOR,[ze.COMMENTER]:Xe.COMMENTER,[ze.VIEWER]:Xe.VIEWER,[ze.NO_ACCESS]:Xe.NO_ACCESS},ot=[ze.OWNER,ze.CREATOR,ze.EDITOR,ze.COMMENTER,ze.VIEWER,ze.NO_ACCESS],lt=[Ke.SUPER_ADMIN,Ke.CREATOR,Ke.VIEWER],ut=[Xe.OWNER,Xe.CREATOR,Xe.EDITOR,Xe.COMMENTER,Xe.VIEWER,Xe.NO_ACCESS];var dt,mt,pt,ht,gt,ft,bt;!function(e){e.FREE_WORKSPACE_LIMIT="FREE_WORKSPACE_LIMIT",e.WORKSPACE_USER_LIMIT="WORKSPACE_USER_LIMIT",e.WORKSPACE_ROW_LIMIT="WORKSPACE_ROW_LIMIT",e.BASE_LIMIT="BASE_LIMIT",e.SOURCE_LIMIT="SOURCE_LIMIT",e.TABLE_LIMIT="TABLE_LIMIT",e.COLUMN_LIMIT="COLUMN_LIMIT",e.TABLE_ROW_LIMIT="TABLE_ROW_LIMIT",e.WEBHOOK_LIMIT="WEBHOOK_LIMIT",e.VIEW_LIMIT="VIEW_LIMIT",e.FILTER_LIMIT="FILTER_LIMIT",e.SORT_LIMIT="SORT_LIMIT"}(dt||(dt={})),function(e){e.VIEW_COLUMNS="fields",e.FILTERS="filters",e.SORTS="sorts"}(mt||(mt={})),function(e){e.SCHEMA_READONLY="is_schema_readonly",e.DATA_READONLY="is_data_readonly"}(pt||(pt={})),function(e){e.MYSQL="mysql2",e.MSSQL="mssql",e.PG="pg",e.SQLITE="sqlite3",e.VITESS="vitess",e.SNOWFLAKE="snowflake",e.DATABRICKS="databricks"}(ht||(ht={})),function(e){e.No="No",e.Allowed="Allowed",e.Preferred="Preferred",e.Required="Required",e.RequiredWithCa="Required-CA",e.RequiredWithIdentity="Required-Identity"}(gt||(gt={})),function(e){e.MICROSOFT_ACCESS="microsoft-access",e.TABLEAU="tableau",e.ORACLE="oracle",e.OPENAI="openai",e.CLAUDE="claude",e.OLLAMA="ollama",e.GROQ="groq",e.SLACK="slack",e.DISCORD="discord",e.TWILLO="twillo",e.MICROSOFT_OUTLOOK="microsoft-outlook",e.MICROSOFT_TEAMS="microsoft-teams",e.TELEGRAM="telegram",e.GMAIL="gmail",e.WHATSAPP="whatsapp",e.ASANA="asana",e.JIRA="jira",e.MIRO="miro",e.TRELLO="trello",e.SALESFORCE="salesforce",e.PIPEDRIVE="pipedrive",e.MICROSOFT_DYNAMICS_365="microsoft-dynamics-365",e.ZOHO_CRM="zoho-crm",e.HUBSPOT="hubspot",e.MAILCHIMP="mailchimp",e.SURVEYMONKEY="surveymonkey",e.TYPEFORM="typeform",e.WORKDAY="workday",e.GREENHOUSE="greenhouse",e.LEVER="lever",e.GITHUB="github",e.GITLAB="gitlab",e.BITBUCKET="bitbucket",e.STRIPE="stripe",e.QUICKBOOKS="quickbooks",e.FRESHDESK="freshdesk",e.INTERCOM="intercom",e.ZENDESK="zendesk",e.HUBSPOT_SERVICE_HUB="hubspot-service-hub",e.SALESFORCE_SERVICE_CLOUD="salesforce-service-cloud",e.BOX="box",e.GOOGLE_DRIVE="google-drive",e.DROPBOX="dropbox",e.APPLE_NUMBERS="apple-numbers",e.GOOGLE_CALENDAR="google-calendar",e.MICROSOFT_EXCEL="microsoft-excel",e.GOOGLE_SHEETS="google-sheets"}(ft||(ft={})),function(e){e.DATABASE="database",e.AI="ai",e.COMMUNICATION="communication",e.SPREAD_SHEET="spread-sheet",e.PROJECT_MANAGEMENT="project-management",e.CRM="crm",e.MARKETING="marketing",e.ATS="ats",e.DEVELOPMENT="development",e.FINANCE="finance",e.TICKETING="ticketing",e.STORAGE="storage",e.OTHERS="others"}(bt||(bt={}));const Et=e=>e&&e.filter((e=>!Tt(e)))||[],yt=e=>(e&&e.filter(Tt)||[]).map((e=>e.id)),_t=e=>e.filter(Tt)||[],Tt=e=>!(!e||!(e.uidt===Be.ForeignKey||("created_at"===e.column_name||"updated_at"===e.column_name)&&e.uidt===Be.DateTime||e.pk&&(e.ai||e.cdf)||e.pk&&e.meta&&e.meta.ag||e.system)),Ct=e=>{var t,a,n;return e&&(e.uidt===Be.Links||e.uidt===Be.LinkToAnotherRecord)&&((null==e?void 0:e.fk_model_id)||(null===(t=null==e?void 0:e.colOptions)||void 0===t?void 0:t.fk_model_id))&&(null===(a=null==e?void 0:e.colOptions)||void 0===a?void 0:a.fk_related_model_id)&&((null==e?void 0:e.fk_model_id)||(null===(n=null==e?void 0:e.colOptions)||void 0===n?void 0:n.fk_model_id))===e.colOptions.fk_related_model_id},Ot=e=>e?"object"!=typeof e||Array.isArray(e)?("string"==typeof e&&(e=e.split(",")),0===e.length?null:e.reduce(((e,t)=>(e[t]=!0,e)),{})):e:null,Nt=e=>{if(!e)return"";return Object.keys(e).filter((t=>e[t])).join(",")},At=e=>[Be.Year,Be.Time,Be.Date,Be.DateTime,Be.CreatedTime,Be.LastModifiedTime].includes(e)?["count","min","max","countDistinct"]:Ue(e)?["sum","count","min","max","avg","countDistinct","sumDistinct","avgDistinct"]:[Be.SingleLineText,Be.LongText,Be.User,Be.Email,Be.PhoneNumber,Be.URL,Be.JSON].includes(e)?["count","countDistinct"]:[Be.Checkbox].includes(e)?["count","sum"]:[Be.Attachment].includes(e)?[]:[Be.SingleSelect,Be.MultiSelect].includes(e)?["count","countDistinct"]:["sum","count","min","max","avg","countDistinct","sumDistinct","avgDistinct"],Rt=e=>[Be.Year,Be.Time,Be.Date,Be.DateTime,Be.CreatedTime,Be.LastModifiedTime,Be.Decimal,Be.Currency,Be.Duration].includes(e)?["count","countDistinct"]:["sum","count","avg","min","max","countDistinct","sumDistinct","avgDistinct"],wt=({name:e,count:t,ext:a})=>`${e}${t?`(${t})`:""}${a?`${a}`:""}`;function St(e,t){return e.replace(/^(.+?)(?:\((\d+)\))?(\.(?:tar|min)\.(?:\w{2,4})|\.\w+)$/,((e,a,n,s)=>{let i=e,r=n||1;for(;t.some((e=>e===i));)i=wt({name:a,ext:s,count:r++});return i}))}function vt(e,t=0){if(t=null==t?0:t>=0?Math.min(t,292):Math.max(t,-292)){let a=`${e}e`.split("e");return a=`${Math.round(Number(`${a[0]}e${+a[1]+t}`))}e`.split("e"),(+`${a[0]}e${+a[1]-t}`).toFixed(t)}return Math.round(e).toFixed(t)}const It={[ht.MYSQL]:null,mysql:null,[ht.PG]:"postgres",oracledb:"xe",[ht.MSSQL]:void 0,[ht.SQLITE]:"a.sqlite"},Lt=e=>{var t;return e.client===ht.PG||e.client===ht.SNOWFLAKE?null===(t=e.connection)||void 0===t?void 0:t.database:It[e.client]};const Dt=class extends p{};class $t{}function qt(e){let t="";let a=!0;return e?e.length>=8||(t+="At least 8 letters. ",a=!1):(t="At least 8 letters",a=!1),{error:t,valid:a,hint:null}}function xt(e,t){return Object.assign(Object.assign(Object.assign({},e),t),{paths:Object.assign(Object.assign({},e.paths),t.paths),components:Object.assign(Object.assign(Object.assign({},e.components),t.components),{schemas:Object.assign(Object.assign({},e.components.schemas),t.components.schemas),responses:Object.assign(Object.assign({},e.components.responses),t.components.responses)})})}var Ut,Mt,Pt,jt,kt,Ft,Gt,Ht;!function(e){e.Required="required"}(Ut||(Ut={})),function(e){e.MinLength="minLength",e.MaxLength="maxLength",e.StartsWith="startsWith",e.EndsWith="endsWith",e.Includes="includes",e.NotIncludes="notIncludes",e.Regex="regex",e.Email="email",e.BusinessEmail="businessEmail",e.PhoneNumber="phoneNumber",e.Url="url"}(Mt||(Mt={})),function(e){e.Min="min",e.Max="max"}(Pt||(Pt={})),function(e){e.MinDate="minDate",e.MaxDate="maxDate"}(jt||(jt={})),function(e){e.MinTime="minTime",e.MaxTime="maxTime"}(kt||(kt={})),function(e){e.MinYear="minYear",e.MaxYear="maxYear"}(Ft||(Ft={})),function(e){e.MinSelected="minSelected",e.MaxSelected="maxSelected",e.LimitOptions="limitOptions"}(Gt||(Gt={})),function(e){e.FileTypes="fileTypes",e.FileSize="fileSize",e.FileCount="fileCount"}(Ht||(Ht={}));const Bt={[Mt.MaxLength]:Mt.MinLength,[Mt.NotIncludes]:Mt.Includes,[Pt.Max]:Pt.Min,[Ft.MaxYear]:Ft.MinYear,[jt.MaxDate]:jt.MinDate,[kt.MaxTime]:kt.MinTime,[Gt.MaxSelected]:Gt.MinSelected};var Wt,Vt,Yt,Jt,Kt;!function(e){e.Sum="sum",e.Min="min",e.Max="max",e.Avg="avg",e.Median="median",e.StandardDeviation="std_dev",e.Range="range"}(Wt||(Wt={})),function(e){e.Count="count",e.CountEmpty="count_empty",e.CountFilled="count_filled",e.CountUnique="count_unique",e.PercentEmpty="percent_empty",e.PercentFilled="percent_filled",e.PercentUnique="percent_unique",e.None="none"}(Vt||(Vt={})),function(e){e.AttachmentSize="attachment_size"}(Yt||(Yt={})),function(e){e.Checked="checked",e.Unchecked="unchecked",e.PercentChecked="percent_checked",e.PercentUnchecked="percent_unchecked"}(Jt||(Jt={})),function(e){e.EarliestDate="earliest_date",e.LatestDate="latest_date",e.DateRange="date_range",e.MonthRange="month_range"}(Kt||(Kt={}));const Qt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Vt),Wt),Yt),Jt),Kt),Xt=(e,t)=>{let a=[];if(e===Be.Formula&&(null==t?void 0:t.dataType))switch(t.dataType){case le.BOOLEAN:a=[...Object.values(Jt),Vt.None];break;case le.DATE:a=[...Object.values(Kt),...Object.values(Vt)];break;case le.NUMERIC:a=[...Object.values(Wt),...Object.values(Vt)];break;default:a=[...Object.values(Vt)]}switch(e){case Be.Number:case Be.Decimal:case Be.Currency:case Be.Percent:case Be.Duration:case Be.Rating:case Be.Rollup:case Be.Links:a=[...Object.values(Wt),...Object.values(Vt)];break;case Be.Attachment:a=[...Object.values(Yt),...Object.values(Vt)];break;case Be.Checkbox:a=[...Object.values(Jt),Vt.None];break;case Be.Date:case Be.DateTime:case Be.LastModifiedTime:case Be.CreatedTime:a=[...Object.values(Kt),...Object.values(Vt)];break;case Be.SpecificDBType:case Be.ForeignKey:a=[Vt.None]}return a.length||(a=[...Object.values(Vt)]),a.filter((e=>e!==Vt.Count))},zt=(e,t,a)=>{if("ssl"in e&&e.ssl){if(t===gt.No||"object"==typeof e.ssl&&Object.values(e.ssl).every((e=>null==e)))return;if("pg"===a&&["true","false"].includes(e.ssl))return"true"===e.ssl;if("pg"===a&&!["boolean","object"].includes(typeof e.ssl))return;return e.ssl}}},3563:e=>{"use strict";e.exports=require("@nestjs/common")},8938:e=>{"use strict";e.exports=require("axios")},6986:e=>{"use strict";e.exports=require("boxen")},3672:e=>{"use strict";e.exports=require("colors")},2103:e=>{"use strict";e.exports=require("crypto-js")},263:e=>{"use strict";e.exports=require("debug")},5833:e=>{"use strict";e.exports=require("emittery")},8872:e=>{"use strict";e.exports=require("fast-levenshtein")},9731:e=>{"use strict";e.exports=require("is-docker")},4688:e=>{"use strict";e.exports=require("jsonfile")},1832:e=>{"use strict";e.exports=require("knex")},133:e=>{"use strict";e.exports=require("lodash/find")},5119:e=>{"use strict";e.exports=require("lodash/findIndex")},943:e=>{"use strict";e.exports=require("lodash/isEmpty")},9020:e=>{"use strict";e.exports=require("lodash/mapKeys")},2745:e=>{"use strict";e.exports=require("mkdirp")},6331:e=>{"use strict";e.exports=require("nanoid")},4587:e=>{"use strict";e.exports=require("parse-database-url")},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},9896:e=>{"use strict";e.exports=require("fs")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var a=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(a.exports,a,a.exports,__webpack_require__),a.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(2909);return __webpack_exports__})()));